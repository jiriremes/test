<html xmlns="http://www.w3.org/1999/xhtml" >
	<head>
		<title>Test Kryptografického modulu Signer</title>
		<meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5" />
		<meta http-equiv="Content-Type" content="text/html; charset=windows-1250" />
		<meta http-equiv="x-ua-compatible" content="IE=10" />
	</head>
	<body onload="InitializePage()">
		<h1 style="text-align: center">
			Testovací stránka Kryptografického modulu Signer<object id="Signer" codebase="Comp/Signer.cab#version=5,5,0,0" classid="CLSID:4ADC518E-B607-11D4-B395-0001020F4519">
				<br/>
				<h3 style="color:red">
					Nebylo moné vytvoøit objekt ovládacího prvku ActiveX, stránka zøejmì nebude fungovat správnì!
				</h3>
			</object>
		</h1>
		<table style="WIDTH:auto" border="1">
			<tr>
				<td colspan="2"><b>Datová zpráva:</b></td>
				<td colspan="2">
					<b>Poslední zpracovaná datová zpráva:</b>
				</td>
			</tr>
			<tr>
				<td colspan="2">
					<textarea name="Message" rows="3" cols="73">Testovací zpráva.</textarea>
				</td>
				<td colspan="2"><textarea name="DecodedMessage" rows="3" cols="73"></textarea></td>
			</tr>
			<tr>
				<td colspan="4">
					<input type="checkbox" id="ChkBoxDataFiles" title="Zaškrtnutím nastavíte zpracování datovıch souborù místo datové zprávy"/>
					<b>Datové soubory:</b>
					<input type="text" name="DataFiles" size="144"/>
					<input type="button" name="SelectDataFiles" value="Vybrat"/>
				</td>
			</tr>
			<tr>
				<td colspan="4">
					<input type="checkbox" id="ChkBoxCryptoFiles" title="Zaškrtnutím nastavíte zpracování krypto souborù místo krypto zprávy"/>
					<b>Krypto soubory:</b>
					<input type="text" name="CryptoFiles" size="144"/>
					<input type="button" name="SelectCryptoFiles" value="Vybrat"/>
				</td>
			</tr>
			<tr>
				<td id="DataFilesText">
					Datovou zprávu:
				</td>
				<td colspan="3">
					<input type="button" name="Encode" value="Kódovat"/>
					<input type="button" name="Sign" value="Podepsat"/>
					<input type="button" name="Encrypt" value="Zašifrovat"/>
					<input type="button" name="SignAndEncrypt" value="Podepsat a zašifrovat"/>
					<input type="button" name="SignDetached" value="Externí podpis"/>
					<input type="button" name="TimeStamp" value="Èasové razítko"/>
					<input type="button" name="TimeStampDetached" value="Externí èasové razítko"/>
					&nbsp;
				</td>
			</tr>
			<tr>
				<td>Pøi podepisování:</td>
				<td colspan="3">
					Vytvoøit:
					<input type="checkbox" name="CreateSignatureWithTimeStamp" title="Digitální podpis s èasovım razítkem" value="1"/>
					CAdES-T
					<input type="checkbox" name="CreateSignatureWithCompleteValidationDataReferences" title="Digitální podpis s referencemi informací na ovìøení platnosti" value="2" />
					CAdES-C
					<input type="checkbox" name="CreateSignatureEXtendedLong" title="Rozšíøenı dlouhodobı digitální podpis s úplnou informací na ovìøení platnosti" value="4" />
					CAdES-X Long
					<input type="checkbox" name="CreateSignatureArchival" title="Archivní digitální podpis" value="32" />
					CAdES-A
					<input type="checkbox" name="CreateSignatureAddCompleteValidationDataReferencesToPreviousTimeStampSignature" title="Reference informací na ovìøení platnosti podpisu pøedchozího èasového razítka" value="64" />
					C do TS
					<input type="checkbox" name="CreateSignatureAddEXtendedLongToPreviousTimeStampSignature" title="Úplná informace na ovìøení platnosti podpisu pøedchozího èasového razítka" value="128" />
					X Long do TS
					<input type="checkbox" name="CreateSignatureWithHashAlgorithmInSignatureAlgorithm" title="Identifikátor algoritmu podpisu bude sloen z algoritmu miniatury a podpisu" value="256" />
					Alg. miniatury i podpisu
					<input type="button" name="CfgSignOptionSet" value="Nastavit"/>
					<input type="button" name="CfgSignOptionGet" value="Zjistit"/>
					<br />
					Zkratka miniatury:&nbsp;
					<input type="text" name="SignatureHashAlgorithmStr" size="6"/>
					<input type="button" name="SetSignatureHashAlgorithmStr" value="Nastavit"/>
					<input type="button" name="GetSignatureHashAlgorithmStr" value="Zjistit"/>
					&nbsp;Èíslo:&nbsp;
					<input type="text" name="SignatureHashAlgorithmNumber" size="1"/>
					<input type="button" name="SetSignatureHashAlgorithmNumber" value="Nastavit"/>
					<input type="button" name="GetSignatureHashAlgorithmNumber" value="Zjistit"/>
					<br />
					Zkratka miniatury atributu SigningCertificate:&nbsp;
					<input type="text" name="SigningCertificateHashAlgorithmStr" size="6"/>
					<input type="button" name="SetSigningCertificateHashAlgorithmStr" value="Nastavit"/>
					<input type="button" name="GetSigningCertificateHashAlgorithmStr" value="Zjistit"/>
					&nbsp;Èíslo:&nbsp;
					<input type="text" name="SigningCertificateHashAlgorithmNumber" size="1"/>
					<input type="button" name="SetSigningCertificateHashAlgorithmNumber" value="Nastavit"/>
					<input type="button" name="GetSigningCertificateHashAlgorithmNumber" value="Zjistit"/>

				</td>
			</tr>
			<tr>
			<td>Pøi razítkování:</td>
				<td colspan="3">
					Pøedané podpisy pøevést na:
					<input type="checkbox" name="CreateTimeStampSignatureWithTimeStamp" title="Digitální podpis s èasovım razítkem" value="1"/>
					CAdES-T
					<input type="checkbox" name="CreateTimeStampSignatureWithCompleteValidationDataReferences" title="Digitální podpis s referencemi informací na ovìøení platnosti" value="2" />
					CAdES-C
					<input type="checkbox" name="CreateTimeStampSignatureEXtendedLong" title="Rozšíøenı dlouhodobı digitální podpis s úplnou informací na ovìøení platnosti" value="4" />
					CAdES-X Long
					<input type="checkbox" name="CreateTimeStampSignatureArchival" title="Archivní digitální podpis" value="32" />
					CAdES-A
					<input type="checkbox" name="CreateTimeStampAddCompleteValidationDataReferencesToPreviousTimeStampSignature" title="Reference informací na ovìøení platnosti podpisu pøedchozího èasového razítka" value="64" />
					C do TS
					<input type="checkbox" name="CreateTimeStampAddEXtendedLongToPreviousTimeStampSignature" title="Úplná informace na ovìøení platnosti podpisu pøedchozího èasového razítka" value="128" />
					X Long do TS
					<input name="CfgTimeStampOptionSet" type="button" value="Nastavit" />
					<input name="CfgTimeStampOptionGet" type="button" value="Zjistit" /><br />
					Zkratka miniatury:&nbsp;
					<input type="text" name="TimeStampHashAlgorithmStr" size="6"/>
					<input type="button" name="SetTimeStampHashAlgorithmStr" value="Nastavit"/>
					<input type="button" name="GetTimeStampHashAlgorithmStr" value="Zjistit"/>
					&nbsp;Èíslo:&nbsp;
					<input type="text" name="TimeStampHashAlgorithmNumber" size="1"/>
					<input type="button" name="SetTimeStampHashAlgorithmNumber" value="Nastavit"/>
					<input type="button" name="GetTimeStampHashAlgorithmNumber" value="Zjistit"/>
				</td>
			</tr>
			<tr>
				<td>Algoritmus šifrování obsahu:</td>
				<td colspan="3">
				Zkratka:&nbsp;
				<input type="text" name="ContentEncryptionAlgorithmStr" size="13"/>
				<input type="button" name="SetContentEncryptionAlgorithmStr" value="Nastavit"/>
				<input type="button" name="GetContentEncryptionAlgorithmStr" value="Zjistit"/>
				&nbsp;&nbsp;Èíslo:&nbsp;
				<input type="text" name="ContentEncryptionAlgorithmNumber" size="1"/>
				<input type="button" name="SetContentEncryptionAlgorithmNumber" value="Nastavit"/>
				<input type="button" name="GetContentEncryptionAlgorithmNumber" value="Zjistit"/>
				&nbsp;&nbsp;Délka klíèe RC2:&nbsp;
				<input type="text" name="Rc2KeyBitLen" size="3"/>
				<input type="button" name="SetRc2KeyBitLen" value="Nastavit"/>
				<input type="button" name="GetRc2KeyBitLen" value="Zjistit"/>
				</td>
			</tr>
			<tr>
				<td>Hlavièka souborù:</td>
				<td>
					<select name="CfgFileHeaderOption" size="1">
						<option value="0" selected="selected">Ne</option>
						<option value="1">Ano</option>
					</select>
					<input type="button" name="CfgFileHeaderOptionSet" value="Nastavit"/>
					<input type="button" name="CfgFileHeaderOptionGet" value="Zjistit"/>
				</td>
				<td>Samostatné zpracování a oddìlovaè vısledkù:</td>
				<td>
					<input type="text" name="CfgFileSeparatorOption" size="2" value = "0"/>
					<input type="button" name="CfgFileSeparatorOptionSet" value="Nastavit"/>
					<input type="button" name="CfgFileSeparatorOptionGet" value="Zjistit"/>
				</td>
			</tr>
			<tr>
				<td>Pøipojit certifikát:</td>
				<td>
					<select name="AddCerts" size="1">
						<option value="0">ádnı</option>
						<option value="1" selected="selected">Podepisovací odesílatele</option>
						<option value="2">Podepisovací a šifrovací odesílatele</option>
					</select>
				</td>
				<td>Reim zápisu&nbsp;a&nbsp;naèítání&nbsp;souborù:</td>
				<td>
					<input type="text" name="CfgToFileOption" size="2" value = "4"/>
					<input type="button" name="CfgToFileOptionSet" value="Nastavit"/>
					<input type="button" name="CfgToFileOptionGet" value="Zjistit"/>
				</td>
			</tr>
			<tr>
				<td>Nabídnout certifikáty:</td>
				<td colspan="3">
					<select name="UseCerts" size="1">
						<option value="0" selected="selected">Implicitní</option>
						<option value="1">Naposledy pouité</option>
					</select>
				Lze zmìnit certifikát:
					<input type="checkbox" name="CertSenderSignature" value="1" title="Zaškrtnutím umoníte zmìnit naposledy pouitı podepisovací certifikát odesílatele v upozoròovacím dialogu"/>
					Podepisovací odesílatele
					<input type="checkbox" name="CertSenderKeyExchange" value="2" title="Zaškrtnutím umoníte zmìnit naposledy pouitı šifrovací certifikát odesílatele v upozoròovacím dialogu"/>
					Šifrovací odesílatele 
					<input type="checkbox" name="CertReceiverKeyExchange" value="4" title="Zaškrtnutím umoníte zmìnit naposledy pouitı šifrovací certifikát pøíjemce v upozoròovacím dialogu"/>
					Šifrovací pøíjemce
				</td>
			</tr>
			<tr>
				<td>Autentizaèní øetìzec:</td>
				<td>
					<input type="button" name="SignAuthenticationString" value="Podepsat"/>
					<input type="button" name="SetAuthenticationCert" value="Nastavit autentizaèní certifikát"/>
				</td>
				<td colspan="2" id="HashDataFilesText">
					Pro datovou zprávu 
					<input type="button" name="GetHashAction" value="Vypoèítat miniaturu"/>
					<select name="HashAlg" size="1">
						<option value="1">MD2</option>
						<option value="2">MD4</option>
						<option value="3">MD5</option>
						<option value="4" selected="selected">SHA-1</option>
						<option value="5">SHA-224</option>
						<option value="6">SHA-256</option>
						<option value="7">SHA-384</option>
						<option value="8">SHA-512</option>
					</select>
					<input type="checkbox" id="ChkBoxHashEncoded" title="Pøíznak kódování miniatury Base64"/>Kódovat Base64</td>
			</tr>
			<tr>
				<td id="CryptoFilesText">
					Krypto zprávu:
				</td>
				<td colspan="3">
					<input type="button" name="Decode" value="Dekódovat"/>
					<input type="button" name="Decrypt" value="Dešifrovat"/>
					<input type="button" name="Verify" value="Ovìøit podpis"/>
					<input type="button" name="DecryptAndVerify" value="Dešifrovat a ovìøit podpis"/>
					<input type="button" name="VerifyDetached" value="Ovìøit externí podpis"/>
					<input type="button" name="VerifyTimeStamp" value="Ovìøit èasové razítko" />
				</td>
			</tr>
			<tr>
				<td>
					Pøi ovìøení podpisu kontrolovat:
				</td>
				<td colspan="3">
					<input type="checkbox" name="VerifyCertChain" value="1"/>
					Øetìzec certifikátù
					<input type="checkbox" name="VerifyCertChainAndCRL" value="2"/>
					Øetìzec a odvolání certifikátù
					<input type="checkbox" name="VerifySigningCertificate" value="4"/>
					Podepisovací certifikát odesílatele
					<input type="checkbox" name="SignVerDlg" value="8"/>
					Zobrazit&nbsp;dialogové&nbsp;okno&nbsp;s&nbsp;vısledky&nbsp;ovìøení&nbsp;podpisù
					<br/>
					<input type="checkbox" name="VerifySignatureWithTimeStamp" title="Digitální podpis s èasovım razítkem" value="16"/>
					CAdES-T
					<input type="checkbox" name="VerifySignatureWithCompleteValidationDataReferences" title="Digitální podpis s referencemi informací na ovìøení platnosti" value="32" />
					CAdES-C
					<input type="checkbox" name="VerifySignatureEXtendedLong" title="Rozšíøenı dlouhodobı digitální podpis s úplnou informací na ovìøení platnosti" value="64" />
					CAdES-X Long
					<input type="checkbox" name="VerifySignatureArchival" title="Archivní digitální podpis" value="512" />
					CAdES-A
					<input type="button" name="CfgVerifyOptionSet" value="Nastavit"/>
					<input type="button" name="CfgVerifyOptionGet" value="Zjistit"/><br/>
				</td>
			</tr>
			<tr>
				<td>
					Pøi ovìøení èasového razítka kontrolovat:
				</td>
				<td colspan="3">
					<input type="checkbox" name="VerifyTimeStampCertChain" value="1"/>
					Øetìzec certifikátù
					<input type="checkbox" name="VerifyTimeStampCertChainAndCRL" value="2"/>
					Øetìzec a odvolání certifikátù
					<input type="checkbox" name="VerifyTimeStampSigningCertificate" value="4" />
					Podepisovací certifikát vydavatele èasového razítka
					<br/>
					<input type="checkbox" name="VerifyTimeStampWithCompleteValidationDataReferences" title="Reference informací na ovìøení platnosti podpisu èasového razítka" value="16" />
					CAdES-C
					<input type="checkbox" name="VerifyTimeStampEXtendedLong" title="Úplná informace na ovìøení platnosti podpisu èasového razítka" value="32" />
					CAdES-X Long
					<input type="checkbox" name="VerifyTimeStampNoCAndXLForLastArchiveTimeStamp" title="Vynechá kontrolu reference informací a úplnné informace na ovìøení platnosti podpisu posledního archivního èasového razítka" value="64" />
					Nekontrolovat CAdES-C a CAdES-X Long v posledním archivním èasovém razítku
					<input type="button" name="CfgVerifyTimeStampOptionSet" value="Nastavit"/>
					<input type="button" name="CfgVerifyTimeStampOptionGet" value="Zjistit"/><br/>
				</td>
			</tr>
			<tr>
				<td>Z&nbsp;podepsané&nbsp;zprávy&nbsp;získat:</td>
				<td colspan="3">
					<select name="GetSignedMessageOption" size="1">
						<option value="1" selected="selected">Zprávu</option>
						<option value="2">Soubory</option>
						<option value="3">Poèet certifikátù</option>
						<option value="4">Poèet podpisù</option>
						<option value="5">Podpis</option>
						<option value="6">Hashovací algoritmus</option>
						<option value="7">Šifrovací algoritmus</option>
						<option value="8">Podepisovací certifikát odesílatele</option>
						<option value="9">Šifrovací certifikát odesílatele</option>
						<option value="10">SN podepisovacího certifikátu odesílatele</option>
						<option value="11">CN vystavitele podepisovacího certifikátu odesílatele</option>
						<option value="12">Jednoduchı øetìzec vystavitele podepisovacího certifikátu odesílatele</option>
						<option value="13">OID øetìzec vystavitele podepisovacího certifikátu odesílatele</option>
						<option value="14">X500 øetìzec vystavitele podepisovacího certifikátu odesílatele</option>
					</select>
					Index podpisu:
					<input type="text" name="SignatureIndex" value="0" size="1"/>
					<input type="button" name="GetSignedMessageAction" value="Provést"/>
					<input type="button" name="GetMessageType" value="Typ zprávy"/>
					<input type="button" name="GetMessageOID" value="OID zprávy"/>
				</td>
			</tr>
			<tr>
				<td>Podpis:</td>
				<td colspan="3">
					<input type="button" name="SignatureDataAttach" value="Vloit data"/>
					<input type="button" name="SignatureDataDetach" value="Vyjmout data"/>
					<input type="checkbox" name="SignatureFile" value="1"/>
					Podpis v souboru
					<input type="checkbox" name="SignatureDataFile" value="1"/>
					Data v souboru
					<input type="checkbox" name="SignatureResultFile" value="1"/>
					Zapsat vısledek do souboru
				</td>
			</tr>
			<tr>
				<td>Soubory ukládat do:</td>
				<td colspan="3">
					<input type="text" name="SaveFolder" value="D:\Temp" size="124"/>
					<input type="button" name="SelectSaveFolder" value="Vybrat"/>
				</td>
			</tr>
			<tr>
				<td>
					Poslední zpracovaná zpráva:
				</td>
				<td colspan="3">
					<select name="GetLastMessageOption" size="1">
						<option value="1" selected="selected">Zjistit obsah</option>
						<option value="2">Získat text</option>
						<option value="3">Získat Base64</option>
						<option value="4">Uloit</option>
						<option value="5">Uvolnit</option>
					</select>
					<input type="button" name="GetLastMessageAction" value="Provést"/>
				</td>
			</tr>
			<tr>
				<td>
					XML Podpis:
				</td>
				<td colspan="3">
					Umístìní:&nbsp;
					<input type="text" name="XmlSignatureLocation" size="20"/>
					<input type="button" name="SetXmlSignatureLocation" value="Nastavit"/>
					<input type="button" name="GetXmlSignatureLocation" value="Zjistit"/>
				</td>
			</tr>
			<tr>
				<td>
					Formát kryptografické zprávy:
				</td>
				<td colspan="3">
					Zkratka:&nbsp;
					<input type="text" name="CryptoFormatStr" size="6"/>
					<input type="button" name="SetCryptoFormatStr" value="Nastavit"/>
					<input type="button" name="GetCryptoFormatStr" value="Zjistit"/>
					&nbsp;Èíslo:&nbsp;
					<input type="text" name="CryptoFormatNumber" size="1"/>
					<input type="button" name="SetCryptoFormatNumber" value="Nastavit"/>
					<input type="button" name="GetCryptoFormatNumber" value="Zjistit"/>
				</td>
			</tr>
		</table>
		<form method="post" action="DecryptAndVerify.asp" id="SignForm">
			<br/>
			<input type="text" size="44" readonly="readonly" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; FONT: bold 16px 'Times New Roman'; WIDTH: auto; BORDER-RIGHT-WIDTH: 0px" name="EncodedLabel" value="Krypto zpráva:"/>
			<input type="text" size="60" readonly="readonly" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; FONT: bold 16px 'Times New Roman'; WIDTH: auto; COLOR: blue; BORDER-RIGHT-WIDTH: 0px" name="MethodLabel" value="Volaná metoda"/>
			<br/>
			<textarea name="CryptoMessage" rows="3" cols="91"></textarea>
			<br/>
			<br/>
			<input type="button" name="LastError" value="Poslední chyba"/>
			<input type="button" name="DefaultOptionsDlg" value="Monosti" />
			<input type="button" name="About" value="O modulu Signer"/>
			<input type="button" name="VersionMajor" value="Hlavní verze"/>
			<input type="button" name="VersionMinor" value="Vedlejší verze"/>
			<input type="button" name="Unregister" value="Odregistrovat rozhraní COM modulu"/>
			<br/>
			<br/>
			<b>Na serveru:</b><br/>
			<input type="button" name="DecryptOnServer" value="Dešifrovat"/>
			<input type="button" name="VerifyOnServer" value="Ovìøit podpis"/>
			<input type="button" name="DecryptAndVerifyOnServer" value="Dešifrovat a ovìøit podpis"/>
			<input type="hidden" name="CryptoAction"/>
		</form>
		<br/>
		<table style="WIDTH:auto">
			<tr>
				<td colspan="3">
					<b>Podpis:</b>
				</td>
			</tr>
			<tr>
				<td>Naposledy pouitı:</td>
				<td>
					<select name="LastSignatureOption" size="1">
						<option value="1" selected="selected">OID algoritmu miniatury</option>
						<option value="2">Èíslo algoritmu miniatury</option>
						<option value="3">Zkratka algoritmu miniatury</option>
					</select>
				</td>
				<td><input type="button" name="LastSignatureAction" value="Získat" /></td>
			</tr>
			<tr>
				<td>Naposledy nastavenı podepisovanı atribut:</td>
				<td>
					<select name="LastAuthAttrOption" size="1">
						<option value="1" selected="selected">Èas podpisu</option>
						<option value="2">Miniatura SigningCertificate</option>
						<option value="3">Miniatura SigningCertificateV2</option>
						<option value="4">OID algoritmu miniatury SigningCertificateV2</option>
						<option value="5">Èíslo algoritmu miniatury SigningCertificateV2</option>
						<option value="6">Zkratka algoritmu miniatury SigningCertificateV2</option>
					</select>
				</td>
				<td><input type="button" name="LastAuthAttrAction" value="Získat" /></td>
			</tr>
			<tr>
				<td colspan="3">&nbsp;</td>
			</tr>
			<tr>
				<td>
					<b>Èasové razítko:</b>
				</td>
				<td colspan="2">
					<input type="radio" value="0" name="CfgLastTimeStampNumber" checked="checked"/>Dat nebo podpisu
					<input type="radio" value="1" name="CfgLastTimeStampNumber" />Archivní
					<input type="button" name="SetCfgLastTimeStampNumber" value="Nastavit"/>
					<input type="button" name="GetCfgLastTimeStampNumber" value="Zjistit"/>
				</td>
			</tr>
			<tr>
				<td>
					Naposledy nastavené údaje:
				</td>
				<td>
					<select name="LastTimeStampOption" size="1">
						<option value="1">Verze</option>
						<option value="2">OID politiky</option>
						<option value="3">OID algoritmu miniatury razítka</option>
						<option value="4">Èíslo algoritmus miniatury razítka</option>
						<option value="5">Zkratka algoritmu miniatury razítka</option>
						<option value="6">Miniatura</option>
						<option value="7">Sériové èíslo (SN)</option>
						<option value="8">Èas UTC (GeneralizedTime)</option>
						<option value="9">Èas UTC</option>
						<option value="10" selected="selected" >Èas lokální</option>
						<option value="11">Párovací èíslo</option>
						<option value="12">OID algoritmu miniatury podpisu</option>
						<option value="13">Èíslo algoritmus miniatury podpisu</option>
						<option value="14">Zkratka algoritmu miniatury podpisu</option>
					</select>
				</td>
				<td>
					<input name="LastTimeStampAction" type="button" value="Získat" />
				</td>
			</tr>
			<tr>
				<td>Naposledy nastavenı podepisovanı atribut:</td>
				<td>
					<select name="LastTimeStampAuthAttrOption" size="1">
						<option value="1" selected="selected">Miniatura SigningCertificate</option>
						<option value="2">Miniatura SigningCertificateV2</option>
						<option value="3">OID algoritmu miniatury SigningCertificateV2</option>
						<option value="4">Èíslo algoritmu miniatury SigningCertificateV2</option>
						<option value="5">Zkratka algoritmu miniatury SigningCertificateV2</option>
					</select>
				</td>
				<td><input type="button" name="LastTimeStampAuthAttrAction" value="Získat" /></td>
			</tr>
			<tr>
				<td>
					Naposledy nastavenı podpisovı certifikát:
				</td>
				<td>
					<select name="LastCertTimeStampSignatureOption" size="1">
						<option value="1" selected="selected">Uvolnit</option>
						<option value="2">Zobrazit dialog</option>
						<option value="3">Získat PEM</option>
						<option value="5">Získat sériové èíslo (SN)</option>
						<option value="6">Získat zaèátek platnosti</option>
						<option value="7">Získat konec platnosti</option>
						<option value="8">Získat identifikaèní øetìzec</option>
						<option value="9">Získat jméno pøedmìtu (Subject CN)</option>
						<option value="10">Získat e-mail pøedmìtu</option>
						<option value="11">Získat jednoduchı øetìzec pøedmìtu</option>
						<option value="12">Získat OID øetìzec pøedmìtu</option>
						<option value="13">Získat X500 øetìzec pøedmìtu</option>
						<option value="14">Získat jméno vystavitele (Issuer CN)</option>
						<option value="15">Získat jednoduchı øetìzec vystavitele</option>
						<option value="16">Získat OID øetìzec vystavitele</option>
						<option value="17">Získat X500 øetìzec vystavitele</option>
						<option value="18">Ovìøit øetìzec certifikátù</option>
					</select>
				</td>
				<td>
					<input name="LastCertTimeStampSignatureAction" type="button" value="Provést" />
				</td>
			</tr>
			<tr>
				<td>Poèet archivních razítek:</td>
				<td colspan="2">
					<input type="text" name="CfgVerifyTimeStampArchivalNumber" size="4"/>
					<input type="button" name="GetCfgVerifyTimeStampArchivalNumber" value="Zjistit"/>
				</td>
			</tr>
			<tr>
				<td>Index aktuálního archivního razítka:</td>
				<td colspan="2">
					<input type="text" name="CfgVerifyTimeStampArchivalIdx" size="4"/>
					<input type="button" name="SetCfgVerifyTimeStampArchivalIdx" value="Nastavit"/>
					<input type="button" name="GetCfgVerifyTimeStampArchivalIdx" value="Zjistit"/>
				</td>
			</tr>
			<tr>
				<td colspan="3">&nbsp;</td>
			</tr>
			<tr>
				<td colspan="3"><b>Autentizaèní certifikát odesílatele:</b></td>
			</tr>
			<tr>
				<td>Implicitní:</td>
				<td>
					<select name="DefaultCertSenderAuthenticationOption" size="1">
						<option value="1" selected="selected">Zobrazit dialog</option>
						<option value="2">Nastavit</option>
						<option value="3">Získat PEM</option>
						<option value="4">Nastavit PEM</option>
					</select>
				</td>
				<td><input type="button" name="DefaultCertSenderAuthenticationAction" value="Provést"/></td>
			</tr>
			<tr>
				<td colspan="3">&nbsp;</td>
			</tr>
			<tr>
				<td colspan="3"><b>Podepisovací certifikát odesílatele:</b></td>
			</tr>
			<tr>
				<td>Naposledy pouitı:</td>
				<td>
					<select name="LastCertSenderSignatureOption" size="1">
						<option value="1" selected="selected">Uvolnit</option>
						<option value="2">Zobrazit dialog</option>
						<option value="3">Získat PEM</option>
						<option value="4">Nastavit PEM</option>
						<option value="5">Získat sériové èíslo (SN)</option>
						<option value="6">Získat zaèátek platnosti</option>
						<option value="7">Získat konec platnosti</option>
						<option value="8">Získat identifikaèní øetìzec</option>
						<option value="9">Získat jméno pøedmìtu (Subject CN)</option>
						<option value="10">Získat e-mail pøedmìtu</option>
						<option value="11">Získat jednoduchı øetìzec pøedmìtu</option>
						<option value="12">Získat OID øetìzec pøedmìtu</option>
						<option value="13">Získat X500 øetìzec pøedmìtu</option>
						<option value="14">Získat jméno vystavitele (Issuer CN)</option>
						<option value="15">Získat jednoduchı øetìzec vystavitele</option>
						<option value="16">Získat OID øetìzec vystavitele</option>
						<option value="17">Získat X500 øetìzec vystavitele</option>
						<option value="20">Získat jméno CSP</option>
						<option value="18">Ovìøit øetìzec certifikátù</option>
						<option value="19">Nastavit podle vystavitele a SN</option>
					</select>
				</td>
				<td><input type="button" name="LastCertSenderSignatureAction" value="Provést"/></td>
			</tr>
			<tr>
				<td>Implicitní:</td>
				<td>
					<select name="DefaultCertSenderSignatureOption" size="1">
						<option value="1" selected="selected">Zobrazit dialog</option>
						<option value="2">Nastavit</option>
						<option value="3">Získat PEM</option>
						<option value="4">Nastavit PEM</option>
					</select>
				</td>
				<td><input type="button" name="DefaultCertSenderSignatureAction" value="Provést"/></td>
			</tr>
			<tr>
				<td>Poèet:</td>
				<td colspan="2">
					<input type="text" name="CfgCertSenderSignatureNumber" size="4"/>
					<input type="button" name="SetCfgCertSenderSignatureNumber" value="Nastavit"/>
					<input type="button" name="GetCfgCertSenderSignatureNumber" value="Zjistit"/>
					<input type="button" name="ShowAllLastErrorSignature" value="Všechny chyby podpisu"/>
				</td>
			</tr>
			<tr>
				<td>Index aktuálního:</td>
				<td colspan="2">
					<input type="text" name="CfgCertSenderSignatureIdx" size="4"/>
					<input type="button" name="SetCfgCertSenderSignatureIdx" value="Nastavit"/>
					<input type="button" name="GetCfgCertSenderSignatureIdx" value="Zjistit"/>
					<input type="button" name="LastErrorSignature" value="Aktuální chyba podpisu"/>
				</td>
			</tr>
			<tr>
				<td colspan="3">&nbsp;</td>
			</tr>
			<tr>
				<td colspan="3"><b>Šifrovací certifikát odesílatele:</b></td>
			</tr>
			<tr>
				<td>Naposledy pouitı:</td>
				<td>
					<select name="LastCertSenderKeyExchangeOption" size="1">
						<option value="1" selected="selected">Uvolnit</option>
						<option value="2">Zobrazit dialog</option>
						<option value="3">Získat PEM</option>
						<option value="4">Nastavit PEM</option>
						<option value="5">Získat sériové èíslo (SN)</option>
						<option value="6">Získat zaèátek platnosti</option>
						<option value="7">Získat konec platnosti</option>
						<option value="8">Získat identifikaèní øetìzec</option>
						<option value="9">Získat jméno pøedmìtu (Subject CN)</option>
						<option value="10">Získat e-mail pøedmìtu</option>
						<option value="11">Získat jednoduchı øetìzec pøedmìtu</option>
						<option value="12">Získat OID øetìzec pøedmìtu</option>
						<option value="13">Získat X500 øetìzec pøedmìtu</option>
						<option value="14">Získat jméno vystavitele (Issuer CN)</option>
						<option value="15">Získat jednoduchı øetìzec vystavitele</option>
						<option value="16">Získat OID øetìzec vystavitele</option>
						<option value="17">Získat X500 øetìzec vystavitele</option>
						<option value="18">Ovìøit øetìzec certifikátù</option>
						<option value="19">Nastavit podle vystavitele a SN</option>
					</select>
				</td>
				<td><input type="button" name="LastCertSenderKeyExchangeAction" value="Provést"/></td>
			</tr>
			<tr>
				<td>Implicitní:</td>
				<td>
					<select name="DefaultCertSenderKeyExchangeOption" size="1">
						<option value="1" selected="selected">Zobrazit dialog</option>
						<option value="2">Nastavit</option>
						<option value="3">Získat PEM</option>
						<option value="4">Nastavit PEM</option>
					</select>
				</td>
				<td><input type="button" name="DefaultCertSenderKeyExchangeAction" value="Provést"/></td>
			</tr>
			<tr>
				<td colspan="3">&nbsp;</td>
			</tr>
			<tr>
				<td colspan="3"><b>Šifrovací certifikát pøíjemce:</b></td>
			</tr>
			<tr>
				<td>Naposledy pouitı:</td>
				<td>
					<select name="LastCertReceiverKeyExchangeOption" size="1">
						<option value="1" selected="selected">Uvolnit</option>
						<option value="2">Zobrazit dialog</option>
						<option value="3">Získat PEM</option>
						<option value="4">Nastavit PEM</option>
						<option value="5">Získat sériové èíslo (SN)</option>
						<option value="6">Získat zaèátek platnosti</option>
						<option value="7">Získat konec platnosti</option>
						<option value="8">Získat identifikaèní øetìzec</option>
						<option value="9">Získat jméno pøedmìtu (Subject CN)</option>
						<option value="10">Získat e-mail pøedmìtu</option>
						<option value="11">Získat jednoduchı øetìzec pøedmìtu</option>
						<option value="12">Získat OID øetìzec pøedmìtu</option>
						<option value="13">Získat X500 øetìzec pøedmìtu</option>
						<option value="14">Získat jméno vystavitele (Issuer CN)</option>
						<option value="15">Získat jednoduchı øetìzec vystavitele</option>
						<option value="16">Získat OID øetìzec vystavitele</option>
						<option value="17">Získat X500 øetìzec vystavitele</option>
						<option value="18">Ovìøit øetìzec certifikátù</option>
						<option value="19">Nastavit podle vystavitele a SN</option>
					</select>
				</td>
				<td><input type="button" name="LastCertReceiverKeyExchangeAction" value="Provést"/></td>
			</tr>
			<tr>
				<td>Implicitní:</td>
				<td>
					<select name="DefaultCertReceiverKeyExchangeOption" size="1">
						<option value="1" selected="selected">Zobrazit dialog</option>
						<option value="2">Nastavit</option>
						<option value="3">Získat PEM</option>
						<option value="4">Nastavit PEM</option>
					</select>
				</td>
				<td>
					<input type="button" name="DefaultCertReceiverKeyExchangeAction" value="Provést"/>
				</td>
			</tr>
			<tr>
				<td>Poèet:</td>
				<td colspan="2">
					<input type="text" name="CfgCertReceiverKeyExchangeNumber" size="4"/>
					<input type="button" name="SetCfgCertReceiverKeyExchangeNumber" value="Nastavit"/>
					<input type="button" name="GetCfgCertReceiverKeyExchangeNumber" value="Zjistit"/>
				</td>
			</tr>
			<tr>
				<td>Index aktuálního:</td>
				<td colspan="2">
					<input type="text" name="CfgCertReceiverKeyExchangeIdx" size="4"/>
					<input type="button" name="SetCfgCertReceiverKeyExchangeIdx" value="Nastavit"/>
					<input type="button" name="GetCfgCertReceiverKeyExchangeIdx" value="Zjistit"/>
				</td>
			</tr>
			<tr>
				<td colspan="3">&nbsp;</td>
			</tr>
			<tr>
				<td>Vystavitel:</td>
				<td colspan="2">
					<input type="text" name="LastCertIssuer" size="50"/>
				</td>
			</tr>
			<tr>
				<td>SN:</td>
				<td colspan="2">
					<input type="text" name="LastCertSN" size="8"/>
					<input type="button" name="HexToDec" value="Hex => Dec"/>
					<input type="text" name="LastCertSNDec" size="8"/>
				</td>
			</tr>
			<tr>
				<td colspan="3">&nbsp;</td>
			</tr>
			<tr>
				<td colspan="3">
					<input type="button" name="VerifyCertificateChain" value="Ovìøit øetìzec certifikátù"/>
					pro tyto typy
					<input type="text" name="nCertType" size="4" value = "7"/>
				</td>
			</tr>
			<tr>
				<td colspan="3">
					<input type="button" name="ReleaseAllLastCerts" value="Uvolnit všechny naposledy pouité certifikáty"/>
				</td>
			</tr>
			<tr>
				<td colspan="3">&nbsp;</td>
			</tr>
			<tr>
				<td colspan="3"><b>Úloištì certifikátù a seznamù zneplatnìnıch certifikátù (CRL) modulu</b></td>
			</tr>
			<tr>
				<td colspan="3">
					<input type="button" name="PutCertStorePem" value="Vloit certifikáty"/>
					<input type="button" name="GetCertStorePem" value="Vypsat certifikáty"/>
					<input type="button" name="PutCrlStorePem" value="Vloit seznamy CRL"/>
					<input type="button" name="GetCrlStorePem" value="Vypsat seznamy CRL"/>
				</td>
			</tr>
		</table>
		<br/>
		<br/>
		<b>Certifikát ve tvaru PEM:</b> <input type="button" name="ShowCertPem" value="Zobrazit dialog"/>
		<br/>
		<textarea name="LastCertBox" rows="3" cols="91">
MIIDUjCCAjqgAwIBAgIDAY87MA0GCSqGSIb3DQEBBQUAMFExCzAJBgNVBAYTAkNaMRcwFQYD
VQQDEw5JLkNBIC0gVGVzdCBDQTEpMCcGA1UEChMgUHJ2bmkgY2VydGlmaWthY25pIGF1dG9y
aXRhIGEucy4wHhcNMDUwOTAxMTEyMjI5WhcNMTEwMjIyMTEyMjI5WjBIMQswCQYDVQQGEwJD
WjEUMBIGA1UEAxMLMiBTaWduYXR1cmUxIzAhBgkqhkiG9w0BCQEWFHBldHIuZG9rb3VwaWxA
cHZ0LmN6MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDgVvgwe+oecKttSYOnaN5fH0Sj
35Tpsuq2mnDKkK9EFNqXDEyrBu66MXKHtF7SBJj1RUhDPKHpaSUzHN5bCycRUGutTItuRSy9
HuuV1tHGRlsES/Grgy1mHw6b0FDiyifaA/dda2LJo14C7E0bLQu3nhjqkYyzA4rUmcgwa+R0
jwIDAQABo4G/MIG8MB0GA1UdDgQWBBQ8fzgd+TrXng9aIaAP79wikY22rDBeBgNVHSAEVzBV
MFMGCisGAQQBs2EBAQMwRTBDBggrBgEFBQcCAjA3GjVKZW4gcHJvIFRFU1RPVkFDSSB1Y2Vs
eS4gKE9ubHkgZm9yIFRFU1RJTkcgcHVycG9zZXMuKTAuBgNVHR8EJzAlMCOgIaAfhh1odHRw
Oi8vY2EuaWNhLmN6L3Rlc3RfaWNhLmNybDALBgNVHQ8EBAMCBPAwDQYJKoZIhvcNAQEFBQAD
ggEBAG/eycp6Qoqrk/ob+g3bYLxq2zS0mfmou2DiXUODjS8afz3qADC5UuLmfdxpcZfsZi5h
DluxHC/MYrdS85Bu6+d0w9Q9958NF/wvOINrRqep+RDKDgF0qisxJ7JuzgG6zH4qL4PlH5NG
Jn6FBVe7HvlwBk6GLhaXGhAgGlI6W7dwL9OqnPlCptBDmkMVvcLFaEkEZRjogtNkQ454mOx0
fgI3PLcuSyc6mXl+S3mSQb6W+I1TDO18g5MiRO6HXb2YvKqYGc28alZctMBXQK8tSaZop1h4
jmwtTFivYnzz5wjb2QP8Tx0n5Ku5uZfSqIzvvEtdk22gBgZif6tXiPmTSow=
		</textarea>
		<br/>
		<br/>
		<b>Znaková sada:</b>
		<br/>
		Zkratka:&nbsp;
		<input type="text" name="CfgCodePageStr" size="12"/>
		<input type="button" name="SetCfgCodePageStr" value="Nastavit"/>
		<input type="button" name="GetCfgCodePageStr" value="Zjistit"/>
		&nbsp;&nbsp;Èíslo:&nbsp;
		<input type="text" name="CfgCodePageNumber" size="4"/>
		<input type="button" name="SetCfgCodePageNumber" value="Nastavit"/>
		<input type="button" name="GetCfgCodePageNumber" value="Zjistit"/>
		<br/>
		Implicitní ANSI systému:&nbsp;
		<input type="text" name="SystemAnsiCodePageId" size="4"/>
		<input type="button" name="GetSystemAnsiCodePageId" value="Zjistit"/>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implicitní OEM systému:&nbsp;
		<input type="text" name="SystemOemCodePageId" size="4"/>
		<input type="button" name="GetSystemOemCodePageId" value="Zjistit"/>
		&nbsp;&nbsp;&nbsp;&nbsp;
		<br/>
		<br/>
		<b>Zobrazování upozoròovacího dialogového okna:</b>
		<br/>
		Pøíznak:&nbsp;
		<input type="text" name="CfgWarningDlg" size="3"/>
		<input type="button" name="SetCfgWarningDlg" value="Nastavit"/>
		<input type="button" name="GetCfgWarningDlg" value="Zjistit"/>
		&nbsp;&nbsp;&nbsp;&nbsp;
		<br/>
		<br/>
		<b>Zobrazování certifikátù:</b>
		<br/>
		Pøíznak:&nbsp;
		<input type="text" name="CfgShowCert" size="3"/>
		<input type="button" name="SetCfgShowCert" value="Nastavit"/>
		<input type="button" name="GetCfgShowCert" value="Zjistit"/>
		&nbsp;&nbsp;&nbsp;&nbsp;
		<br/>
		<br/>
		<b>Cryptographic Service Provider:</b>
		<input type="button" name="SetPresentCardCSP" value="Nastavit CSP aktuální karty"/>
		<br/>
		<textarea name="CSP" rows="1" cols="68"></textarea>
		<input type="button" name="SelectCryptographicServiceProvider" value="Vybrat"/>
		<input type="button" name="SetCryptographicServiceProvider" value="Nastavit"/>
		<input type="button" name="GetCryptographicServiceProvider" value="Zjistit"/>
		<br/>
		<br/>
		<b>Filtr zakázanıch CSP:</b>
		<br/>
		<textarea name="CSPFilterDenied" rows="2"  cols="74"></textarea>
		<input type="button" name="SetCryptographicServiceProviderFilterDenied" value="Nastavit"/>
		<input type="button" name="GetCryptographicServiceProviderFilterDenied" value="Zjistit"/>
		<br/>
		<br/>
		<b>Filtr povolenıch CSP:</b>
		<br/>
		<textarea name="CSPFilterAllowed" rows="2"  cols="74"></textarea>
		<input type="button" name="SetCryptographicServiceProviderFilterAllowed" value="Nastavit"/>
		<input type="button" name="GetCryptographicServiceProviderFilterAllowed" value="Zjistit"/>
		<br/>
		<br/>
		<b>GUID:</b>
		<br/>
		<textarea name="Guid" rows="1" readonly="readonly" cols="63"></textarea>
		<select name="GuidForm" size="1">
			<option value="1" selected="selected">Registry velká písmena</option>
			<option value="2">Registry malá písmena</option>
		</select>
		<input type="button" name="CreateGuid" value="GUID"/>
		<br/>
		<br/>
		<b>Jazyk:</b>
		<br/>
		Zkratka:&nbsp;
		<input type="text" name="LanguageStr" size="3"/>
		<input type="button" name="SetLanguageStr" value="Nastavit"/>
		<input type="button" name="GetLanguageStr" value="Zjistit"/>
		&nbsp;&nbsp;&nbsp;&nbsp;Èíslo:&nbsp;
		<input type="text" name="LanguageNumber" size="3"/>
		<input type="button" name="SetLanguageNumber" value="Nastavit"/>
		<input type="button" name="GetLanguageNumber" value="Zjistit"/>
		<br/>
		<br/>
		<b>Mazání certifikátù na kartì:</b>
		<br/>
		CSP:&nbsp;
		<input type="text" name="DeleteCertsCSP" size="40" value="I.CA CryptoPlus CSP v1.0"/>
		&nbsp; Øetìzec kontejneru:&nbsp;
		<input type="text" name="ContainerStr" size="10" value="IB_"/>
		<input type="button" name="DeleteCerts" value="Smazat certifikáty"/>
		<br />
		<br />
		<b>Nastavení TSA:</b>
		<br />
		Sever:&nbsp;
		<input name="TsaServer" size="40" type="text" />
		<input name="GetTsaServer" type="button" value="Zjistit" />
		&nbsp;
		Politika:&nbsp;
		<input name="TsaPolicy" size="40" type="text" />
		<input name="GetTsaPolicy" type="button" value="Zjistit" />
		<br />
		<br />
		<b>Vıbìr souboru:</b>
		<br />
		Sloka:&nbsp;
		<input name="GetFileNameDlgInitialFolder" size="48" type="text" value="D:\Temp"/>
		&nbsp;&nbsp;Soubor:&nbsp;
		<input name="GetFileNameDlgInitialFile" size="48" type="text" value="Soubor.txt"/>
		<br />
		Titulek:&nbsp;
		<input name="GetFileNameDlgTitle" size="48" type="text" value="Vıbìr souboru"/>
		&nbsp;
		<input type="checkbox" name="GetFileNameDlgSaveFile" value="1" title="Pøíznak zobrazení dialogového okna Uloit nebo Otevøít"/>Dialog Uloit
		&nbsp;&nbsp;
		<input type="checkbox" name="GetFileNameAllowMultiselect" value="2" title="Pøíznak povolení vıbìru více souborù"/>Povolit vıbìr více souborù
		&nbsp;&nbsp;
		<input type="button" name="GetFileNameDlg" value="Vybrat"/>
		<br/>
		<br/>
		<b>Posílání e-mailù:</b>
		<br/>
		<table style="WIDTH:auto">
			<tr>
				<td>Server:</td>
				<td><input type="text" name="EmailServer" value="smtp.nextra.cz" size="109"/></td>
			</tr>
			<tr>
				<td>Port:</td>
				<td><input type="text" name="EmailServerPort" value="25" size="109"/></td>
			</tr>
			<tr>
				<td>Od koho:</td>
				<td><input type="text" name="EmailFrom" value="petr.dokoupil@asseco.cz" size="109"/></td>
			</tr>
			<tr>
				<td>Komu:</td>
				<td><input type="text" name="EmailTo" value="petr.dokoupil@asseco.cz" size="109"/></td>
			</tr>
			<tr>
				<td>Odpovìï:</td>
				<td><input type="text" name="EmailReplyTo" value="petr.dokoupil@asseco.cz" size="109"/></td>
			</tr>
			<tr>
				<td>Pøedmìt:</td>
				<td><input type="text" name="EmailSubject" value="Test SendEmail" size="109"/></td>
			</tr>
			<tr>
				<td valign="top">
					Zpráva:
					<br/>
					<br/>
					<input type="button" name="SendMail" value="Odeslat"/>
				</td>
				<td>
					<textarea rows="4" cols="82" name="EmailMessage">Zkouška metody SendEmail</textarea>
				</td>
			</tr>
		</table>
		<br/>
		<a href="mailto:petr.dokoupil@asseco.cz?    CC=petr.dokoupil@adslink.cz&amp;    BCC=petr.dokoupil@t-email.cz&amp;    subject=Pokus&amp;    body=První%20øádek.%0d%0aDruhı%20øádek">
			Vyvolání e-mailového klienta odkazem.
		</a>
		<form action="mailto:petr.dokoupil@asseco.cz?CC=petr.dokoupil@adslink.cz&amp;BCC=petr.dokoupil@t-email.cz&amp;subject=Pokus"
			method="post" enctype="text/plain">
			Odeslání e-mailu z formuláøe:<br/>
			<textarea name="body" cols="40" rows="1">
První øádek.
Druhı øádek.
			</textarea>
			<input type="submit" value="Odeslat e-mail"/>
		</form>
	</body>

<script type="text/vbscript">
Sub InitializePage
	On Error Resume Next
	ChkBoxDataFiles_OnClick
	ChkBoxCryptoFiles_OnClick

	CfgLastTimeStampNumberValue = Signer.CfgLastTimeStampNumber
	If Err.number = 0 Then
		Select Case CfgLastTimeStampNumberValue
			Case 0
				CfgLastTimeStampNumber(0).checked = True
				CfgLastTimeStampNumber(1).checked = False
			Case 1
				CfgLastTimeStampNumber(0).checked = False
				CfgLastTimeStampNumber(1).checked = True
			Case Else
				Resp = MsgBox("Chyba pøi zjišování nastavení obsahu posledního èasového razítka", vbInformation, "Nastavení obsahu posledního èasového razítka")
		End Select
	End If

End Sub

Sub ChkBoxDataFiles_OnClick
	IF ChkBoxDataFiles.Checked = True Then
		DataFilesText.replaceAdjacentText "AfterBegin","Datové soubory:"
		HashDataFilesText.replaceAdjacentText "AfterBegin","Pro datové soubory "
	Else
		DataFilesText.replaceAdjacentText "AfterBegin","Datovou zprávu:"
		HashDataFilesText.replaceAdjacentText "AfterBegin","Pro datovou zprávu "
	End IF
End Sub

Sub ChkBoxCryptoFiles_OnClick
	IF ChkBoxCryptoFiles.Checked = True Then
		CryptoFilesText.replaceAdjacentText "AfterBegin","Krypto soubory:"
	Else
		CryptoFilesText.replaceAdjacentText "AfterBegin","Krypto zprávu:"
	End IF
End Sub

Sub SelectDataFiles_OnClick
	On Error Resume Next
	Dim strSelFile, strFilter
	strFilter = "Všechny soubory (*.*)" + vbNullChar + "*.*" + vbNullChar + vbNullChar
	strSelFile = Signer.GetFileNameDlg(vbNullString, vbNullString, "Vıbìr datovıch souborù", strFilter, 2)
	If Err.number = 0 Then
		DataFiles.value = strSelFile
	End If
End Sub

Sub SelectCryptoFiles_OnClick
	On Error Resume Next
	Dim strSelFile, strFilter
	strFilter = "Všechny soubory (*.*)" + vbNullChar + "*.*" + vbNullChar + vbNullChar
	strSelFile = Signer.GetFileNameDlg(vbNullString, vbNullString, "Vıbìr krypto souborù", strFilter, 2)
	If Err.number = 0 Then
		CryptoFiles.value = strSelFile
	End If
End Sub

Sub SelectSaveFolder_OnClick
	On Error Resume Next
	Dim strSelFile, strFilter
	strFilter = "Všechny soubory (*.*)" + vbNullChar + "*.*" + vbNullChar + vbNullChar
	strSelFile = Signer.GetFileNameDlg(vbNullString, vbNullString, "Vıbìr úloištì souborù", strFilter, 2)
	If Err.number = 0 Then
		SaveFolder.value = strSelFile
	End If
End Sub

Sub Encode_OnClick
	On Error Resume Next
	If ChkBoxDataFiles.Checked = True Then
		SignForm.EncodedLabel.value = "Kódované datové soubory (Base64):"
		If ChkBoxCryptoFiles.Checked = True Then
			Signer.EncodeFileToFile DataFiles.value, CryptoFiles.value
			SignForm.MethodLabel.value = "Signer.EncodeFileToFile(Datové soubory, Krypto soubory)"
			If Err.number = 0 Then
				SignForm.CryptoMessage.value = "Datové soubory kódované Base64 jsou uloeny v krypto souborech."
			End If
		Else
			SignForm.CryptoMessage.value = Signer.EncodeFile(DataFiles.value)
			SignForm.MethodLabel.value = "Signer.EncodeFile(Datové soubory)"
		End If
	Else
		SignForm.EncodedLabel.value = "Kódovaná datová zpráva (Base64):"
		If ChkBoxCryptoFiles.Checked = True Then
			Signer.EncodeToFile Message.value, CryptoFiles.value
			SignForm.MethodLabel.value = "Signer.EncodeToFile(Datová zpráva, Krypto soubor)"
			If Err.number = 0 Then
				SignForm.CryptoMessage.value = "Datová zpráva kódovaná Base64 je uloena v krypto souboru."
			End If
		Else
			SignForm.CryptoMessage.value = Signer.Encode(Message.value)
			SignForm.MethodLabel.value = "Signer.Encode(Datová zpráva)"
		End If
	End If
	If Err.number <> 0 Then
		SignForm.EncodedLabel.value = "Chybové hlášení:"
		SignForm.CryptoMessage.value = HandleError
	End If
End Sub

Sub Sign_OnClick
	On Error Resume Next
	If ChkBoxDataFiles.Checked = True Then
		SignForm.EncodedLabel.value = "Podpisy datovıch souborù:"
		If UseCerts.value = 0 Then
			If ChkBoxCryptoFiles.Checked = True Then
				Signer.SignFileToFile DataFiles.value, CryptoFiles.value, AddCerts.value
				SignForm.MethodLabel.value = "Signer.SignFileToFile(Datové soubory, Krypto soubory), " + CStr(AddCerts.value) + ")"
				If Err.number = 0 Then
					SignForm.CryptoMessage.value = "Podpisy datovıch souborù jsou uloeny v krypto souborech."
				End If
			Else
				SignForm.CryptoMessage.value = Signer.SignFile(DataFiles.value, AddCerts.value)
				SignForm.MethodLabel.value = "Signer.SignFile(Datové soubory, " + CStr(AddCerts.value) + ")"
			End If
		Else
			If ChkBoxCryptoFiles.Checked = True Then
				Signer.SignFileToFileUseLastCerts DataFiles.value, CryptoFiles.value, AddCerts.value, CanChangeCerts()
				SignForm.MethodLabel.value = "Signer.SignFileToFileUseLastCerts(Soubory, Soubory, " + CStr(AddCerts.value) + ", " + CStr(CanChangeCerts()) + ")"
				If Err.number = 0 Then
					SignForm.CryptoMessage.value = "Podepsané datové soubory jsou uloeny v krypto souborech."
				End If
			Else
				SignForm.CryptoMessage.value = Signer.SignFileUseLastCerts(DataFiles.value, AddCerts.value, CanChangeCerts())
				SignForm.MethodLabel.value = "Signer.SignFileUseLastCerts(Soubory, " + CStr(AddCerts.value) + ", " + CStr(CanChangeCerts()) + ")"
			End If
		End If
	Else
		If UseCerts.value = 0 Then
			If ChkBoxCryptoFiles.Checked = True Then
				Signer.SignToFile Message.value, CryptoFiles.value, AddCerts.value
				SignForm.MethodLabel.value = "Signer.SignToFile(Zpráva, Soubor, " + CStr(AddCerts.value) + ")"
				If Err.number = 0 Then
					SignForm.CryptoMessage.value = "Podepsaná zpráva je uloena v krypto souboru."
					SignForm.EncodedLabel.value = "Podepsaná zpráva:"
					MsgBox "Podepsaná zpráva je uloena v krypto souboru.", vbInformation, "Digitální podpis zprávy metodou SignToFile"
				End If
			Else
				SignForm.CryptoMessage.value = Signer.Sign(Message.value, AddCerts.value)
				SignForm.EncodedLabel.value = "Podepsaná zpráva:"
				SignForm.MethodLabel.value = "Signer.Sign(Zpráva, " + CStr(AddCerts.value) + ")"
			End If
		Else
			If ChkBoxCryptoFiles.Checked = True Then
				Signer.SignToFileUseLastCerts Message.value, CryptoFiles.value, AddCerts.value, CanChangeCerts()
				SignForm.MethodLabel.value = "Signer.SignToFileUseLastCerts(Zpráva, Soubor, " + CStr(AddCerts.value) + ", " + CStr(CanChangeCerts()) + ")"
				If Err.number = 0 Then
					SignForm.CryptoMessage.value = "Podepsaná zpráva je uloena v krypto souboru."
					SignForm.EncodedLabel.value = "Podepsaná zpráva:"
					MsgBox "Podepsaná zpráva je uloena v krypto souboru.", vbInformation, "Digitální podpis zprávy metodou SignToFileUseLastCerts"
				End If
			Else
				SignForm.CryptoMessage.value = Signer.SignUseLastCerts(Message.value, AddCerts.value, CanChangeCerts())
				SignForm.EncodedLabel.value = "Podepsaná zpráva:"
				SignForm.MethodLabel.value = "Signer.SignUseLastCerts(Zpráva, " + CStr(AddCerts.value) + ", " + CStr(CanChangeCerts()) + ")"
			End If
		End If
	End If
	If Err.number <> 0 Then
		If Signer.LastErrorNumber = 11 Then
			MsgBox Signer.LastErrorStr, vbInformation, "Ne"
		End If
		If Signer.LastErrorNumber = 12 Then
			MsgBox Signer.LastErrorStr, vbInformation, "Storno"
		End If
		SignForm.EncodedLabel.value = "Chybové hlášení:"
		SignForm.CryptoMessage.value = HandleError
	End If
End Sub

Sub SignDetached_OnClick
	On Error Resume Next
	If ChkBoxDataFiles.Checked = True Then
		If UseCerts.value = 0 Then
			If ChkBoxCryptoFiles.Checked = True Then
				Signer.SignFileToFileDetached DataFiles.value, CryptoFiles.value, AddCerts.value
				SignForm.MethodLabel.value = "Signer.SignFileToFileDetached(Soubory, Soubory, " + CStr(AddCerts.value) + ")"
				If Err.number = 0 Then
					SignForm.CryptoMessage.value = "Externí podpisy datovıch souborù jsou uloeny v krypto souborech."
					SignForm.EncodedLabel.value = "Externí podpisy souborù:"
					MsgBox "Externí podpisy datovıch souborù jsou uloeny v krypto souborech.", vbInformation, "Externí digitální podpis souborù metodou SignFileToFileDetached"
				End If
			Else
				SignForm.CryptoMessage.value = Signer.SignFileDetached(DataFiles.value, AddCerts.value)
				SignForm.EncodedLabel.value = "Externí podpisy souborù:"
				SignForm.MethodLabel.value = "Signer.SignFileDetached(Soubory, " + CStr(AddCerts.value) + ")"
			End If
		Else
			If ChkBoxCryptoFiles.Checked = True Then
				Signer.SignFileToFileDetachedUseLastCerts DataFiles.value, CryptoFiles.value, AddCerts.value
				SignForm.MethodLabel.value = "Signer.SignFileToFileDetachedUseLastCerts(Soubory, Soubory, " + CStr(AddCerts.value) + ")"
				If Err.number = 0 Then
					SignForm.CryptoMessage.value = "Externí podpisy datovıch souborù jsou uloeny v krypto souborech."
					SignForm.EncodedLabel.value = "Externí podpisy souborù:"
					MsgBox "Externí podpisy datovıch souborù jsou uloeny v krypto souborech.", vbInformation, "Externí digitální podpis souborù metodou SignFileToFileDetachedUseLastCerts"
				End If
			Else
				SignForm.CryptoMessage.value = Signer.SignFileDetachedUseLastCerts(DataFiles.value, AddCerts.value, CanChangeCerts())
				SignForm.EncodedLabel.value = "Externí podpisy souborù:"
				SignForm.MethodLabel.value = "Signer.SignFileDetachedUseLastCerts(Soubory, " + CStr(AddCerts.value) + ", " + CStr(CanChangeCerts()) + ")"
			End If
		End If
	Else
		If UseCerts.value = 0 Then
			If ChkBoxCryptoFiles.Checked = True Then
				Signer.SignToFileDetached Message.value, CryptoFiles.value, AddCerts.value
				SignForm.MethodLabel.value = "Signer.SignToFileDetached(Zpráva, Soubor, " + CStr(AddCerts.value) + ")"
				If Err.number = 0 Then
					SignForm.CryptoMessage.value = "Externí podpis zprávy je uloen v krypto souboru."
					SignForm.EncodedLabel.value = "Externí podpis zprávy:"
					MsgBox "Externí podpis zprávy je uloen v krypto souboru.", vbInformation, "Externí digitální podpis zprávy metodou SignToFileDetached"
				End If
			Else
				SignForm.CryptoMessage.value = Signer.SignDetached(Message.value, AddCerts.value)
				SignForm.EncodedLabel.value = "Externí podpis zprávy:"
				SignForm.MethodLabel.value = "Signer.SignDetached(Zpráva, " + CStr(AddCerts.value) + ")"
			End If
		Else
			If ChkBoxCryptoFiles.Checked = True Then
				Signer.SignToFileDetachedUseLastCerts Message.value, CryptoFiles.value, AddCerts.value, CanChangeCerts()
				SignForm.MethodLabel.value = "Signer.SignToFileDetachedUseLastCerts(Zpráva, Soubor, " + CStr(AddCerts.value) + ", " + CStr(CanChangeCerts()) + ")"
				If Err.number = 0 Then
					SignForm.CryptoMessage.value = "Externí podpis zprávy je uloen v krypto souboru."
					SignForm.EncodedLabel.value = "Externí podpis zprávy:"
					MsgBox "Externí podpis je uloen v krypto souboru.", vbInformation, "Externí digitální podpis zprávy metodou SignToFileDetachedUseLastCerts"
				End If
			Else
				SignForm.CryptoMessage.value = Signer.SignDetachedUseLastCerts(Message.value, AddCerts.value, CanChangeCerts())
				SignForm.EncodedLabel.value = "Externí podpis zprávy:"
				SignForm.MethodLabel.value = "Signer.SignDetachedUseLastCerts(Zpráva, " + CStr(AddCerts.value) + ", " + CStr(CanChangeCerts())+ ")"
			End If
		End If
	End If
	If Err.number <> 0 Then
		If Signer.LastErrorNumber = 11 Then
			MsgBox Signer.LastErrorStr, vbInformation, "Ne"
		End If
		If Signer.LastErrorNumber = 12 Then
			MsgBox Signer.LastErrorStr, vbInformation, "Storno"
		End If
		SignForm.EncodedLabel.value = "Chybové hlášení:"
		SignForm.CryptoMessage.value = HandleError
	End If
End Sub

Sub Encrypt_OnClick
	On Error Resume Next
	If ChkBoxDataFiles.Checked = True Then
		If UseCerts.value = 0 Then
			If ChkBoxCryptoFiles.Checked = True Then
				Signer.EncryptFileToFile DataFiles.value, CryptoFiles.value
				SignForm.MethodLabel.value = "Signer.EncryptFileToFile(Soubory, Soubory)"
				If Err.number = 0 Then
					SignForm.CryptoMessage.value = "Šifrované datové soubory jsou uloeny v krypto souborech."
					SignForm.EncodedLabel.value = "Šifrované soubory:"
					MsgBox "Šifrované datové soubory jsou uloeny v krypto souborech.", vbInformation, "Šifrování souborù metodou EncryptFileToFile"
				End If
			Else
				SignForm.CryptoMessage.value = Signer.EncryptFile(DataFiles.value)
				SignForm.EncodedLabel.value = "Šifrované soubory:"
				SignForm.MethodLabel.value = "Signer.EncryptFile(Soubory)"
			End If
		Else
			If ChkBoxCryptoFiles.Checked = True Then
				Signer.EncryptFileToFileUseLastCerts DataFiles.value, CryptoFiles.value, CanChangeCerts()
				SignForm.MethodLabel.value = "Signer.EncryptFileToFileUseLastCerts(Soubory, Soubory, " + CStr(CanChangeCerts()) + ")"
				If Err.number = 0 Then
					SignForm.CryptoMessage.value = "Šifrované datové soubory jsou uloeny v krypto souborech."
					SignForm.EncodedLabel.value = "Šifrované soubory:"
					MsgBox "Šifrované soubory jsou uloeny ve vıstupních souborech.", vbInformation, "Šifrování souborù metodou EncryptFileToFileUseLastCerts"
				End If
			Else
				SignForm.CryptoMessage.value = Signer.EncryptFileUseLastCerts(DataFiles.value, CanChangeCerts())
				SignForm.EncodedLabel.value = "Zašifrované soubory:"
				SignForm.MethodLabel.value = "Signer.EncryptFileUseLastCerts(Soubory" + CStr(CanChangeCerts()) + ")"
			End If
		End If
	Else
		If UseCerts.value = 0 Then
			If ChkBoxCryptoFiles.Checked = True Then
				Signer.EncryptToFile Message.value, CryptoFiles.value
				SignForm.MethodLabel.value = "Signer.EncryptToFile(Zpráva, Soubor)"
				If Err.number = 0 Then
					SignForm.CryptoMessage.value = "Šifrovaná zpráva je uloena v krypto souboru."
					SignForm.EncodedLabel.value = "Šifrovaná zpráva:"
					MsgBox "Šifrovaná zpráva je uloena v krypto souboru.", vbInformation, "Šifrování zprávy metodou EncryptToFile"
				End If
			Else
				SignForm.CryptoMessage.value = Signer.Encrypt(Message.value)
				SignForm.EncodedLabel.value = "Šifrovaná zpráva:"
				SignForm.MethodLabel.value = "Signer.Encrypt(Zpráva)"
			End If
		Else
			If ChkBoxCryptoFiles.Checked = True Then
				Signer.EncryptToFileUseLastCerts Message.value, CryptoFiles.value, CanChangeCerts()
				SignForm.MethodLabel.value = "Signer.EncryptToFileUseLastCerts(Zpráva, Soubor, " + CStr(CanChangeCerts()) + ")"
				If Err.number = 0 Then
					SignForm.CryptoMessage.value = "Šifrovaná zpráva je uloena v krypto souboru."
					SignForm.EncodedLabel.value = "Šifrovaná zpráva:"
					MsgBox "Šifrovaná zpráva je uloena v krypto souboru.", vbInformation, "Šifrování zprávy metodou EncryptToFileUseLastCerts"
				End If
			Else
				SignForm.CryptoMessage.value = Signer.EncryptUseLastCerts(Message.value, CanChangeCerts())
				SignForm.EncodedLabel.value = "Šifrovaná zpráva:"
				SignForm.MethodLabel.value = "Signer.EncryptUseLastCerts(Zpráva, " + CStr(CanChangeCerts()) + ")"
			End If
		End If
	End If
	If Err.number <> 0 Then
		If Signer.LastErrorNumber = 11 Then
			MsgBox Signer.LastErrorStr, vbInformation, "Ne"
		End If
		If Signer.LastErrorNumber = 12 Then
			MsgBox Signer.LastErrorStr, vbInformation, "Storno"
		End If
		SignForm.EncodedLabel.value = "Chybové hlášení:"
		SignForm.CryptoMessage.value = HandleError
	End If
End Sub

Sub SignAndEncrypt_OnClick
	On Error Resume Next
	If ChkBoxDataFiles.Checked = True Then
		If UseCerts.value = 0 Then
			If ChkBoxCryptoFiles.Checked = True Then
				Signer.SignAndEncryptFileToFile DataFiles.value, CryptoFiles.value, AddCerts.value
				SignForm.MethodLabel.value = "Signer.SignAndEncryptFileToFile(Soubory, Soubory, " + CStr(AddCerts.value) + ")"
				If Err.number = 0 Then
					SignForm.CryptoMessage.value = "Podepsané a šifrované datové soubory jsou uloeny v krypto souborech."
					SignForm.EncodedLabel.value = "Podepsaná a šifrovaná soubory:"
					MsgBox "Podepsané a šifrované datové soubory jsou uloeny v krypto souborech.", vbInformation, "Podpis a šifrování souborù metodou SignAndEncryptFileToFile"
				End If
			Else
				SignForm.CryptoMessage.value = Signer.SignAndEncryptFile(DataFiles.value, AddCerts.value)
				SignForm.EncodedLabel.value = "Podepsané a šifrované soubory:"
				SignForm.MethodLabel.value = "Signer.SignAndEncryptFile(Soubory, " + CStr(AddCerts.value) + ")"
			End If
		Else
			If ChkBoxCryptoFiles.Checked = True Then
				Signer.SignAndEncryptFileToFileUseLastCerts DataFiles.value, CryptoFiles.value, AddCerts.value, CanChangeCerts()
				SignForm.MethodLabel.value = "Signer.SignAndEncryptFileToFileUseLastCerts(Soubory, Soubory, " + CStr(AddCerts.value) + ", " + CStr(CanChangeCerts()) + ")"
				If Err.number = 0 Then
					SignForm.CryptoMessage.value = "Podepsané a šifrované datové soubory jsou uloeny v krypto souborech."
					SignForm.EncodedLabel.value = "Podepsaná a šifrovaná soubory:"
					MsgBox "Podepsané a šifrované datové soubory jsou uloeny v krypto souborech.", vbInformation, "Podpis a šifrování souborù metodou SignAndEncryptFileToFileUseLastCerts"
				End If
			Else
				SignForm.CryptoMessage.value = Signer.SignAndEncryptFileUseLastCerts(DataFiles.value, AddCerts.value, CanChangeCerts())
				SignForm.EncodedLabel.value = "Podepsané a šifrované soubory:"
				SignForm.MethodLabel.value = "Signer.SignAndEncryptFileUseLastCerts(Soubory, " + CStr(AddCerts.value) + ", " + CStr(CanChangeCerts()) + ")"
			End If
		End If
	Else
		If UseCerts.value = 0 Then
			If ChkBoxCryptoFiles.Checked = True Then
				Signer.SignAndEncryptToFile Message.value, CryptoFiles.value, AddCerts.value
				SignForm.MethodLabel.value = "Signer.SignAndEncryptToFile(Zpráva, Soubor, " + CStr(AddCerts.value) + ")"
				If Err.number = 0 Then
					SignForm.CryptoMessage.value = "Podepsaná a šifrovaná zpráva je uloena v krypto souboru."
					SignForm.EncodedLabel.value = "Podepsaná a šifrovaná zpráva:"
					MsgBox "Podepsaná a šifrovaná zpráva je uloena v krypto souboru.", vbInformation, "Podpis a šifrování zprávy metodou SignAndEncryptToFile"
				End If
			Else
				SignForm.CryptoMessage.value = Signer.SignAndEncrypt(Message.value, AddCerts.value)
				SignForm.EncodedLabel.value = "Podepsaná a šifrovaná zpráva:"
				SignForm.MethodLabel.value = "Signer.SignAndEncrypt(Zpráva, " + CStr(AddCerts.value) + ")"
			End If
		Else
			If ChkBoxCryptoFiles.Checked = True Then
				Signer.SignAndEncryptToFileUseLastCerts Message.value, CryptoFiles.value, AddCerts.value, CanChangeCerts()
				SignForm.MethodLabel.value = "Signer.SignAndEncryptToFileUseLastCerts(Zpráva, Soubor, " + CStr(AddCerts.value) + ", " + CStr(CanChangeCerts()) + ")"
				If Err.number = 0 Then
					SignForm.CryptoMessage.value = "Podepsaná a šifrovaná zpráva je uloena v krypto souboru."
					SignForm.EncodedLabel.value = "Podepsaná a šifrovaná zpráva:"
					MsgBox "Podepsaná a šifrovaná zpráva je uloena ve vıstupním souboru.", vbInformation, "Podpis a šifrování zprávy metodou SignAndEncryptToFileUseLastCerts"
				End If
			Else
				SignForm.CryptoMessage.value = Signer.SignAndEncryptUseLastCerts(Message.value, AddCerts.value, CanChangeCerts())
				SignForm.EncodedLabel.value = "Podepsaná a zašifrovaná zpráva:"
				SignForm.MethodLabel.value = "Signer.SignAndEncryptUseLastCerts(Zpráva, " + CStr(AddCerts.value) + ", " + CStr(CanChangeCerts()) + ")"
			End If
		End If
	End If
	If Err.number <> 0 Then
		If Signer.LastErrorNumber = 11 Then
			MsgBox Signer.LastErrorStr, vbInformation, "Ne"
		End If
		If Signer.LastErrorNumber = 12 Then
			MsgBox Signer.LastErrorStr, vbInformation, "Storno"
		End If
		SignForm.EncodedLabel.value = "Chybové hlášení:"
		SignForm.CryptoMessage.value = HandleError
	End If
End Sub

Sub TimeStamp_OnClick
	On Error Resume Next
	If Signer.CfgTimeStamp = 0 Then
		If ChkBoxDataFiles.Checked = True Then
			If ChkBoxCryptoFiles.Checked = True Then
				Signer.TimeStampFileToFile DataFiles.value, CryptoFiles.value
				If Err.number = 0 Then
					SignForm.CryptoMessage.value = "Èasová razítka datovıch souborù jsou uloena v krypto souborech."
					SignForm.EncodedLabel.value = "Èasová razítka souborù:"
					MsgBox "Èasová razítka datovıch souborù jsou uloena v krypto souborech.", vbInformation, "Vytvoøení èasovıch razítek souborù metodou TimeStampFileToFile"
				End If
				SignForm.MethodLabel.value = "Signer.TimeStampFileToFile(Soubory, Soubory)"
			Else
				SignForm.CryptoMessage.value = Signer.TimeStampFile(DataFiles.value)
				SignForm.EncodedLabel.value = "Èasová razítka souborù:"
				SignForm.MethodLabel.value = "Signer.TimeStampFile(Soubory)"
			End If
		Else
			If ChkBoxCryptoFiles.Checked = True Then
				Signer.TimeStampToFile Message.value, CryptoFiles.value
				If Err.number = 0 Then
					SignForm.CryptoMessage.value = "Èasové razítko zprávy je uloeno v krypto souboru."
					SignForm.EncodedLabel.value = "Èasové razítko zprávy:"
					MsgBox "Èasové razítko zprávy je uloeno v krypto souboru.", vbInformation, "Vytvoøení èasového razítka zprávy metodou TimeStampToFile"
				End If
				SignForm.MethodLabel.value = "Signer.TimeStampToFile(Zpráva, Soubor)"
			Else
				SignForm.CryptoMessage.value = Signer.TimeStamp(Message.value)
				SignForm.EncodedLabel.value = "Èasové razítko zprávy:"
				SignForm.MethodLabel.value = "Signer.TimeStamp(Zpráva)"
			End If
		End If
	Else
		If SignatureResultFile.Checked = True Then
			If ChkBoxCryptoFiles.Checked = True Then
				Signer.TimeStampFileToFile CryptoFiles.value, SaveFolder.value
				If Err.number = 0 Then
					SignForm.CryptoMessage.value = "Do souborù podpisù byly vloeny poadované atributy a vısledné podpisy jsou uloeny v odpovídajících souborech."
					SignForm.EncodedLabel.value = "Vloení atributù do souborù podpisù:"
					MsgBox "Digitální podpisy s poadovanımi atributy jsou uloeny v odpovídajících souborech.", vbInformation, "Vytvoøení souborù digitálch podpisù s poadovanımi atributy metodou TimeStampFileToFile"
				End If
				SignForm.MethodLabel.value = "Signer.TimeStampFileToFile(Soubory, Soubory)"
			Else
				Signer.TimeStampToFile SignForm.CryptoMessage.value, SaveFolder.value
				If Err.number = 0 Then
					SignForm.CryptoMessage.value = "Do podpisù byly vloeny poadované atributy a vısledné podpisy jsou uloeny v odpovídajícím souboru."
					SignForm.EncodedLabel.value = "Vloení atributù do souboru podpisù:"
					MsgBox "Digitální podpisy s poadovanımi atributy jsou uloeny v odpovídajícím souboru.", vbInformation, "Vytvoøení souboru digitálch podpisù s poadovanımi atributy metodou TimeStampToFile"
				End If
				SignForm.MethodLabel.value = "Signer.TimeStampToFile(Zpráva, Soubor)"
			End If
		Else
			If ChkBoxCryptoFiles.Checked = True Then
				SignForm.CryptoMessage.value = Signer.TimeStampFile(CryptoFiles.value)
				SignForm.EncodedLabel.value = "Digitální podpisy s poadovanımi atributy:"
				SignForm.MethodLabel.value = "Signer.TimeStampFile(Soubory)"
			Else
				SignForm.CryptoMessage.value = Signer.TimeStamp(SignForm.CryptoMessage.value)
				SignForm.EncodedLabel.value = "Digitální podpisy s poadovanımi atributy:"
				SignForm.MethodLabel.value = "Signer.TimeStamp(Zpráva)"
			End If
		End If
	End If
	If Err.number <> 0 Then
		SignForm.EncodedLabel.value = "Chybové hlášení:"
		SignForm.CryptoMessage.value = HandleError
	End If
End Sub

Sub TimeStampDetached_OnClick
	On Error Resume Next
	If Signer.CfgTimeStamp = 0 Then
		If ChkBoxDataFiles.Checked = True Then
			If ChkBoxCryptoFiles.Checked = True Then
				Signer.TimeStampFileToFile DataFiles.value, CryptoFiles.value
				If Err.number = 0 Then
					SignForm.CryptoMessage.value = "Èasová razítka datovıch souborù jsou uloena v krypto souborech."
					SignForm.EncodedLabel.value = "Èasová razítka souborù:"
					MsgBox "Èasová razítka datovıch souborù jsou uloena v krypto souborech.", vbInformation, "Vytvoøení èasovıch razítek souborù metodou TimeStampFileToFile"
				End If
				SignForm.MethodLabel.value = "Signer.TimeStampFileToFile(Soubory, Soubory)"
			Else
				SignForm.CryptoMessage.value = Signer.TimeStampFile(DataFiles.value)
				SignForm.EncodedLabel.value = "Èasová razítka souborù:"
				SignForm.MethodLabel.value = "Signer.TimeStampFile(Soubory)"
			End If
		Else
			If ChkBoxCryptoFiles.Checked = True Then
				Signer.TimeStampToFile Message.value, CryptoFiles.value
				If Err.number = 0 Then
					SignForm.CryptoMessage.value = "Èasové razítko zprávy je uloeno v krypto souboru."
					SignForm.EncodedLabel.value = "Èasové razítko zprávy:"
					MsgBox "Èasové razítko zprávy je uloeno v krypto souboru.", vbInformation, "Vytvoøení èasového razítka zprávy metodou TimeStampToFile"
				End If
				SignForm.MethodLabel.value = "Signer.TimeStampToFile(Zpráva, Soubor)"
			Else
				SignForm.CryptoMessage.value = Signer.TimeStamp(Message.value)
				SignForm.EncodedLabel.value = "Èasové razítko zprávy:"
				SignForm.MethodLabel.value = "Signer.TimeStamp(Zpráva)"
			End If
		End If
	Else
		If SignatureResultFile.Checked = True Then
			If ChkBoxCryptoFiles.Checked = True Then
				Signer.TimeStampFileToFileDetached CryptoFiles.value, DataFiles.value, SaveFolder.value
				If Err.number = 0 Then
					SignForm.CryptoMessage.value = "Do souborù podpisù byly vloeny poadované atributy a vısledné podpisy jsou uloeny v odpovídajících souborech."
					SignForm.EncodedLabel.value = "Vloení atributù do souborù podpisù:"
					MsgBox "Digitální podpisy s poadovanımi atributy jsou uloeny v odpovídajících souborech.", vbInformation, "Vytvoøení souborù digitálch podpisù s poadovanımi atributy metodou TimeStampFileToFile"
				End If
				SignForm.MethodLabel.value = "Signer.TimeStampFileToFileDetached(Soubory, Soubory, Soubory)"
			Else
				Signer.TimeStampToFileDetached SignForm.CryptoMessage.value, Message.value, SaveFolder.value
				If Err.number = 0 Then
					SignForm.CryptoMessage.value = "Do podpisù byly vloeny poadované atributy a vısledné podpisy jsou uloeny v odpovídajícím souboru."
					SignForm.EncodedLabel.value = "Vloení atributù do souboru podpisù:"
					MsgBox "Digitální podpisy s poadovanımi atributy jsou uloeny v odpovídajícím souboru.", vbInformation, "Vytvoøení souboru digitálch podpisù s poadovanımi atributy metodou TimeStampToFile"
				End If
				SignForm.MethodLabel.value = "Signer.TimeStampToFileDetached(Zpráva, Zpráva, Soubor)"
			End If
		Else
			If ChkBoxCryptoFiles.Checked = True Then
				SignForm.CryptoMessage.value = Signer.TimeStampFileDetached(CryptoFiles.value, DataFiles.value)
				SignForm.MethodLabel.value = "Signer.TimeStampFileDetached(Soubory, Soubory)"
				SignForm.EncodedLabel.value = "Digitální podpisy s poadovanımi atributy:"
			Else
				SignForm.CryptoMessage.value = Signer.TimeStampDetached(SignForm.CryptoMessage.value, Message.value)
				SignForm.MethodLabel.value = "Signer.TimeStampDetached(Zpráva, Zpráva)"
				SignForm.EncodedLabel.value = "Digitální podpisy s poadovanımi atributy:"
			End If
		End If
	End If
	If Err.number <> 0 Then
		SignForm.EncodedLabel.value = "Chybové hlášení:"
		SignForm.CryptoMessage.value = HandleError
	End If
End Sub

Sub GetHashAction_OnClick
	On Error Resume Next
	If ChkBoxDataFiles.checked = True Then
		If ChkBoxHashEncoded.checked = True Then
			SignForm.CryptoMessage.value = Signer.GetHashEncodedFile(DataFiles.value, HashAlg.value)
			SignForm.EncodedLabel.value = "Miniatura souborù kódovaná Base64:"
			SignForm.MethodLabel.value = "Signer.GetHashEncodedFile(Soubory, Algoritmus)"
		Else
			SignForm.CryptoMessage.value = Signer.GetHashFile(DataFiles.value, HashAlg.value)
			SignForm.EncodedLabel.value = "Miniatura souborù:"
			SignForm.MethodLabel.value = "Signer.GetHashFile(Soubory, Algoritmus)"
		End If
	Else
		If ChkBoxHashEncoded.checked = True Then
			SignForm.CryptoMessage.value = Signer.GetHashEncoded(Message.value, HashAlg.value)
			SignForm.EncodedLabel.value = "Miniatura zprávy kódovaná Base64:"
			SignForm.MethodLabel.value = "Signer.GetHashEncoded(Zpráva, Algoritmus)"
		Else
			SignForm.CryptoMessage.value = Signer.GetHash(Message.value, HashAlg.value)
			SignForm.EncodedLabel.value = "Miniatura zprávy:"
			SignForm.MethodLabel.value = "Signer.GetHash(Zpráva, Algoritmus)"
		End If
	End If
	If Err.number <> 0 Then
		SignForm.EncodedLabel.value = "Chybové hlášení:"
		SignForm.CryptoMessage.value = HandleError
	End If
End Sub


Sub SignAuthenticationString_OnClick
	On Error Resume Next
	SignForm.CryptoMessage.value = Signer.SignAuthenticationString(Message.value)
	SignForm.EncodedLabel.value = "Podepsanı autentizaèní øetìzec:"
	SignForm.MethodLabel.value = "Signer.SignAuthenticationString(Zpráva)"
	If Err.number <> 0 Then
		SignForm.EncodedLabel.value = "Chybové hlášení:"
		SignForm.CryptoMessage.value = HandleError
	End If
End Sub

Sub SetAuthenticationCert_OnClick
	On Error Resume Next
	Signer.SetAuthenticationCert()
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Info")
	End If
End Sub

Sub Decode_OnClick
	Dim Resp, MyErr
	If ChkBoxDataFiles.Checked = True Then
		If ChkBoxCryptoFiles.Checked = True Then
			MyErr = Signer.DecodeFileFromFile(CryptoFiles.value, DataFiles.value)
			SignForm.MethodLabel.value = "Signer.DecodeFileFromFile(Krypto soubor, Datovı soubor)"
			If MyErr = 0 Then
				Resp = MsgBox("Dekódování Base64 z krypto souboru probìhlo v poøádku. Datové soubory jsou uloeny v " + DataFiles.value + ".", vbInformation, "Dekódování krypto souboru")
				SignForm.CryptoMessage.value = Signer.LastMessage
				SignForm.EncodedLabel.value = "Dekódovanı krypto soubor:"
			Else
				Resp = MsgBox("Soubor nebylo moné dekódovat.", vbCritical, "Dekódování krypto souboru")
			End If
		Else
			MyErr = Signer.DecodeFile(SignForm.CryptoMessage.value, DataFiles.value)
			SignForm.MethodLabel.value = "Signer.DecodeFile(Krypto zpráva, Datovı soubor)"
			If MyErr = 0 Then
				Resp = MsgBox("Dekódování Base64 z krypto zprávy probìhlo v poøádku. Datové soubory jsou uloeny v " + DataFiles.value + ".", vbInformation, "Dekódování krypto zprávy")
				SignForm.CryptoMessage.value = Signer.LastMessage
				SignForm.EncodedLabel.value = "Dekódovaná krypto zpráva:"
			Else
				Resp = MsgBox("Krypto zprávu nebylo moné dekódovat.", vbCritical, "Dekódování krypto zprávy")
			End If
		End If
	Else
		If ChkBoxCryptoFiles.Checked = True Then
			MyErr = Signer.DecodeFromFile(CryptoFiles.value)
			SignForm.MethodLabel.value = "Signer.DecodeFromFile(Krypto soubor)"
			If MyErr = 0 Then
				Resp = MsgBox("Dekódování Base64 z krypto souboru probìhlo v poøádku.", vbInformation, "Dekódování krypto souboru")
				SignForm.CryptoMessage.value = Signer.LastMessage
				SignForm.EncodedLabel.value = "Dekódovanı krypto soubor:"
			Else
				Resp = MsgBox("Krypto soubor nebylo moné dekódovat.", vbCritical, "Dekódování krypto souboru")
			End If
		Else
			MyErr = Signer.Decode(SignForm.CryptoMessage.value)
			SignForm.MethodLabel.value = "Signer.Decode(Krypto zpráva)"
			If MyErr = 0 Then
				Resp = MsgBox("Dekódování Base64 z krypto zprávy probìhlo v poøádku.", vbInformation, "Dekódování krypto zprávy")
				SignForm.CryptoMessage.value = Signer.LastMessage
				SignForm.EncodedLabel.value = "Dekódovaná krypto zpráva:"
			Else
				Resp = MsgBox("Krypto zprávu nebylo moné dekódovat.", vbCritical, "Dekódování krypto zprávy")
			End If
		End If
	End If
	Resp = MsgBox(HandleError, vbInformation, "Info")
End Sub

Sub Decrypt_OnClick
	Dim Resp, MyErr
	If ChkBoxDataFiles.Checked = True Then
		If ChkBoxCryptoFiles.Checked = True Then
			MyErr = Signer.DecryptFileFromFile(CryptoFiles.value, DataFiles.value)
			SignForm.MethodLabel.value = "Signer.DecodeFileFromFile(Soubor, Umístìní)"
			If MyErr = 0 Then
				Resp = MsgBox("Dešifrování z krypto souboru probìhlo v poøádku. Soubory jsou uloeny v " + DataFiles.value + ".", vbInformation, "Dešifrování souboru")
				SignForm.CryptoMessage.value = Signer.LastMessage
				SignForm.EncodedLabel.value = "Dešifrovanı soubor:"
			Else
				Resp = MsgBox("Soubor nebylo moné dešifrovat.", vbCritical, "Dešifrování souboru")
			End If
		Else
			MyErr = Signer.DecryptFile(SignForm.CryptoMessage.value, DataFiles.value)
			SignForm.MethodLabel.value = "Signer.DecryptFile(Soubory, Umístìní)"
			If MyErr = 0 Then
				Resp = MsgBox("Dešifrování probìhlo v poøádku. Soubory jsou uloeny v " + DataFiles.value + ".", vbInformation, "Dešifrování souborù")
				SignForm.CryptoMessage.value = ""
				SignForm.EncodedLabel.value = "Dešifrovaní souborù"
			Else
				Resp = MsgBox("Soubory nebylo moné dešifrovat.", vbCritical, "Dešifrování souborù")
			End If
		End If
	Else
		If ChkBoxCryptoFiles.Checked = True Then
			MyErr = Signer.DecryptFromFile(CryptoFiles.value)
			SignForm.MethodLabel.value = "Signer.DecryptFromFile(Soubor)"
			If MyErr = 0 Then
				Resp = MsgBox("Dešifrování z krypto souboru probìhlo v poøádku.", vbInformation, "Dešifrování souboru")
				SignForm.CryptoMessage.value = Signer.LastMessage
				SignForm.EncodedLabel.value = "Dešifrovanı soubor:"
			Else
				Resp = MsgBox("Soubor nebylo moné dešifrovat.", vbCritical, "Dešifrování souboru")
			End If
		Else
			MyErr = Signer.Decrypt(SignForm.CryptoMessage.value)
			SignForm.MethodLabel.value = "Signer.Decrypt(Zpráva)"
			If MyErr = 0 Then
				Resp = MsgBox("Dešifrování probìhlo v poøádku.", vbInformation, "Dešifrování zprávy")
				SignForm.CryptoMessage.value = Signer.LastMessage
				SignForm.EncodedLabel.value = "Dešifrovaná zpráva:"
			Else
				Resp = MsgBox("Zprávu nebylo moné dešifrovat", vbCritical, "Dešifrování zprávy")
			End If
		End If
	End If
	Resp = MsgBox(HandleError, vbInformation, "Info")
End Sub

Sub Verify_OnClick
	Dim Resp, MyErr
	If ChkBoxDataFiles.Checked = True Then
		If ChkBoxCryptoFiles.Checked = True Then
			MyErr = Signer.VerifyFileFromFile(CryptoFiles.value, DataFiles.value)
			SignForm.MethodLabel.value = "Signer.VerifyFileFromFile(Soubor, Umístìní)"
			If MyErr = 0 Then
				Resp = MsgBox("Ovìøení podpisu z krypto souboru probìhlo v poøádku. Soubory jsou uloeny v " + DataFiles.value + ".", vbInformation, "Ovìøení podpisu ze souboru")
				SignForm.CryptoMessage.value = Signer.LastMessage
				SignForm.EncodedLabel.value = "Ovìøená zpráva ze souboru:"
			Else
				Resp = MsgBox("Neplatnı podpis.", vbCritical, "Ovìøení podpisu ze souboru")
			End If
		Else
			MyErr = Signer.VerifyFile(SignForm.CryptoMessage.value, DataFiles.value)
			SignForm.MethodLabel.value = "Signer.VerifyFile(Soubory, Umístìní)"
			If MyErr = 0 Then
				Resp = MsgBox("Platnı podpis. Soubory jsou uloeny v " + DataFiles.value + ".", vbInformation, "Ovìøení podpisu souborù")
				SignForm.CryptoMessage.value = ""
				SignForm.EncodedLabel.value = "Ovìøení podpisu souborù."
			Else
				Resp = MsgBox("Neplatnı podpis.", vbCritical, "Ovìøení podpisu souborù")
			End If
		End If
	Else
		If ChkBoxCryptoFiles.Checked = True Then
			MyErr = Signer.VerifyFromFile(CryptoFiles.value)
			SignForm.MethodLabel.value = "Signer.VerifyFromFile(Soubor)"
			If MyErr = 0 Then
				Resp = MsgBox("Ovìøení podpisu z krypto souboru probìhlo v poøádku.", vbInformation, "Ovìøení podpisu ze souboru")
				SignForm.CryptoMessage.value = Signer.LastMessage
				SignForm.EncodedLabel.value = "Ovìøená zpráva ze souboru:"
			Else
				Resp = MsgBox("Neplatnı podpis.", vbCritical, "Ovìøení podpisu ze souboru")
			End If
		Else
			MyErr = Signer.Verify(SignForm.CryptoMessage.value)
			SignForm.MethodLabel.value = "Signer.Verify(Podepsaná zpráva)"
			If MyErr = 0 Then
				Resp = MsgBox("Platnı podpis.", vbInformation, "Ovìøení podpisu zprávy")
				SignForm.CryptoMessage.value = Signer.LastMessage
				SignForm.EncodedLabel.value = "Ovìøená zpráva:"
			Else
				Resp = MsgBox("Neplatnı podpis.", vbCritical, "Ovìøení podpisu zprávy")
			End If
		End If
	End If
	Resp = MsgBox(HandleError, vbInformation, "Info")
End Sub

Sub VerifyDetached_OnClick
	Dim Resp, MyErr
	If ChkBoxDataFiles.Checked = True Then
		If ChkBoxCryptoFiles.Checked = True Then
			MyErr = Signer.VerifyFileFromFileDetached(CryptoFiles.value, DataFiles.value)
			SignForm.MethodLabel.value = "Signer.VerifyFileFromFileDetached(Soubor, Soubory)"
			If MyErr = 0 Then
				Resp = MsgBox("Platnı podpis.", vbInformation, "Ovìøení externího podpisu ze souboru")
			Else
				Resp = MsgBox("Neplatnı podpis.", vbCritical, "Ovìøení externího podpisu ze souboru")
			End If
		Else
			MyErr = Signer.VerifyFileDetached(SignForm.CryptoMessage.value, DataFiles.value)
			SignForm.MethodLabel.value = "Signer.VerifyFileDetached(Externí podpis souborù, Soubory)"
			If MyErr = 0 Then
				Resp = MsgBox("Platnı podpis.", vbInformation, "Ovìøení externího podpisu souborù")
			Else
				Resp = MsgBox("Neplatnı podpis.", vbCritical, "Ovìøení externího podpisu souborù")
			End If
		End If
	Else
		If ChkBoxCryptoFiles.Checked = True Then
			MyErr = Signer.VerifyFromFileDetached(CryptoFiles.value, Message.value)
			SignForm.MethodLabel.value = "Signer.VerifyFromFileDetached(Soubor, Zpráva)"
			If MyErr = 0 Then
				Resp = MsgBox("Ovìøení externího podpisu z krypto souboru probìhlo v poøádku.", vbInformation, "Ovìøení externího podpisu ze souboru")
				SignForm.CryptoMessage.value = Signer.LastMessage
				SignForm.EncodedLabel.value = "Ovìøená zpráva ze souboru:"
			Else
				Resp = MsgBox("Neplatnı podpis", vbCritical, "Ovìøení externího podpisu ze souboru")
			End If
		Else
			MyErr = Signer.VerifyDetached(SignForm.CryptoMessage.value, Message.value)
			SignForm.MethodLabel.value = "Signer.VerifyDetached(Externí podpis, Zpráva)"
			If MyErr = 0 Then
				Resp = MsgBox("Platnı podpis.", vbInformation, "Ovìøení externího podpisu zprávy")
				SignForm.CryptoMessage.value = Signer.LastMessage
				SignForm.EncodedLabel.value = "Ovìøená zpráva:"
			Else
				Resp = MsgBox("Neplatnı podpis.", vbCritical, "Ovìøení externího podpisu zprávy")
			End If
		End If
	End If
	Resp = MsgBox(HandleError, vbInformation, "Info")
End Sub

Sub DecryptAndVerify_OnClick
	Dim Resp, MyErr, Info
	If ChkBoxDataFiles.Checked = True Then
		If ChkBoxCryptoFiles.Checked = True Then
			MyErr = Signer.DecryptAndVerifyFileFromFile(CryptoFiles.value, DataFiles.value)
			SignForm.MethodLabel.value = "Signer.DecryptAndVerifyFileFromFile(Soubor, Umístìní)"
			If MyErr = 0 Then
				Resp = MsgBox("Dešifrování a ovìøení podpisu z krypto souboru probìhlo v poøádku. Soubory jsou uloeny v " + DataFiles.value + ".", vbInformation, "Dešifrování a ovìøení podpisu ze souboru")
				SignForm.CryptoMessage.value = Signer.LastMessage
				SignForm.EncodedLabel.value = "Dešifrovaní a ovìøení podpisu ze souboru:"
			Else
				Resp = MsgBox("Nebylo moné dešifrovat a ovìøit podpis ze souboru.", vbCritical, "Dešifrování a ovìøení podpisu ze souboru")
			End If
		Else
			MyErr = Signer.DecryptAndVerifyFile(SignForm.CryptoMessage.value, DataFiles.value)
			SignForm.MethodLabel.value = "Signer.DecryptAndVerifyFile(Podepsaná a šifrovaná zpráva, Umístìní)"
			If MyErr = 0 Then
				Resp = MsgBox("Dešifrování a ovìøení podpisu probìhlo v poøádku. Soubory jsou uloeny v " + DataFiles.value, vbInformation, "Dešifrování a ovìøení podpisu")
				SignForm.CryptoMessage.value = ""
				SignForm.EncodedLabel.value = "Dešifrovaní a ovìøení podpisu souborù"
			Else
				Resp = MsgBox("Nebylo moné dešifrovat a ovìøit podpis zprávy.", vbCritical, "Dešifrování a ovìøení podpisu")
			End If
		End If
	Else
		If ChkBoxCryptoFiles.Checked = True Then
			MyErr = Signer.DecryptAndVerifyFromFile(CryptoFiles.value)
			SignForm.MethodLabel.value = "Signer.DecryptAndVerifyFromFile(Soubor)"
			If MyErr = 0 Then
				Resp = MsgBox("Dešifrování a ovìøení podpisu z krypto souboru probìhlo v poøádku.", vbInformation, "Dešifrování a ovìøení podpisu ze souboru")
				SignForm.CryptoMessage.value = Signer.LastMessage
				SignForm.EncodedLabel.value = "Dešifrovaná a ovìøená zpráva ze souboru:"
			Else
				Resp = MsgBox("Nebylo moné dešifrovat a ovìøit podpis ze souboru.", vbCritical, "Ovìøení podpisu ze souboru")
			End If
		Else
			MyErr = Signer.DecryptAndVerify(SignForm.CryptoMessage.value)
			SignForm.MethodLabel.value = "Signer.DecryptAndVerify(Podepsaná a šifrovaná zpráva)"
			If MyErr = 0 Then
				Resp = MsgBox("Dešifrování a ovìøení podpisu probìhlo v poøádku.", vbInformation, "Dešifrování a ovìøení podpisu")
				SignForm.CryptoMessage.value = Signer.LastMessage
				SignForm.EncodedLabel.value = "Dešifrovaná a ovìøená zpráva:"
			Else
				Resp = MsgBox("Zprávu nebylo moné dešifrovat a ovìøit podpis.", vbCritical, "Dešifrování a ovìøení podpisu")
			End If
		End If
	End If
	Resp = MsgBox(HandleError, vbInformation, "Info")
End Sub

Sub VerifyTimeStamp_OnClick
	Dim Resp, MyErr
	If ChkBoxDataFiles.Checked = True Then
		If ChkBoxCryptoFiles.Checked = True Then
			MyErr = Signer.VerifyTimeStampFileFromFile(CryptoFiles.value, DataFiles.value)
			SignForm.MethodLabel.value = "Signer.VerifyTimeStampFileFromFile(Soubor, Soubory)"
			If MyErr = 0 Then
				Resp = MsgBox("Platné èasové razítko.", vbInformation, "Ovìøení èasového razítka ze souboru")
				SignForm.CryptoMessage.value = TimeStampStr
			Else
				Resp = MsgBox("Neplatné èasové razítko.", vbCritical, "Ovìøení èasového razítka ze souboru")
			End If
		Else
			MyErr = Signer.VerifyTimeStampFile(SignForm.CryptoMessage.value, DataFiles.value)
			SignForm.MethodLabel.value = "Signer.VerifyTimeStampFile(Èasové razítko souborù, Soubory)"
			If MyErr = 0 Then
				Resp = MsgBox("Platné èasové razítko.", vbInformation, "Ovìøení èasového razítka souborù")
				SignForm.CryptoMessage.value = TimeStampStr
			Else
				Resp = MsgBox("Neplatné èasové razítko.", vbCritical, "Ovìøení èasového razítka souborù")
			End If
		End If
	Else
		If ChkBoxCryptoFiles.Checked = True Then
			MyErr = Signer.VerifyTimeStampFromFile(CryptoFiles.value, Message.value)
			SignForm.MethodLabel.value = "Signer.VerifyTimeStampFromFile(Soubor, Zpráva)"
			If MyErr = 0 Then
				Resp = MsgBox("Ovìøení èasového razítka z krypto souboru probìhlo v poøádku.", vbInformation, "Ovìøení èasového razítka ze souboru")
				SignForm.CryptoMessage.value = TimeStampStr
				SignForm.EncodedLabel.value = "Poloky ovìøeného èasového razítka ze souboru:"
			Else
				Resp = MsgBox("Neplatné èasové razítko.", vbCritical, "Ovìøení èasového razítka ze souboru")
			End If
		Else
			MyErr = Signer.VerifyTimeStamp(SignForm.CryptoMessage.value, Message.value)
			SignForm.MethodLabel.value = "Signer.VerifyTimeStamp(Razítko, Zpráva)"
			If MyErr = 0 Then
				Resp = MsgBox("Platné èasové razítko.", vbInformation, "Ovìøení èasového razítka")
				SignForm.CryptoMessage.value = TimeStampStr
				SignForm.EncodedLabel.value = "Poloky ovìøeného èasového razítka:"
			Else
				Resp = MsgBox("Neplatné èasové razítko", vbCritical, "Ovìøení èasového razítka")
			End If
		End If
	End If
	Resp = MsgBox(HandleError, vbInformation, "Info")
End Sub

Sub HexToDec_OnClick
	Dim Resp, sLastCertSNDec
	sLastCertSNDec = Signer.HexToDec(LastCertSN.value)
	If Err = 0 Then
		LastCertSNDec.value = sLastCertSNDec
	Else
		LastCertSNDec.value = ""
		Resp = MsgBox(HandleError, vbCritical, "Pøevod hexadecimálního èísla na dekadické")
	End If
End Sub

Sub VerifyCertificateChain_OnClick
	Dim Resp, MyErr
	MyErr = Signer.VerifyCertificateChain(nCertType.value)
	If MyErr = 0 Then
		Resp = MsgBox("Øetìzec certifikátù je platnı.", vbInformation, "Ovìøení øetìzce certifikátù")
	Else
		Resp = MsgBox("Øetìzec certifikátù je neplatnı.", vbCritical, "Ovìøení øetìzce certifikátù")
	End If
	Resp = MsgBox(HandleError, vbInformation, "Info")
End Sub

Sub VerifyCertificateChainTimeStampSignature_OnClick
	Dim Resp, MyErr
	MyErr = Signer.VerifyCertificateChain(8)
	If MyErr = 0 Then
		Resp = MsgBox("Øetìzec certifikátù je platnı.", vbInformation, "Ovìøení øetìzce certifikátù")
	Else
		Resp = MsgBox("Øetìzec certifikátù je neplatnı.", vbCritical, "Ovìøení øetìzce certifikátù")
	End If
	Resp = MsgBox(HandleError, vbInformation, "Info")
End Sub

Sub VerifyCertificateChainSenderSignature_OnClick
	Dim Resp, MyErr
	MyErr = Signer.VerifyCertificateChain(1)
	If MyErr = 0 Then
		Resp = MsgBox("Øetìzec certifikátù je platnı.", vbInformation, "Ovìøení øetìzce certifikátù")
	Else
		Resp = MsgBox("Øetìzec certifikátù je neplatnı.", vbCritical, "Ovìøení øetìzce certifikátù")
	End If
	Resp = MsgBox(HandleError, vbInformation, "Info")
End Sub

Sub VerifyCertificateChainSenderKeyExchange_OnClick
	Dim Resp, MyErr
	MyErr = Signer.VerifyCertificateChain(2)
	If MyErr = 0 Then
		Resp = MsgBox("Øetìzec certifikátù je platnı.", vbInformation, "Ovìøení øetìzce certifikátù")
	Else
		Resp = MsgBox("Øetìzec certifikátù je neplatnı.", vbCritical, "Ovìøení øetìzce certifikátù")
	End If
	Resp = MsgBox(HandleError, vbInformation, "Info")
End Sub

Sub VerifyCertificateChainReceiverKeyExchange_OnClick
	Dim Resp, MyErr
	MyErr = Signer.VerifyCertificateChain(4)
	If MyErr = 0 Then
		Resp = MsgBox("Øetìzec certifikátù je platnı.", vbInformation, "Ovìøení øetìzce certifikátù")
	Else
		Resp = MsgBox("Øetìzec certifikátù je neplatnı.", vbCritical, "Ovìøení øetìzce certifikátù")
	End If
	Resp = MsgBox(HandleError, vbInformation, "Info")
End Sub

Sub GetMessageType_OnClick
	On Error Resume Next
	Dim Resp, MessageType
	MessageType = Signer.GetMessageType(SignForm.CryptoMessage.value)
	If Err = 0 Then
		Resp = MsgBox("Typ zprávy je: " + CStr(MessageType), vbInformation, "Získání typu zprávy")
	Else
		Resp = MsgBox("Nepodaøilo se zjistit typ zprávy.", vbCritical, "Získání typu zprávy")
	End If
	Resp = MsgBox(HandleError, vbInformation, "Info")
End Sub

Sub GetMessageOID_OnClick
	On Error Resume Next
	Dim Resp, OIDStr
	OIDStr = Signer.GetMessageOID(SignForm.CryptoMessage.value)
	If Err = 0 Then
		Resp = MsgBox("OID zprávy je: " + OIDStr, vbInformation, "Získání zprávy")
	Else
		Resp = MsgBox("Nepodaøilo se zjistit OID zprávy.", vbCritical, "Získání OID zprávy")
	End If
	Resp = MsgBox(HandleError, vbInformation, "Info")
End Sub

Sub GetSignedMessageAction_OnClick
	Select Case GetSignedMessageOption.value
		Case "1"	GetSignedMessage_OnClick
		Case "2"	GetSignedMessageFile_OnClick
		Case "3"	GetSignedMessageCertCount_OnClick
		Case "4"	GetSignedMessageSenderSignatureCount_OnClick
		Case "5"	GetSignedMessageSenderSignature_OnClick
		Case "6"	GetSignedMessageSenderSignatureHashAlgorithm_OnClick
		Case "7"	GetSignedMessageSenderSignatureHashEncryptionAlgorithm_OnClick
		Case "8"	GetSignedMessageSenderSignatureCert_OnClick
		Case "9"	GetSignedMessageSenderKeyExchangeCert_OnClick
		Case "10"	GetSignedMessageSenderSignatureCertSN_OnClick
		Case "11"	GetSignedMessageSenderSignatureCertIssuerCN_OnClick
		Case "12"	GetSignedMessageSenderSignatureCertIssuerStrSimple_OnClick
		Case "13"	GetSignedMessageSenderSignatureCertIssuerStrOID_OnClick
		Case "14"	GetSignedMessageSenderSignatureCertIssuerStrX500_OnClick
	 End Select
End Sub

Sub GetSignedMessage_OnClick
	Dim Resp, MyErr
	MyErr = Signer.GetSignedMessage(SignForm.CryptoMessage.value)
	SignForm.MethodLabel.value = "Signer.GetSignedMessage(Zpráva)"
	If MyErr = 0 Then
		Resp = MsgBox("Získání zprávy z pøedané podepsané zprávy probìhlo v poøádku.", vbInformation, "Získání zprávy")
		SignForm.CryptoMessage.value = Signer.LastMessage
		SignForm.EncodedLabel.value = "Zpráva:"
	Else
		Resp = MsgBox("Zprávu nebylo moné získat.", vbCritical, "Získání zprávy")
	End If
	Resp = MsgBox(HandleError, vbInformation, "Info")
End Sub


Sub GetSignedMessageFile_OnClick
	Dim Resp, MyErr
	MyErr = Signer.GetSignedMessageFile(SignForm.CryptoMessage.value, SaveFolder.value)
	SignForm.MethodLabel.value = "Signer.GetSignedMessageFile(Zpráva, Umístìní)"
	If MyErr = 0 Then
		Resp = MsgBox("Získání podepsanıch souborù probìhlo v poøádku. Soubory jsou uloeny v " + SaveFolder.value, vbInformation, "Získání podepsanıch souborù")
		SignForm.CryptoMessage.value = ""
		SignForm.EncodedLabel.value = "Získání podepsanıch souborù:"
	Else
		Resp = MsgBox("Podepsané soubory nebylo moné získat.", vbCritical, "Získání podepsanıch souborù")
	End If
	Resp = MsgBox(HandleError, vbInformation, "Info")
End Sub

Sub GetSignedMessageCertCount_OnClick
	On Error Resume Next
	Dim Resp, CertCount
	CertCount = Signer.GetSignedMessageCertCount(SignForm.CryptoMessage.value)
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Signer")
	Else
		Resp = MsgBox("Poèet certifikátù obsaenıch v kryptografické zprávì: " + CStr(CertCount) + ".", vbInformation, "Poèet certifikátù zprávy")
	End If
End Sub

Sub GetSignedMessageSenderSignatureCount_OnClick
	On Error Resume Next
	Dim Resp, CertCount
	CertCount = Signer.GetSignedMessageSenderSignatureCount(SignForm.CryptoMessage.value)
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Signer")
	Else
		Resp = MsgBox("Poèet podepisovatelù kryptografické zprávy: " + CStr(CertCount) + ".", vbInformation, "Poèet podepisovatelù")
	End If
End Sub

Sub GetSignedMessageSenderSignature_OnClick
	On Error Resume Next
	Dim Resp, HashAlgorithm
	Signature = Signer.GetSignedMessageSenderSignature(SignForm.CryptoMessage.value, SignatureIndex.value)
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Signer")
	Else
		Resp = MsgBox(Signature, vbInformation, "Podpis")
		SignForm.CryptoMessage.value = Signature
	End If
End Sub

Sub GetSignedMessageSenderSignatureHashAlgorithm_OnClick
	On Error Resume Next
	Dim Resp, HashAlgorithm
	HashAlgorithm = Signer.GetSignedMessageSenderSignatureHashAlgorithm(SignForm.CryptoMessage.value, SignatureIndex.value)
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Signer")
	Else
		Resp = MsgBox(HashAlgorithm, vbInformation, "Hashovací algoritmus podpisu")
	End If
End Sub

Sub GetSignedMessageSenderSignatureHashEncryptionAlgorithm_OnClick
	On Error Resume Next
	Dim Resp, HashEncryptionAlgorithm
	HashEncryptionAlgorithm = Signer.GetSignedMessageSenderSignatureHashEncryptionAlgorithm(SignForm.CryptoMessage.value, SignatureIndex.value)
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Signer")
	Else
		Resp = MsgBox(HashEncryptionAlgorithm, vbInformation, "Šifrovací algoritmus podpisu")
	End If
End Sub

Sub GetSignedMessageSenderSignatureCert_OnClick
	On Error Resume Next
	Dim Resp
	Signer.GetSignedMessageSenderSignatureCert SignForm.CryptoMessage.value, SignatureIndex.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Signer")
	Else
		Resp = MsgBox("Podepisovací certifikát odesílatelekryptografické zprávy byl uloen do vlastnosti LastCertSenderSignature.", vbInformation, "Podepisovací certifikát odesílatele")
	End If
End Sub

Sub GetSignedMessageSenderKeyExchangeCert_OnClick
	On Error Resume Next
	Dim Resp
	Signer.GetSignedMessageSenderKeyExchangeCert(SignForm.CryptoMessage.value)
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Signer")
	Else
		Resp = MsgBox("Šifrovací certifikát odesílatele kryptografické zprávy byl uloen do vlastnosti LastCertSenderKeyExchange.", vbInformation, "Šifrovací certifikát odesílatele")
	End If
End Sub

Sub GetSignedMessageSenderSignatureCertSN_OnClick
	On Error Resume Next
	Dim Resp, sSubjectSN
	sSubjectSN = Signer.GetSignedMessageSenderSignatureCertSN(SignForm.CryptoMessage.value, SignatureIndex.value)
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Signer")
	Else
		sSubjectSN = sSubjectSN + " (" + Signer.HexToDec(sSubjectSN) + ")"
		Resp = MsgBox(sSubjectSN, vbInformation, "Sériové èíslo podepisovacího certifikátu odesílatele")
	End If
End Sub

Sub GetSignedMessageSenderSignatureCertIssuerCN_OnClick
	On Error Resume Next
	Dim Resp, IssuerCN
	IssuerCN = Signer.GetSignedMessageSenderSignatureCertIssuerCN(SignForm.CryptoMessage.value, SignatureIndex.value)
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Signer")
	Else
		Resp = MsgBox(IssuerCN, vbInformation, "CN vystavitele podepisovacího certifikátu odesílatele")
	End If
End Sub

Sub GetSignedMessageSenderSignatureCertIssuerStrSimple_OnClick
	On Error Resume Next
	Dim Resp, Issuer
	Issuer = Signer.GetSignedMessageSenderSignatureCertIssuerStrSimple(SignForm.CryptoMessage.value, SignatureIndex.value)
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Signer")
	Else
		Resp = MsgBox(Issuer, vbInformation, "Jednoduchı øetìzec vystavitele podepisovacího certifikátu odesílatele")
	End If
End Sub

Sub GetSignedMessageSenderSignatureCertIssuerStrOID_OnClick
	On Error Resume Next
	Dim Resp, Issuer
	Issuer = Signer.GetSignedMessageSenderSignatureCertIssuerStrOID(SignForm.CryptoMessage.value, SignatureIndex.value)
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Signer")
	Else
		Resp = MsgBox(Issuer, vbInformation, "OID øetìzec vystavitele podepisovacího certifikátu odesílatele")
	End If
End Sub

Sub GetSignedMessageSenderSignatureCertIssuerStrX500_OnClick
	On Error Resume Next
	Dim Resp, Issuer
	Issuer = Signer.GetSignedMessageSenderSignatureCertIssuerStrX500(SignForm.CryptoMessage.value, SignatureIndex.value)
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Signer")
	Else
		Resp = MsgBox(Issuer, vbInformation, "X500 øetìzec vystavitele podepisovacího certifikátu odesílatele")
	End If
End Sub

Sub SignatureDataAttach_OnClick
	On Error Resume Next
	If SignatureFile.checked = False Then
		If SignatureDataFile.checked = False Then
			If SignatureResultFile.checked = False Then
				'000
				SignForm.CryptoMessage.value = Signer.SignedMessageDataAttach(SignForm.CryptoMessage.value, Message.value)
				SignForm.MethodLabel.value = "Signer.SignedMessageDataAttach(Externí podpis, Datová zpráva)"
			Else
				'001
				Signer.SignedMessageDataAttachToFile SignForm.CryptoMessage.value, Message.value, SaveFolder.value
				SignForm.CryptoMessage.value = "Podepsaná zpráva s daty je uloena v krypto souboru: " + SaveFolder.value
				SignForm.MethodLabel.value = "Signer.SignedMessageDataAttachToFile(Externí podpis, Datová zpráva, Soubor s podpisem)"
			End If
		Else
			If SignatureResultFile.checked = False Then
				'010
				SignForm.CryptoMessage.value = Signer.SignedMessageDataFileAttach(SignForm.CryptoMessage.value, DataFiles.value)
				SignForm.MethodLabel.value = "Signer.SignedMessageDataAttachToFile(Externí podpis, Soubor s daty)"
			Else
				'011
				Signer.SignedMessageDataFileAttachToFile SignForm.CryptoMessage.value, DataFiles.value, SaveFolder.value
				SignForm.CryptoMessage.value = "Podepsaná zpráva s daty je uloena v krypto souboru: " + SaveFolder.value
				SignForm.MethodLabel.value = "Signer.SignedMessageDataFileAttachToFile(Externí podpis, Soubor s daty, Soubor s podpisem)"
			End If
		End If
	Else
		If SignatureDataFile.checked = False Then
			If SignatureResultFile.checked = False Then
				'100
				SignForm.CryptoMessage.value = Signer.SignedFileDataAttach(CryptoFiles.value, Message.value)
				SignForm.MethodLabel.value = "Signer.SignedFileDataAttach(Soubor s externím podpisem, Datová zpráva)"
			Else
				'101
				Signer.SignedFileDataAttachToFile CryptoFiles.value, Message.value, SaveFolder.value
				SignForm.CryptoMessage.value = "Podepsaná zpráva s daty je uloena v krypto souboru: " + SaveFolder.value
				SignForm.MethodLabel.value = "Signer.SignedFileDataAttachToFile(Soubor s externím podpisem, Datová zpráva, Soubor s podpisem)"
			End If
		Else
			If SignatureResultFile.checked = False Then
				'110
				SignForm.CryptoMessage.value = Signer.SignedFileDataFileAttach(CryptoFiles.value, DataFiles.value)
				SignForm.MethodLabel.value = "Signer.SignedFileDataFileAttach(Soubor s externím podpisem, Soubor s daty)"
			Else
				'111
				Signer.SignedFileDataFileAttachToFile CryptoFiles.value, DataFiles.value, SaveFolder.value
				SignForm.CryptoMessage.value = "Podepsaná zpráva s daty je uloena v krypto souboru: " + SaveFolder.value
				SignForm.MethodLabel.value = "Signer.SignedFileDataFileAttachToFile(Soubor s externím podpisem, Soubor s daty, Soubor s podpisem)"
			End If
		End If
	End If
	SignForm.EncodedLabel.value = "Podepsaná zpráva s daty:"
	
	If Err.number <> 0 Then
		SignForm.EncodedLabel.value = "Chybové hlášení:"
		SignForm.CryptoMessage.value = HandleError
	End If
End Sub

Sub SignatureDataDetach_OnClick
	On Error Resume Next
	If SignatureFile.checked = False Then
		If SignatureDataFile.checked = False Then
			If SignatureResultFile.checked = False Then
				'000
				SignForm.CryptoMessage.value = Signer.SignedMessageDataDetach(SignForm.CryptoMessage.value)
				SignForm.MethodLabel.value = "Signer.SignedMessageDataDetach(Podpis)"
			Else
				'001
				Signer.SignedMessageDataDetachToFile SignForm.CryptoMessage.value, SaveFolder.value
				SignForm.CryptoMessage.value = "Podepsaná zpráva bez dat je uloena v krypto souboru: " + SaveFolder.value
				SignForm.MethodLabel.value = "Signer.SignedMessageDataDetachToFile(Podpis, Soubor s externím podpisem)"
			End If
		Else
			If SignatureResultFile.checked = False Then
				'010
				SignForm.CryptoMessage.value = Signer.SignedMessageDataFileDetach(SignForm.CryptoMessage.value, DataFiles.value)
				SignForm.MethodLabel.value = "Signer.SignedMessageDataFileDetach(Podpis, Soubor s daty)"
			Else
				'011
				Signer.SignedMessageDataFileDetachToFile SignForm.CryptoMessage.value, DataFiles.value, SaveFolder.value
				SignForm.CryptoMessage.value = "Podepsaná zpráva bez dat je uloena v krypto souboru: " + SaveFolder.value
				SignForm.MethodLabel.value = "Signer.SignedMessageDataFileDetachToFile(Podpis, Soubor s daty, Soubor s externím podpisem)"
			End If
		End If
	Else
		If SignatureDataFile.checked = False Then
			If SignatureResultFile.checked = False Then
				'100
				SignForm.CryptoMessage.value = Signer.SignedFileDataDetach(CryptoFiles.value)
				SignForm.MethodLabel.value = "Signer.SignedFileDataDetach(Soubor s podpisem)"
			Else
				'101
				Signer.SignedFileDataDetachToFile CryptoFiles.value, SaveFolder.value
				SignForm.CryptoMessage.value = "Podepsaná zpráva bez dat je uloena v krypto souboru: " + SaveFolder.value
				SignForm.MethodLabel.value = "Signer.SignedFileDataDetachToFile(Soubor s podpisem, Soubor s externím podpisem)"
			End If
		Else
			If SignatureResultFile.checked = False Then
				'110
				SignForm.CryptoMessage.value = Signer.SignedFileDataFileDetach(CryptoFiles.value, DataFiles.value)
				SignForm.MethodLabel.value = "Signer.SignedFileDataDetach(Soubor podpisem, Soubor s daty)"
			Else
				'111
				Signer.SignedFileDataFileDetachToFile CryptoFiles.value, DataFiles.value, SaveFolder.value
				SignForm.CryptoMessage.value = "Podepsaná zpráva bez dat je uloena v krypto souboru " + SaveFolder.value
				SignForm.MethodLabel.value = "Signer.SignedFileDataDetachToFile(Soubor s podpisem, Soubor s daty, Soubor s externím podpisem)"
			End If
		End If
	End If
	SignForm.EncodedLabel.value = "Podepsaná zpráva bez dat:"
	
	If Err.number <> 0 Then
		SignForm.EncodedLabel.value = "Chybové hlášení:"
		SignForm.CryptoMessage.value = HandleError
	End If
End Sub

Sub LastSignatureAction_OnClick
	Select Case LastSignatureOption.value
		Case "1"	GetLastSignatureHashAlgorithmOID_OnClick
		Case "2"	GetLastSignatureHashAlgorithmNumber_OnClick
		Case "3"	GetLastSignatureHashAlgorithmStr_OnClick
	End Select
End Sub

Sub GetLastSignatureHashAlgorithmOID_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastSignatureHashAlgorithmOID
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastSignatureHashAlgorithmNumber_OnClick
	On Error Resume Next
	LastCertBox.value = CStr(Signer.LastSignatureHashAlgorithmNumber)
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastSignatureHashAlgorithmStr_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastSignatureHashAlgorithmStr
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub LastAuthAttrAction_OnClick
	Select Case LastAuthAttrOption.value
		Case "1"	GetLastAuthAttrSigningTime_OnClick
		Case "2"	GetLastAuthAttrSigningCertificateHash_OnClick
		Case "3"	GetLastAuthAttrSigningCertificateV2Hash_OnClick
		Case "4"	GetLastAuthAttrSigningCertificateV2HashAlgorithmOID_OnClick
		Case "5"	GetLastAuthAttrSigningCertificateV2HashAlgorithmNumber_OnClick
		Case "6"	GetLastAuthAttrSigningCertificateV2HashAlgorithmStr_OnClick
	End Select
End Sub

Sub GetLastAuthAttrSigningTime_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastAuthAttrSigningTime
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastAuthAttrSigningCertificateHash_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastAuthAttrSigningCertificateHash
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastAuthAttrSigningCertificateV2Hash_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastAuthAttrSigningCertificateV2Hash
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastAuthAttrSigningCertificateV2HashAlgorithmOID_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastAuthAttrSigningCertificateV2HashAlgorithmOID
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastAuthAttrSigningCertificateV2HashAlgorithmNumber_OnClick
	On Error Resume Next
	LastCertBox.value = CStr(Signer.LastAuthAttrSigningCertificateV2HashAlgorithmNumber)
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastAuthAttrSigningCertificateV2HashAlgorithmStr_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastAuthAttrSigningCertificateV2HashAlgorithmStr
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub LastTimeStampAction_OnClick
	Select Case LastTimeStampOption.value
		Case "1"	GetLastTimeStampVersion_OnClick
		Case "2"	GetLastTimeStampPolicy_OnClick
		Case "3"	GetLastTimeStampHashAlgorithmOID_OnClick
		Case "4"	GetLastTimeStampHashAlgorithmNumber_OnClick
		Case "5"	GetLastTimeStampHashAlgorithmStr_OnClick
		Case "6"	GetLastTimeStampHashedMessage_OnClick
		Case "7"	GetLastTimeStampSN_OnClick
		Case "8"	GetLastTimeStampTimeGeneralized_OnClick
		Case "9"	GetLastTimeStampTimeUTC_OnClick
		Case "10"	GetLastTimeStampTimeLocal_OnClick
		Case "11"	GetLastTimeStampNonce_OnClick
		Case "12"	GetLastTimeStampSignatureHashAlgorithmOID_OnClick
		Case "13"	GetLastTimeStampSignatureHashAlgorithmNumber_OnClick
		Case "14"	GetLastTimeStampSignatureHashAlgorithmStr_OnClick
	End Select
End Sub

Sub GetLastTimeStampVersion_OnClick
	On Error Resume Next
	LastCertBox.value = CStr(Signer.LastTimeStampVersion)
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastTimeStampPolicy_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastTimeStampPolicy
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastTimeStampHashAlgorithmOID_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastTimeStampHashAlgorithmOID
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastTimeStampHashAlgorithmNumber_OnClick
	On Error Resume Next
	LastCertBox.value = CStr(Signer.LastTimeStampHashAlgorithmNumber)
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastTimeStampHashAlgorithmStr_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastTimeStampHashAlgorithmStr
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastTimeStampHashedMessage_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastTimeStampHashedMessage
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastTimeStampSN_OnClick
	On Error Resume Next
	sLastTimeStampSN = Signer.LastTimeStampSN
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	Else
		LastCertBox.value = sLastTimeStampSN + " (" + Signer.HexToDec(sLastTimeStampSN) + ")"
		If Err.number <> 0 Then
			LastCertBox.value = HandleError
		End If
	End If
End Sub

Sub GetLastTimeStampTimeGeneralized_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastTimeStampTimeGeneralized
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastTimeStampTimeUTC_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastTimeStampTimeUTC
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastTimeStampTimeLocal_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastTimeStampTimeLocal
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastTimeStampNonce_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastTimeStampNonce
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastTimeStampSignatureHashAlgorithmOID_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastTimeStampSignatureHashAlgorithmOID
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastTimeStampSignatureHashAlgorithmNumber_OnClick
	On Error Resume Next
	LastCertBox.value = CStr(Signer.LastTimeStampSignatureHashAlgorithmNumber)
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastTimeStampSignatureHashAlgorithmStr_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastTimeStampSignatureHashAlgorithmStr
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub LastCertTimeStampSignatureAction_OnClick
	Select Case LastCertTimeStampSignatureOption.value
		Case "1"	ReleaseLastCertTimeStampSignature_OnClick
		Case "2"	ShowLastCertTimeStampSignature_OnClick
		Case "3"	GetLastCertTimeStampSignaturePem_OnClick
		Case "5"	GetLastCertTimeStampSignatureSN_OnClick
		Case "6"	GetLastCertTimeStampSignatureNotBefore_OnClick
		Case "7"	GetLastCertTimeStampSignatureNotAfter_OnClick
		Case "8"	GetLastCertTimeStampSignatureStr_OnClick
		Case "9"	GetLastCertTimeStampSignatureSubjectCN_OnClick
		Case "10"	GetLastCertTimeStampSignatureSubjectE_OnClick
		Case "11"	GetLastCertTimeStampSignatureSubjectStrSimple_OnClick
		Case "12"	GetLastCertTimeStampSignatureSubjectStrOID_OnClick
		Case "13"	GetLastCertTimeStampSignatureSubjectStrX500_OnClick
		Case "14"	GetLastCertTimeStampSignatureIssuerCN_OnClick
		Case "15"	GetLastCertTimeStampSignatureIssuerStrSimple_OnClick
		Case "16"	GetLastCertTimeStampSignatureIssuerStrOID_OnClick
		Case "17"	GetLastCertTimeStampSignatureIssuerStrX500_OnClick
		Case "18"	VerifyCertificateChainTimeStampSignature_OnClick
	End Select
End Sub

Sub LastTimeStampAuthAttrAction_OnClick
	Select Case LastTimeStampAuthAttrOption.value
		Case "1"	GetLastTimeStampAuthAttrSigningCertificateHash_OnClick
		Case "2"	GetLastTimeStampAuthAttrSigningCertificateV2Hash_OnClick
		Case "3"	GetLastTimeStampAuthAttrSigningCertificateV2HashAlgorithmOID_OnClick
		Case "4"	GetLastTimeStampAuthAttrSigningCertificateV2HashAlgorithmNumber_OnClick
		Case "5"	GetLastTimeStampAuthAttrSigningCertificateV2HashAlgorithmStr_OnClick
	End Select
End Sub

Sub GetLastTimeStampAuthAttrSigningCertificateHash_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastTimeStampAuthAttrSigningCertificateHash
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastTimeStampAuthAttrSigningCertificateV2Hash_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastTimeStampAuthAttrSigningCertificateV2Hash
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastTimeStampAuthAttrSigningCertificateV2HashAlgorithmOID_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastTimeStampAuthAttrSigningCertificateV2HashAlgorithmOID
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastTimeStampAuthAttrSigningCertificateV2HashAlgorithmNumber_OnClick
	On Error Resume Next
	LastCertBox.value = CStr(Signer.LastTimeStampAuthAttrSigningCertificateV2HashAlgorithmNumber)
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastTimeStampAuthAttrSigningCertificateV2HashAlgorithmStr_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastTimeStampAuthAttrSigningCertificateV2HashAlgorithmStr
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub ReleaseLastCertTimeStampSignature_OnClick
	On Error Resume Next
	Signer.ReleaseLastCert(1)
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Uvolnìní podpisového certifikátu èasového razítka")
	End If
End Sub

Sub ShowLastCertTimeStampSignature_OnClick
	On Error Resume Next
	Signer.ShowLastCertTimeStampSignature()
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Podpisovı certifikát èasového razítka")
	End If
End Sub

Sub GetLastCertTimeStampSignaturePem_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertTimeStampSignaturePem
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertTimeStampSignatureSN_OnClick
	On Error Resume Next
	sLastCertTimeStampSignatureSN = Signer.LastCertTimeStampSignatureSN
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
		LastCertSN.value = ""
	Else
		LastCertBox.value = sLastCertTimeStampSignatureSN + " (" + Signer.HexToDec(sLastCertTimeStampSignatureSN) + ")"
		If Err.number <> 0 Then
			LastCertBox.value = HandleError
			LastCertSN.value = ""
		Else
			LastCertSN.value = sLastCertTimeStampSignatureSN
		End If
	End If
End Sub

Sub GetLastCertTimeStampSignatureNotBefore_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertTimeStampSignatureNotBefore
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertTimeStampSignatureNotAfter_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertTimeStampSignatureNotAfter
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertTimeStampSignatureStr_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertTimeStampSignatureStr
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertTimeStampSignatureSubjectCN_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertTimeStampSignatureSubjectCN
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertTimeStampSignatureSubjectE_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertTimeStampSignatureSubjectE
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertTimeStampSignatureSubjectStrSimple_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertTimeStampSignatureSubjectStrSimple
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertTimeStampSignatureSubjectStrOID_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertTimeStampSignatureSubjectStrOID
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertTimeStampSignatureSubjectStrX500_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertTimeStampSignatureSubjectStrX500
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertTimeStampSignatureIssuerCN_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertTimeStampSignatureIssuerCN
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertTimeStampSignatureIssuerStrSimple_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertTimeStampSignatureIssuerStrSimple
	LastCertIssuer.value = LastCertBox.value
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertTimeStampSignatureIssuerStrOID_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertTimeStampSignatureIssuerStrOID
	LastCertIssuer.value = LastCertBox.value
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertTimeStampSignatureIssuerStrX500_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertTimeStampSignatureIssuerStrX500
	LastCertIssuer.value = LastCertBox.value
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub LastCertSenderSignatureAction_OnClick
	Select Case LastCertSenderSignatureOption.value
		Case "1"	ReleaseLastCertSenderSignature_OnClick
		Case "2"	ShowLastCertSenderSignature_OnClick
		Case "3"	GetLastCertSenderSignaturePem_OnClick
		Case "4"	SetLastCertSenderSignaturePem_OnClick
		Case "5"	GetLastCertSenderSignatureSN_OnClick
		Case "6"	GetLastCertSenderSignatureNotBefore_OnClick
		Case "7"	GetLastCertSenderSignatureNotAfter_OnClick
		Case "8"	GetLastCertSenderSignatureStr_OnClick
		Case "9"	GetLastCertSenderSignatureSubjectCN_OnClick
		Case "10"	GetLastCertSenderSignatureSubjectE_OnClick
		Case "11"	GetLastCertSenderSignatureSubjectStrSimple_OnClick
		Case "12"	GetLastCertSenderSignatureSubjectStrOID_OnClick
		Case "13"	GetLastCertSenderSignatureSubjectStrX500_OnClick
		Case "14"	GetLastCertSenderSignatureIssuerCN_OnClick
		Case "15"	GetLastCertSenderSignatureIssuerStrSimple_OnClick
		Case "16"	GetLastCertSenderSignatureIssuerStrOID_OnClick
		Case "17"	GetLastCertSenderSignatureIssuerStrX500_OnClick
		Case "20"	GetLastCertSenderSignatureCSPName_OnClick
		Case "18"	VerifyCertificateChainSenderSignature_OnClick
		Case "19"	SetLastCertSenderSignatureForIssuerAndSN_OnClick
	End Select
End Sub

Sub ReleaseLastCertSenderSignature_OnClick
	On Error Resume Next
	Signer.ReleaseLastCert(1)
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Uvolnìní podepisovacího certifikátu odesílatele")
	End If
End Sub

Sub ShowLastCertSenderSignature_OnClick
	On Error Resume Next
	Signer.ShowLastCertSenderSignature()
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Podepisovací certifikát odesílatele")
	End If
End Sub

Sub GetLastCertSenderSignaturePem_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderSignaturePem
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub SetLastCertSenderSignaturePem_OnClick
	On Error Resume Next
	Signer.LastCertSenderSignaturePem = LastCertBox.value
	If Err.number <> 0 Then
		Dim Resp
		Resp = MsgBox(HandleError, vbInformation, "Nastavení podepisovacího certifikátu odesílatele")
	End If
End Sub

Sub GetLastCertSenderSignatureSN_OnClick
	On Error Resume Next
	sLastCertSenderSignatureSN = Signer.LastCertSenderSignatureSN
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
		LastCertSN.value = ""
	Else
		LastCertBox.value = sLastCertSenderSignatureSN + " (" + Signer.HexToDec(sLastCertSenderSignatureSN) + ")"
		If Err.number <> 0 Then
			LastCertBox.value = HandleError
			LastCertSN.value = ""
		Else
			LastCertSN.value = sLastCertSenderSignatureSN
		End If
	End If
End Sub

Sub GetLastCertSenderSignatureNotBefore_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderSignatureNotBefore
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertSenderSignatureNotAfter_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderSignatureNotAfter
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertSenderSignatureStr_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderSignatureStr
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertSenderSignatureSubjectCN_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderSignatureSubjectCN
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertSenderSignatureSubjectE_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderSignatureSubjectE
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertSenderSignatureSubjectStrSimple_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderSignatureSubjectStrSimple
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertSenderSignatureSubjectStrOID_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderSignatureSubjectStrOID
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertSenderSignatureSubjectStrX500_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderSignatureSubjectStrX500
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertSenderSignatureIssuerCN_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderSignatureIssuerCN
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertSenderSignatureIssuerStrSimple_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderSignatureIssuerStrSimple
	LastCertIssuer.value = LastCertBox.value
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertSenderSignatureIssuerStrOID_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderSignatureIssuerStrOID
	LastCertIssuer.value = LastCertBox.value
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertSenderSignatureIssuerStrX500_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderSignatureIssuerStrX500
	LastCertIssuer.value = LastCertBox.value
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertSenderSignatureCSPName_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderSignatureCSPName
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub SetLastCertSenderSignatureForIssuerAndSN_OnClick
	On Error Resume Next
	RetErr = Signer.SetLastCertSenderSignatureForIssuerAndSN(LastCertIssuer.value, LastCertSN.value)
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub DefaultCertSenderSignatureAction_OnClick
	Select Case DefaultCertSenderSignatureOption.value
		Case "1"	ShowDefaultCertSenderSignature_OnClick
		Case "2"	SetDefaultCertSenderSignature_OnClick
		Case "3"	GetDefaultCertSenderSignaturePem_OnClick
		Case "4"	SetDefaultCertSenderSignaturePem_OnClick
	 End Select
End Sub

Sub ShowDefaultCertSenderSignature_OnClick
	On Error Resume Next
	Signer.ShowDefaultCertSenderSignature()
	If Err.number <> 0 Then
		Dim Resp
		Resp = MsgBox(HandleError, vbInformation, "Zobrazení implicitního podepisovacího certifikátu odesílatele")
	End If
End Sub

Sub SetDefaultCertSenderSignature_OnClick
	On Error Resume Next
	Dim Resp
	Signer.SetDefaultCertSenderSignature()
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení implicitního podepisovacího certifikátu odesílatele")
	Else
		Resp = MsgBox("Implicitní podepisovací certifikát odesílatele byl nastaven.", vbInformation, "Nastavení implicitního podepisovacího certifikátu odesílatele")
	End If
End Sub

Sub GetDefaultCertSenderSignaturePem_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.DefaultCertSenderSignaturePem
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub SetDefaultCertSenderSignaturePem_OnClick
	On Error Resume Next
	Signer.DefaultCertSenderSignaturePem = LastCertBox.value
	If Err.number <> 0 Then
		Dim Resp
		Resp = MsgBox(HandleError, vbInformation, "Nastavení implicitního podepisovacího certifikátu odesílatele")
	End If
End Sub

Sub LastCertSenderKeyExchangeAction_OnClick
	Select Case LastCertSenderKeyExchangeOption.value
		Case "1"	ReleaseLastCertSenderKeyExchange_OnClick
		Case "2"	ShowLastCertSenderKeyExchange_OnClick
		Case "3"	GetLastCertSenderKeyExchangePem_OnClick
		Case "4"	SetLastCertSenderKeyExchangePem_OnClick
		Case "5"	GetLastCertSenderKeyExchangeSN_OnClick
		Case "6"	GetLastCertSenderKeyExchangeNotBefore_OnClick
		Case "7"	GetLastCertSenderKeyExchangeNotAfter_OnClick
		Case "8"	GetLastCertSenderKeyExchangeStr_OnClick
		Case "9"	GetLastCertSenderKeyExchangeSubjectCN_OnClick
		Case "10"	GetLastCertSenderKeyExchangeSubjectE_OnClick
		Case "11"	GetLastCertSenderKeyExchangeSubjectStrSimple_OnClick
		Case "12"	GetLastCertSenderKeyExchangeSubjectStrOID_OnClick
		Case "13"	GetLastCertSenderKeyExchangeSubjectStrX500_OnClick
		Case "14"	GetLastCertSenderKeyExchangeIssuerCN_OnClick
		Case "15"	GetLastCertSenderKeyExchangeIssuerStrSimple_OnClick
		Case "16"	GetLastCertSenderKeyExchangeIssuerStrOID_OnClick
		Case "17"	GetLastCertSenderKeyExchangeIssuerStrX500_OnClick
		Case "18"	VerifyCertificateChainSenderKeyExchange_OnClick
		Case "19"	SetLastCertSenderKeyExchangeForIssuerAndSN_OnClick
	 End Select
End Sub

Sub ReleaseLastCertSenderKeyExchange_OnClick
	On Error Resume Next
	Signer.ReleaseLastCert(2)
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Uvolnìní šifrovacího certifikátu odesílatele")
	End If
End Sub

Sub ShowLastCertSenderKeyExchange_OnClick
	On Error Resume Next
	Signer.ShowLastCertSenderKeyExchange()
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Šifrovací certifikát pøíjemce")
	End If
End Sub

Sub GetLastCertSenderKeyExchangePem_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderKeyExchangePem
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub SetLastCertSenderKeyExchangePem_OnClick
	On Error Resume Next
	Signer.LastCertSenderKeyExchangePem = LastCertBox.value
	If Err.number <> 0 Then
		Dim Resp
		Resp = MsgBox(HandleError, vbInformation, "Nastavení šifrovacího certifikátu odesílatele")
	End If
End Sub

Sub GetLastCertSenderKeyExchangeSN_OnClick
	On Error Resume Next
	sLastCertSenderKeyExchangeSN = Signer.LastCertSenderKeyExchangeSN
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
		LastCertSN.value = ""
	Else
		LastCertBox.value = sLastCertSenderKeyExchangeSN + " (" + Signer.HexToDec(sLastCertSenderKeyExchangeSN) + ")"
		If Err.number <> 0 Then
			LastCertBox.value = HandleError
			LastCertSN.value = ""
		Else
			LastCertSN.value = sLastCertSenderKeyExchangeSN
		End If
	End If
End Sub

Sub GetLastCertSenderKeyExchangeNotBefore_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderKeyExchangeNotBefore
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertSenderKeyExchangeNotAfter_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderKeyExchangeNotAfter
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertSenderKeyExchangeStr_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderKeyExchangeStr
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertSenderKeyExchangeSubjectCN_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderKeyExchangeSubjectCN
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertSenderKeyExchangeSubjectE_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderKeyExchangeSubjectE
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertSenderKeyExchangeSubjectStrSimple_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderKeyExchangeSubjectStrSimple
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertSenderKeyExchangeSubjectStrOID_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderKeyExchangeSubjectStrOID
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertSenderKeyExchangeSubjectStrX500_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderKeyExchangeSubjectStrX500
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertSenderKeyExchangeIssuerCN_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderKeyExchangeIssuerCN
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertSenderKeyExchangeIssuerStrSimple_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderKeyExchangeIssuerStrSimple
	LastCertIssuer.value = LastCertBox.value
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertSenderKeyExchangeIssuerStrOID_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderKeyExchangeIssuerStrOID
	LastCertIssuer.value = LastCertBox.value
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertSenderKeyExchangeIssuerStrX500_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertSenderKeyExchangeIssuerStrX500
	LastCertIssuer.value = LastCertBox.value
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub SetLastCertSenderKeyExchangeForIssuerAndSN_OnClick
	On Error Resume Next
	RetErr = Signer.SetLastCertSenderKeyExchangeForIssuerAndSN(LastCertIssuer.value, LastCertSN.value)
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub DefaultCertSenderKeyExchangeAction_OnClick
	Select Case DefaultCertSenderKeyExchangeOption.value
		Case "1"	ShowDefaultCertSenderKeyExchange_OnClick
		Case "2"	SetDefaultCertSenderKeyExchange_OnClick
		Case "3"	GetDefaultCertSenderKeyExchangePem_OnClick
		Case "4"	SetDefaultCertSenderKeyExchangePem_OnClick
	 End Select
End Sub

Sub SetDefaultCertSenderKeyExchange_OnClick
	On Error Resume Next
	Dim Resp
	Signer.SetDefaultCertSenderKeyExchange()
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení implicitního šifrovacího certifikátu odesílatele")
	Else
		Resp = MsgBox("Implicitní šifrovací certifikát odesílatele byl nastaven.", vbInformation, "Nastavení implicitního šifrovacího certifikátu odesílatele")
	End If
End Sub

Sub ShowDefaultCertSenderKeyExchange_OnClick
	On Error Resume Next
	Signer.ShowDefaultCertSenderKeyExchange()
	If Err.number <> 0 Then
		Dim Resp
		Resp = MsgBox(HandleError, vbInformation, "Zobrazení implicitního šifrovacího certifikátu odesílatele")
	End If
End Sub

Sub GetDefaultCertSenderKeyExchangePem_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.DefaultCertSenderKeyExchangePem
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub SetDefaultCertSenderKeyExchangePem_OnClick
	On Error Resume Next
	Signer.DefaultCertSenderKeyExchangePem = LastCertBox.value
	If Err.number <> 0 Then
		Dim Resp
		Resp = MsgBox(HandleError, vbInformation, "Nastavení implicitního šifrovacího certifikátu odesílatele")
	End If
End Sub

Sub LastCertReceiverKeyExchangeAction_OnClick
	Select Case LastCertReceiverKeyExchangeOption.value
		Case "1"	ReleaseLastCertReceiverKeyExchange_OnClick
		Case "2"	ShowLastCertReceiverKeyExchange_OnClick
		Case "3"	GetLastCertReceiverKeyExchangePem_OnClick
		Case "4"	SetLastCertReceiverKeyExchangePem_OnClick
		Case "5"	GetLastCertReceiverKeyExchangeSN_OnClick
		Case "6"	GetLastCertReceiverKeyExchangeNotBefore_OnClick
		Case "7"	GetLastCertReceiverKeyExchangeNotAfter_OnClick
		Case "8"	GetLastCertReceiverKeyExchangeStr_OnClick
		Case "9"	GetLastCertReceiverKeyExchangeSubjectCN_OnClick
		Case "10"	GetLastCertReceiverKeyExchangeSubjectE_OnClick
		Case "11"	GetLastCertReceiverKeyExchangeSubjectStrSimple_OnClick
		Case "12"	GetLastCertReceiverKeyExchangeSubjectStrOID_OnClick
		Case "13"	GetLastCertReceiverKeyExchangeSubjectStrX500_OnClick
		Case "14"	GetLastCertReceiverKeyExchangeIssuerCN_OnClick
		Case "15"	GetLastCertReceiverKeyExchangeIssuerStrSimple_OnClick
		Case "16"	GetLastCertReceiverKeyExchangeIssuerStrOID_OnClick
		Case "17"	GetLastCertReceiverKeyExchangeIssuerStrX500_OnClick
		Case "18"	VerifyCertificateChainReceiverKeyExchange_OnClick
		Case "19"	SetLastCertReceiverKeyExchangeForIssuerAndSN_OnClick
	End Select
End Sub

Sub ReleaseLastCertReceiverKeyExchange_OnClick
	On Error Resume Next
	Signer.ReleaseLastCert(4)
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Uvolnìní šifrovacího certifikátu pøíjemce")
	End If
End Sub

Sub ShowLastCertReceiverKeyExchange_OnClick
	On Error Resume Next
	Signer.ShowLastCertReceiverKeyExchange()
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Šifrovací certifikát pøíjemce")
	End If
End Sub

Sub GetLastCertReceiverKeyExchangePem_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertReceiverKeyExchangePem
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub SetLastCertReceiverKeyExchangePem_OnClick
	On Error Resume Next
	Signer.LastCertReceiverKeyExchangePem = LastCertBox.value
	If Err.number <> 0 Then
		Dim Resp
		Resp = MsgBox(HandleError, vbInformation, "Nastavení šifrovacího certifikátu pøíjemce")
	End If
End Sub

Sub GetLastCertReceiverKeyExchangeSN_OnClick
	On Error Resume Next
	sLastCertReceiverKeyExchangeSN = Signer.LastCertReceiverKeyExchangeSN
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
		LastCertSN.value = ""
	Else
		LastCertBox.value = sLastCertReceiverKeyExchangeSN + " (" + Signer.HexToDec(sLastCertReceiverKeyExchangeSN) + ")"
		If Err.number <> 0 Then
			LastCertBox.value = HandleError
			LastCertSN.value = ""
		Else
			LastCertSN.value = sLastCertReceiverKeyExchangeSN
		End If
	End If
End Sub

Sub GetLastCertReceiverKeyExchangeNotBefore_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertReceiverKeyExchangeNotBefore
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertReceiverKeyExchangeNotAfter_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertReceiverKeyExchangeNotAfter
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertReceiverKeyExchangeStr_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertReceiverKeyExchangeStr
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertReceiverKeyExchangeSubjectCN_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertReceiverKeyExchangeSubjectCN
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertReceiverKeyExchangeSubjectE_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertReceiverKeyExchangeSubjectE
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertReceiverKeyExchangeSubjectStrSimple_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertReceiverKeyExchangeSubjectStrSimple
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertReceiverKeyExchangeSubjectStrOID_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertReceiverKeyExchangeSubjectStrOID
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertReceiverKeyExchangeSubjectStrX500_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertReceiverKeyExchangeSubjectStrX500
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertReceiverKeyExchangeIssuerCN_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertReceiverKeyExchangeIssuerCN
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertReceiverKeyExchangeIssuerStrSimple_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertReceiverKeyExchangeIssuerStrSimple
	LastCertIssuer.value = LastCertBox.value
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertReceiverKeyExchangeIssuerStrOID_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertReceiverKeyExchangeIssuerStrOID
	LastCertIssuer.value = LastCertBox.value
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub GetLastCertReceiverKeyExchangeIssuerStrX500_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.LastCertReceiverKeyExchangeIssuerStrX500
	LastCertIssuer.value = LastCertBox.value
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub SetLastCertReceiverKeyExchangeForIssuerAndSN_OnClick
	On Error Resume Next
	RetErr = Signer.SetLastCertReceiverKeyExchangeForIssuerAndSN(LastCertIssuer.value, LastCertSN.value)
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub DefaultCertReceiverKeyExchangeAction_OnClick
	Select Case DefaultCertReceiverKeyExchangeOption.value
		Case "1"	ShowDefaultCertReceiverKeyExchange_OnClick
		Case "2"	SetDefaultCertReceiverKeyExchange_OnClick
		Case "3"	GetDefaultCertReceiverKeyExchangePem_OnClick
		Case "4"	SetDefaultCertReceiverKeyExchangePem_OnClick
	 End Select
End Sub

Sub SetDefaultCertReceiverKeyExchange_OnClick
	On Error Resume Next
	Dim Resp
	Signer.SetDefaultCertReceiverKeyExchange()
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení implicitního šifrovacího certifikátu pøíjemce")
	Else
		Resp = MsgBox("Implicitní šifrovací certifikát pøíjemce byl nastaven.", vbInformation, "Nastavení implicitního šifrovacího certifikátu pøíjemce")
	End If
End Sub

Sub ShowDefaultCertReceiverKeyExchange_OnClick
	On Error Resume Next
	Signer.ShowDefaultCertReceiverKeyExchange()
	If Err.number <> 0 Then
		Dim Resp
		Resp = MsgBox(HandleError, vbInformation, "Zobrazení implicitního šifrovacího certifikátu pøíjemce")
	End If
End Sub

Sub GetDefaultCertReceiverKeyExchangePem_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.DefaultCertReceiverKeyExchangePem
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub SetDefaultCertReceiverKeyExchangePem_OnClick
	On Error Resume Next
	Signer.DefaultCertReceiverKeyExchangePem = LastCertBox.value
	If Err.number <> 0 Then
		Dim Resp
		Resp = MsgBox(HandleError, vbInformation, "Nastavení implicitního šifrovacího certifikátu pøíjemce")
	End If
End Sub

Sub DefaultCertSenderAuthenticationAction_OnClick
	Select Case DefaultCertSenderAuthenticationOption.value
		Case "1"	ShowDefaultCertSenderAuthentication_OnClick
		Case "2"	SetDefaultCertSenderAuthentication_OnClick
		Case "3"	GetDefaultCertSenderAuthenticationPem_OnClick
		Case "4"	SetDefaultCertSenderAuthenticationPem_OnClick
	 End Select
End Sub

Sub ShowDefaultCertSenderAuthentication_OnClick
	On Error Resume Next
	Signer.ShowDefaultCertSenderAuthentication()
	If Err.number <> 0 Then
		Dim Resp
		Resp = MsgBox(HandleError, vbInformation, "Zobrazení implicitního autentizaèního certifikátu odesílatele")
	End If
End Sub

Sub SetDefaultCertSenderAuthentication_OnClick
	On Error Resume Next
	Dim Resp
	Signer.SetDefaultCertSenderAuthentication()
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení implicitního autentizaèní certifikátu odesílatele")
	Else
		Resp = MsgBox("Implicitní autentizaèní certifikát odesílatele byl nastaven.", vbInformation, "Nastavení implicitního autentizaèního certifikátu odesílatele")
	End If
End Sub

Sub GetDefaultCertSenderAuthenticationPem_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.DefaultCertSenderAuthenticationPem
	If Err.number <> 0 Then
		LastCertBox.value = HandleError
	End If
End Sub

Sub SetDefaultCertSenderAuthenticationPem_OnClick
	On Error Resume Next
	Signer.DefaultCertSenderAuthenticationPem = LastCertBox.value
	If Err.number <> 0 Then
		Dim Resp
		Resp = MsgBox(HandleError, vbInformation, "Nastavení implicitního autentazizaèního certifikátu odesílatele")
	End If
End Sub

Sub ShowCertPem_OnClick
	On Error Resume Next
	Signer.ShowCertPem(LastCertBox.value)
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Zobrazení certifikátu")
	End If
End Sub

Sub ReleaseAllLastCerts_OnClick
	On Error Resume Next
	Signer.ReleaseAllLastCerts
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Uvolnìní certifikátù")
	End If
End Sub

Sub SelectCryptographicServiceProvider_OnClick
	On Error Resume Next
	Signer.SelectCryptographicServiceProvider()
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Vıbìr CSP")
	End If
End Sub

Sub SetPresentCardCSP_OnClick
	On Error Resume Next
	Signer.SetPresentCardCSP()
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Vıbìr CSP podle aktuální karty")
	End If
End Sub

Sub SetCryptographicServiceProvider_OnClick
	On Error Resume Next
	Signer.CryptographicServiceProvider = CSP.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení CSP")
	End If
End Sub

Sub GetCryptographicServiceProvider_OnClick
	On Error Resume Next
	CSP.value = Signer.CryptographicServiceProvider
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Získání CSP")
	End If
End Sub

Sub SetCryptographicServiceProviderFilterDenied_OnClick
	On Error Resume Next
	Signer.CryptographicServiceProviderFilterDenied = CSPFilterDenied.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení filtru zakázanıch CSP")
	End If
End Sub

Sub GetCryptographicServiceProviderFilterDenied_OnClick
	On Error Resume Next
	CSPFilterDenied.value = Signer.CryptographicServiceProviderFilterDenied
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Získání filtru zakázanıch CSP")
	End If
End Sub

Sub SetCryptographicServiceProviderFilterAllowed_OnClick
	On Error Resume Next
	Signer.CryptographicServiceProviderFilterAllowed = CSPFilterAllowed.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení filtru povolenıch CSP")
	End If
End Sub

Sub GetCryptographicServiceProviderFilterAllowed_OnClick
	On Error Resume Next
	CSPFilterAllowed.value = Signer.CryptographicServiceProviderFilterAllowed
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Získání filtru povolenıch CSP")
	End If
End Sub

Sub CreateGuid_OnClick
	On Error Resume Next
	Guid.value = Signer.CreateGuid(GuidForm.value)
	If Err.number <> 0 Then
		Guid.value = HandleError
	End If
End Sub

Sub SetCryptoFormatStr_OnClick
	On Error Resume Next
	Signer.CfgCryptoFormatStr = CryptoFormatStr.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení formátu kryptografické zprávy")
	End If
End Sub

Sub GetCryptoFormatStr_OnClick
	On Error Resume Next
	CryptoFormatStr.value = Signer.CfgCryptoFormatStr
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Získání formátu kryptografické zprávy")
	End If
End Sub

Sub SetCryptoFormatNumber_OnClick
	On Error Resume Next
	Signer.CfgCryptoFormatNumber = CryptoFormatNumber.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení formátu kryptografické zprávy")
	End If
End Sub

Sub GetCryptoFormatNumber_OnClick
	On Error Resume Next
	CryptoFormatNumber.value = Signer.CfgCryptoFormatNumber
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Získání formátu kryptografické zprávy")
	End If
End Sub

Sub SetSignatureHashAlgorithmStr_OnClick
	On Error Resume Next
	Signer.CfgSignatureHashAlgorithmStr = SignatureHashAlgorithmStr.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení algoritmu miniatury podpisu")
	End If
End Sub

Sub GetSignatureHashAlgorithmStr_OnClick
	On Error Resume Next
	SignatureHashAlgorithmStr.value = Signer.CfgSignatureHashAlgorithmStr
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Získání algoritmu miniatury podpisu")
	End If
End Sub

Sub SetSignatureHashAlgorithmNumber_OnClick
	On Error Resume Next
	Signer.CfgSignatureHashAlgorithmNumber = SignatureHashAlgorithmNumber.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení algoritmu miniatury podpisu")
	End If
End Sub

Sub GetSignatureHashAlgorithmNumber_OnClick
	On Error Resume Next
	SignatureHashAlgorithmNumber.value = Signer.CfgSignatureHashAlgorithmNumber
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Získání algoritmu miniatury podpisu")
	End If
End Sub

Sub SetSigningCertificateHashAlgorithmStr_OnClick
	On Error Resume Next
	Signer.CfgSigningCertificateHashAlgorithmStr = SigningCertificateHashAlgorithmStr.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení algoritmu miniatury atributu podpisu SigningCertificate")
	End If
End Sub

Sub GetSigningCertificateHashAlgorithmStr_OnClick
	On Error Resume Next
	SigningCertificateHashAlgorithmStr.value = Signer.CfgSigningCertificateHashAlgorithmStr
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Získání algoritmu miniatury atributu podpisu SigningCertificate")
	End If
End Sub

Sub SetXmlSignatureLocation_OnClick
	On Error Resume Next
	Signer.CfgXmlSignatureLocation = XmlSignatureLocation.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení umístìní XML podpisu")
	End If
End Sub

Sub GetXmlSignatureLocation_OnClick
	On Error Resume Next
	XmlSignatureLocation.value = Signer.CfgXmlSignatureLocation
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Získání umístìní XML")
	End If
End Sub

Sub SetSigningCertificateHashAlgorithmNumber_OnClick
	On Error Resume Next
	Signer.CfgSigningCertificateHashAlgorithmNumber = SigningCertificateHashAlgorithmNumber.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení algoritmu miniatury atributu podpisu SigningCertificate")
	End If
End Sub

Sub GetSigningCertificateHashAlgorithmNumber_OnClick
	On Error Resume Next
	SigningCertificateHashAlgorithmNumber.value = Signer.CfgSigningCertificateHashAlgorithmNumber
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Získání algoritmu miniatury atributu podpisu SigningCertificate")
	End If
End Sub

Sub SetContentEncryptionAlgorithmStr_OnClick
	On Error Resume Next
	Signer.CfgContentEncryptionAlgorithmStr = ContentEncryptionAlgorithmStr.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení algoritmu šifrování obsahu")
	End If
End Sub

Sub GetContentEncryptionAlgorithmStr_OnClick
	On Error Resume Next
	ContentEncryptionAlgorithmStr.value = Signer.CfgContentEncryptionAlgorithmStr
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Získání algoritmu šifrování obsahu")
	End If
End Sub

Sub SetContentEncryptionAlgorithmNumber_OnClick
	On Error Resume Next
	Signer.CfgContentEncryptionAlgorithmNumber = ContentEncryptionAlgorithmNumber.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení algoritmu šifrování obsahu")
	End If
End Sub

Sub GetContentEncryptionAlgorithmNumber_OnClick
	On Error Resume Next
	ContentEncryptionAlgorithmNumber.value = Signer.CfgContentEncryptionAlgorithmNumber
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Získání algoritmu šifrování obsahu")
	End If
End Sub

Sub SetRc2KeyBitLen_OnClick
	On Error Resume Next
	Signer.CfgRc2KeyBitLen = Rc2KeyBitLen.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení délky klíèe algoritmu RC2")
	End If
End Sub

Sub GetRc2KeyBitLen_OnClick
	On Error Resume Next
	Rc2KeyBitLen.value = Signer.CfgRc2KeyBitLen
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Získání délky klíèe algoritmu RC2")
	End If
End Sub

Sub SetLanguageStr_OnClick
	On Error Resume Next
	Signer.CfgLanguageStr = LanguageStr.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení jazyka")
	End If
End Sub

Sub GetLanguageStr_OnClick
	On Error Resume Next
	LanguageStr.value = Signer.CfgLanguageStr
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Získání jazyka")
	End If
End Sub

Sub SetLanguageNumber_OnClick
	On Error Resume Next
	Signer.CfgLanguageNumber = LanguageNumber.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení jazyka")
	End If
End Sub

Sub GetLanguageNumber_OnClick
	On Error Resume Next
	LanguageNumber.value = Signer.CfgLanguageNumber
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Získání jazyka")
	End If
End Sub

Sub GetTsaServer_OnClick
	On Error Resume Next
	TsaServer.value = Signer.CfgTsaServer
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Získání adresy serveru TSA")
	End If
End Sub

Sub GetTsaPolicy_OnClick
	On Error Resume Next
	TsaPolicy.value = Signer.CfgTsaPolicy
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Získání politiky TSA")
	End If
End Sub

Sub SetCfgWarningDlg_OnClick
	On Error Resume Next
	Signer.CfgWarningDlg = CfgWarningDlg.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení zobrazování upozoròovacího dialogu")
	End If
End Sub

Sub GetCfgWarningDlg_OnClick
	On Error Resume Next
	CfgWarningDlg.value = Signer.CfgWarningDlg
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Získání nastavení zobrazování upozoròovacího dialogu")
	End If
End Sub

Sub SetCfgShowCert_OnClick
	On Error Resume Next
	Signer.CfgShowCert = CfgShowCert.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení zobrazování certifikátù")
	End If
End Sub

Sub GetCfgShowCert_OnClick
	On Error Resume Next
	CfgShowCert.value = Signer.CfgShowCert
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Získání nastavení zobrazování certifikátù")
	End If
End Sub

Sub SetCfgCodePageStr_OnClick
	On Error Resume Next
	Signer.CfgCodePageStr = CfgCodePageStr.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení znakové sady modulu")
	End If
End Sub

Sub GetCfgCodePageStr_OnClick
	On Error Resume Next
	CfgCodePageStr.value = Signer.CfgCodePageStr
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Zjištìní znakové sady modulu")
	End If
End Sub

Sub SetCfgCodePageNumber_OnClick
	On Error Resume Next
	Signer.CfgCodePageNumber = CfgCodePageNumber.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení znakové sady modulu")
	End If
End Sub

Sub GetCfgCodePageNumber_OnClick
	On Error Resume Next
	CfgCodePageNumber.value = Signer.CfgCodePageNumber
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Zjištìní znakové sady modulu")
	End If
End Sub

Sub SetCfgCertSenderSignatureNumber_OnClick
	On Error Resume Next
	Signer.CfgCertSenderSignatureNumber = CfgCertSenderSignatureNumber.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení poètu podepisovacích certifikátù odesílatele")
	End If
End Sub

Sub GetCfgCertSenderSignatureNumber_OnClick
	On Error Resume Next
	CfgCertSenderSignatureNumber.value = Signer.CfgCertSenderSignatureNumber
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Zjištìní poètu podepisovacích certifikátù odesílatele")
	End If
End Sub

Sub SetCfgCertSenderSignatureIdx_OnClick
	On Error Resume Next
	Signer.CfgCertSenderSignatureIdx = CfgCertSenderSignatureIdx.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení indexu aktuálního podepisovacího certifikátu odesílatele")
	End If
End Sub

Sub GetCfgCertSenderSignatureIdx_OnClick
	On Error Resume Next
	CfgCertSenderSignatureIdx.value = Signer.CfgCertSenderSignatureIdx
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Zjištìní indexu aktuálního podepisovacího certifikátu odesílatele")
	End If
End Sub

Sub SetCfgCertReceiverKeyExchangeNumber_OnClick
	On Error Resume Next
	Signer.CfgCertReceiverKeyExchangeNumber = CfgCertReceiverKeyExchangeNumber.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení poètu šifrovacích certifikátù pøíjemce")
	End If
End Sub

Sub GetCfgCertReceiverKeyExchangeNumber_OnClick
	On Error Resume Next
	CfgCertReceiverKeyExchangeNumber.value = Signer.CfgCertReceiverKeyExchangeNumber
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Zjištìní poètu šifrovacích certifikátù pøíjemce")
	End If
End Sub

Sub SetCfgCertReceiverKeyExchangeIdx_OnClick
	On Error Resume Next
	Signer.CfgCertReceiverKeyExchangeIdx = CfgCertReceiverKeyExchangeIdx.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení indexu aktuálního šifrovacího certifikátu pøíjemce")
	End If
End Sub

Sub GetCfgCertReceiverKeyExchangeIdx_OnClick
	On Error Resume Next
	CfgCertReceiverKeyExchangeIdx.value = Signer.CfgCertReceiverKeyExchangeIdx
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Zjištìní indexu aktuálního šifrovacího certifikátu pøíjemce")
	End If
End Sub

Sub GetCfgVerifyTimeStampArchivalNumber_OnClick
	On Error Resume Next
	CfgVerifyTimeStampArchivalNumber.value = Signer.CfgVerifyTimeStampArchivalNumber
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Zjištìní poètu archivních èasovıch razítek")
	End If
End Sub

Sub SetCfgVerifyTimeStampArchivalIdx_OnClick
	On Error Resume Next
	Signer.CfgVerifyTimeStampArchivalIdx = CfgVerifyTimeStampArchivalIdx.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení indexu aktuálního archivního èasového razítka")
	End If
End Sub

Sub GetCfgVerifyTimeStampArchivalIdx_OnClick
	On Error Resume Next
	CfgVerifyTimeStampArchivalIdx.value = Signer.CfgVerifyTimeStampArchivalIdx
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Zjištìní indexu aktuálního archivního èasového razítka")
	End If
End Sub

Sub SetCfgLastTimeStampNumber_OnClick
	On Error Resume Next
	If CfgLastTimeStampNumber(0).checked = True Then
		Signer.CfgLastTimeStampNumber = 0
	ElseIf CfgLastTimeStampNumber(1).checked = True Then
		Signer.CfgLastTimeStampNumber = 1
	Else
		Resp = MsgBox("Chyba v nastavení obsahu posledního èasového razítka", vbInformation, "Nastavení obsahu posledního èasového razítka")
	End If

	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení obsahu posledního èasového razítka")
	End If
End Sub

Sub GetCfgLastTimeStampNumber_OnClick
	On Error Resume Next
	CfgLastTimeStampNumberValue = Signer.CfgLastTimeStampNumber
	If Err.number <> 0 Then
		Resp = MsgBox("Chyba pøi zjišování nastavení obsahu posledního èasového razítka", vbInformation, "Nastavení obsahu posledního èasového razítka")
	Else
		Select Case CfgLastTimeStampNumberValue
			Case 0
				CfgLastTimeStampNumber(0).checked = True
				CfgLastTimeStampNumber(1).checked = False
			Case 1
				CfgLastTimeStampNumber(0).checked = False
				CfgLastTimeStampNumber(1).checked = True
			Case Else
				Resp = MsgBox("Chyba pøi zjišování nastavení obsahu posledního èasového razítka", vbInformation, "Nastavení obsahu posledního èasového razítka")
		End Select
	End If
End Sub

Sub GetSystemAnsiCodePageId_OnClick
	On Error Resume Next
	SystemAnsiCodePageId.value = Signer.SystemAnsiCodePageId
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Zjištìní implicitní znakové sady ANSI systému")
	End If
End Sub

Sub GetSystemOemCodePageId_OnClick
	On Error Resume Next
	SystemOemCodePageId.value = Signer.SystemOemCodePageId
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Zjištìní implicitní znakové sady OEM systému")
	End If
End Sub

Sub PutCertStorePem_OnClick
	On Error Resume Next
	Signer.CertStorePem = LastCertBox.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Úloištì certifikátù modulu")
	End If
End Sub

Sub GetCertStorePem_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.CertStorePem
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Úloištì certifikátù modulu")
	End If
End Sub

Sub PutCrlStorePem_OnClick
	On Error Resume Next
	Signer.CrlStorePem = LastCertBox.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Úloištì seznamù zneplatnìnıch certifikátù modulu")
	End If
End Sub

Sub GetCrlStorePem_OnClick
	On Error Resume Next
	LastCertBox.value = Signer.CrlStorePem
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Úloištì seznamù zneplatnìnıch certifikátù modulu")
	End If
End Sub

Sub DeleteCerts_OnClick
	On Error Resume Next
	Dim DeletedCertsNumber, Resp, OkStr
	DeletedCertsNumber = Signer.DeleteCerts(DeleteCertsCSP.value, ContainerStr.value)
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Mazání certifikátù")
	Else
		OkStr = "Bylo smazáno " + CStr(DeletedCertsNumber) + " certifikátù z kontejnerù obsahujících øetìzec " + ContainerStr.value + " pomocí poskytovatele kryptografickıch slueb " + DeleteCertsCSP.value + "."
		Resp = MsgBox(OkStr, vbInformation, "Mazání certifikátù")
	End If
End Sub

Sub SendMail_OnClick
	On Error Resume Next
	MyErr = Signer.SendMail(EmailServer.value, EmailServerPort.value, EmailFrom.value, EmailTo.value, EmailReplyTo.value, EmailSubject.value, EmailMessage.value)
	If MyErr = 0 Then
		Resp = MsgBox("Odeslání e-mailu probìhlo v poøádku.", vbInformation, "Odesílání e-mailu")
	Else
		Resp = MsgBox(HandleError, vbInformation, "Chyba pøi odesílání e-mailu")
	End If
End Sub

Sub About_OnClick
	On Error Resume Next
	CopyRight = Signer.About
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Signer")
	Else
		Resp = MsgBox(CopyRight, vbInformation, "O Kryptografickém modulu Signer")
	End If
End Sub

Sub DefaultOptionsDlg_OnClick
	On Error Resume Next
	Signer.ShowDefaultOptionsDlg 0, 0
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Monosti")
	End If
End Sub

Sub VersionMajor_OnClick
	On Error Resume Next
	Version = Signer.VersionMajor
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Signer")
	Else
		Resp = MsgBox(Version, vbInformation, "Hlavní verze modulu Signer")
	End If
End Sub

Sub VersionMinor_OnClick
	On Error Resume Next
	Version = Signer.VersionMinor
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Signer")
	Else
		Resp = MsgBox(Version, vbInformation, "Vedlejší verze modulu Signer")
	End If
End Sub

Sub Unregister_OnClick
	On Error Resume Next
	Dim Resp, MyErr
	MyErr = Signer.Unregister()

	If MyErr = 0 Then
		Resp = MsgBox("Rozhraní COM modulu Signer.dll bylo odregistrováno. Restartujte aplikaci Microsoft Internet Explorer.", vbInformation, "Odregistrování rozhraní COM modulu")
	Else
		Resp = MsgBox("Rozhraní COM modulu Signer.dll se nepodaøilo odregistrovat. Chyba: " + CStr(MyErr) + vbCrLf + HandleError, vbCritical, "Odregistrování rozhraní COM modulu")
	End If
End Sub

Sub LastError_OnClick
	Resp = MsgBox(HandleError, vbInformation, "Info")
End Sub

Sub ShowAllLastErrorSignature_OnClick
	'zapamatování aktuálního indexu
	sigIdxCur = Signer.CfgCertSenderSignatureIdx
	sigIdxMax = Signer.CfgCertSenderSignatureNumber - 1
	For sigIdx = 0 To sigIdxMax
		Signer.CfgCertSenderSignatureIdx = sigIdx
		Resp = MsgBox(HandleErrorSignature, vbInformation, "Poslední chyba podpisu")
	Next
	'vrácení aktuálního indexu
	Signer.CfgCertSenderSignatureIdx = sigIdxCur
End Sub

Sub LastErrorSignature_OnClick
	Resp = MsgBox(HandleErrorSignature, vbInformation, "Poslední chyba podpisu")
End Sub

Sub GetLastMessageAction_OnClick
	Select Case GetLastMessageOption.value
		Case "1"	LastMessageStatus_OnClick
		Case "2"	LastMessage_OnClick
		Case "3"	LastMessageEncoded_OnClick
		Case "4"	LastMessageSaveAs_OnClick
		Case "5"	ReleaseLastMessage_OnClick
	End Select
End Sub

Sub LastMessageStatus_OnClick
	Resp = MsgBox("Stav poslední zpracované zprávy: " + CStr(Signer.LastMessageStatus), vbInformation, "Stav poslední zpracované zprávy")
End Sub

Sub LastMessage_OnClick
	DecodedMessage.value = Signer.LastMessage
End Sub

Sub LastMessageEncoded_OnClick
	DecodedMessage.value = Signer.LastMessageEncoded
End Sub

Sub LastMessageSaveAs_OnClick
	MyErr = Signer.LastMessageSaveAs(SaveFolder.value)
	If MyErr = 0 Then
		Resp = MsgBox("Obsah LastMessage je uloen v " + SaveFolder.value + ".", vbInformation, "Uloení obsahu LastMessage")
	Else
		Resp = MsgBox("Obsah LastMessage se nepodaøilo uloit.", vbCritical, "Uloení obsahu LastMessage")
	End If
	Resp = MsgBox(HandleError, vbInformation, "Info")
End Sub

Sub ReleaseLastMessage_OnClick
	Signer.ReleaseLastMessage
End Sub

Sub CfgFileHeaderOptionSet_OnClick
	Dim val, str, strval, Resp
	Signer.CfgFileHeader = CfgFileHeaderOption.value
	val = Signer.CfgFileHeader
	If val = 0 Then
		strval = "vypnuty"
	Else
		strval = "zapnuty"
	End If
	str = "CfgFileHeader = " + CStr(val) + ": Hlavièky souborù jsou " + strval + "."
	Resp = MsgBox(str, vbInformation, "Pøíznak hlavièek souborù CfgFileHeader")
End Sub

Sub CfgFileHeaderOptionGet_OnClick
	Dim val, str, strval, Resp
	val = Signer.CfgFileHeader
	If val = 0 Then
		strval = "vypnuty"
	Else
		strval = "zapnuty"
	End If
	str = "CfgFileHeader = " + CStr(val) + ": Hlavièky souborù jsou " + strval + "."
	Resp = MsgBox(str, vbInformation, "Pøíznak hlavièek souborù CfgFileHeader")
End Sub

Sub CfgSignOptionSet_OnClick
	CfgSignNum = 0
	strval = vbCrLf + "Základní digitální podpis CAdES-BES"
	If CreateSignatureWithTimeStamp.Checked = True Then
		strval = strval + vbCrLf + "Digitální podpis s èasovım razítkem CAdES-T"
		CfgSignNum = CfgSignNum OR CreateSignatureWithTimeStamp.value
	End If
	If CreateSignatureWithCompleteValidationDataReferences.Checked = True Then
		strval = strval + vbCrLf + "Digitální podpis s referencemi informací na ovìøení platnosti CAdES-C"
		CfgSignNum = CfgSignNum OR CreateSignatureWithCompleteValidationDataReferences.value
	End If
	If CreateSignatureEXtendedLong.Checked = True Then
		strval = strval + vbCrLf + "Rozšíøenı dlouhodobı digitální podpis s úplnou informací na ovìøení platnosti CAdES-X Long"
		CfgSignNum = CfgSignNum OR CreateSignatureEXtendedLong.value
	End If
	If CreateSignatureArchival.Checked = True Then
		strval = strval + vbCrLf + "Archivní digitální podpis CAdES-A"
		CfgSignNum = CfgSignNum OR CreateSignatureArchival.value
	End If
	If CreateSignatureAddCompleteValidationDataReferencesToPreviousTimeStampSignature.Checked = True Then
		strval = strval + vbCrLf + "Reference informací na ovìøení platnosti CAdES-C podpisu pøedchozího èasového razítka"
		CfgSignNum = CfgSignNum OR CreateSignatureAddCompleteValidationDataReferencesToPreviousTimeStampSignature.value
	End If
	If CreateSignatureAddEXtendedLongToPreviousTimeStampSignature.Checked = True Then
		strval = strval + vbCrLf + "Úplná informace na ovìøení platnosti CAdES-X Long podpisu pøedchozího èasového razítka"
		CfgSignNum = CfgSignNum OR CreateSignatureAddEXtendedLongToPreviousTimeStampSignature.value
	End If
	If CreateSignatureWithHashAlgorithmInSignatureAlgorithm.Checked = True Then
		strval = strval + vbCrLf + "Identifikátor algoritmu podpisu bude sloen z algoritmu miniatury a podpisu"
		CfgSignNum = CfgSignNum OR CreateSignatureWithHashAlgorithmInSignatureAlgorithm.value
	End If

	Signer.CfgSign = CfgSignNum
	str = "CfgSign = " + CStr(CfgSignNum) + ":" + vbCrLf + "Pøi podepisování budou vytváøeny podpisy dle následujících formátù:" + strval
	Resp = MsgBox(str, vbInformation, "Pøíznak nastavení vytváøení podpisù CfgSign")
End Sub

Sub CfgSignOptionGet_OnClick
	Dim CfgSignNum, str, strval, Resp
	CfgSignNum = Signer.CfgSign
	
	strval = vbCrLf + "Základní digitální podpis CAdES-BES"
	If CfgSignNum AND CreateSignatureWithTimeStamp.value Then
		strval = strval + vbCrLf + "Digitální podpis s èasovım razítkem CAdES-T"
		CreateSignatureWithTimeStamp.checked = True
	Else
		CreateSignatureWithTimeStamp.checked = False
	End If
	If CfgSignNum AND CreateSignatureWithCompleteValidationDataReferences.value Then
		strval = strval + vbCrLf + "Digitální podpis s referencemi informací na ovìøení platnosti CAdES-C"
		CreateSignatureWithCompleteValidationDataReferences.checked = True
	Else
		CreateSignatureWithCompleteValidationDataReferences.checked = False
	End If
	If CfgSignNum AND CreateSignatureEXtendedLong.value Then
		strval = strval + vbCrLf + "Rozšíøenı dlouhodobı digitální podpis s úplnou informací na ovìøení platnosti CAdES-X Long"
		CreateSignatureEXtendedLong.checked = True
	Else
		CreateSignatureEXtendedLong.checked = False
	End If
	If CfgSignNum AND CreateSignatureArchival.value Then
		strval = strval + vbCrLf + "Archivní digitální podpis CAdES-A"
		CreateSignatureArchival.checked = True
	Else
		CreateSignatureArchival.checked = False
	End If
	If CfgSignNum AND CreateSignatureAddCompleteValidationDataReferencesToPreviousTimeStampSignature.value Then
		strval = strval + vbCrLf + "Reference informací na ovìøení platnosti CAdES-C podpisu pøedchozího èasového razítka"
		CreateSignatureAddCompleteValidationDataReferencesToPreviousTimeStampSignature.checked = True
	Else
		CreateSignatureAddCompleteValidationDataReferencesToPreviousTimeStampSignature.checked = False
	End If
	If CfgSignNum AND CreateSignatureAddEXtendedLongToPreviousTimeStampSignature.value Then
		strval = strval + vbCrLf + "Úplná informace na ovìøení platnosti CAdES-X Long podpisu pøedchozího èasového razítka"
		CreateSignatureAddEXtendedLongToPreviousTimeStampSignature.checked = True
	Else
		CreateSignatureAddEXtendedLongToPreviousTimeStampSignature.checked = False
	End If
	If CfgSignNum AND CreateSignatureWithHashAlgorithmInSignatureAlgorithm.value Then
		strval = strval + vbCrLf + "Identifikátor algoritmu podpisu bude sloen z algoritmu miniatury a podpisu"
		CreateSignatureWithHashAlgorithmInSignatureAlgorithm.checked = True
	Else
		CreateSignatureWithHashAlgorithmInSignatureAlgorithm.checked = False
	End If

	str = "CfgSign = " + CStr(CfgSignNum) + ":" + vbCrLf + "Pøi podepisování budou vytváøeny podpisy dle následujících formátù:" + strval
	Resp = MsgBox(str, vbInformation, "Pøíznak nastavení vytváøení podpisù CfgSign")
End Sub

Sub CfgTimeStampOptionSet_OnClick
	Dim CfgTimeStampNum, str, strval1, strval2, Resp
	CfgTimeStampNum = 0
	strval2 = ""
	If CreateTimeStampSignatureWithTimeStamp.Checked = True Then
		strval2 = strval2 + vbCrLf + "Digitální podpis s èasovım razítkem CAdES-T"
		CfgTimeStampNum = CfgTimeStampNum OR CreateTimeStampSignatureWithTimeStamp.value
	End If
	If CreateTimeStampSignatureWithCompleteValidationDataReferences.Checked = True Then
		strval2 = strval2 + vbCrLf + "Digitální podpis s referencemi informací na ovìøení platnosti CAdES-C"
		CfgTimeStampNum = CfgTimeStampNum OR CreateTimeStampSignatureWithCompleteValidationDataReferences.value
	End If
	If CreateTimeStampSignatureEXtendedLong.Checked = True Then
		strval2 = strval2 + vbCrLf + "Rozšíøenı dlouhodobı digitální podpis s úplnou informací na ovìøení platnosti CAdES-X Long"
		CfgTimeStampNum = CfgTimeStampNum OR CreateTimeStampSignatureEXtendedLong.value
	End If
	If CreateTimeStampSignatureArchival.Checked = True Then
		strval2 = strval2 + vbCrLf + "Archivní digitální podpis CAdES-A"
		CfgTimeStampNum = CfgTimeStampNum OR CreateTimeStampSignatureArchival.value
	End If
	If CreateTimeStampAddCompleteValidationDataReferencesToPreviousTimeStampSignature.Checked = True Then
		strval2 = strval2 + vbCrLf + "Reference informací na ovìøení platnosti CAdES-C podpisu pøedchozího èasového razítka"
		CfgTimeStampNum = CfgTimeStampNum OR CreateTimeStampAddCompleteValidationDataReferencesToPreviousTimeStampSignature.value
	End If
	If CreateTimeStampAddEXtendedLongToPreviousTimeStampSignature.Checked = True Then
		strval2 = strval2 + vbCrLf + "Úplná informace na ovìøení platnosti CAdES-X Long podpisu pøedchozího èasového razítka"
		CfgTimeStampNum = CfgTimeStampNum OR CreateTimeStampAddEXtendedLongToPreviousTimeStampSignature.value
	End If

	If CfgTimeStampNum = 0 Then
		strval1 = "vytváøena èasová razítka pøedanıch dat."
	Else
		strval1 = "z pøedanıch podpisù vytvoøeny podpisy dle následujících formátù:"
	End If

	Signer.CfgTimeStamp = CfgTimeStampNum
	str = "CfgTimeStamp = " + CStr(CfgTimeStampNum) + ":" + vbCrLf + "Pøi razítkování budou " + strval1 + strval2
	Resp = MsgBox(str, vbInformation, "Pøíznak nastavení vytváøení èasovıch razítek CfgTimeStamp")
End Sub

Sub CfgTimeStampOptionGet_OnClick
	Dim CfgTimeStamp, str, strval, Resp
	CfgTimeStampNum = Signer.CfgTimeStamp
	
	If CfgTimeStampNum = 0 Then
		strval = "vytváøena èasová razítka pøedanıch dat."
	Else
		strval = "z pøedanıch podpisù vytvoøeny podpisy dle následujících formátù:"
	End If
	If CfgTimeStampNum AND CreateTimeStampSignatureWithTimeStamp.value Then
		strval = strval + vbCrLf + "Digitální podpis s èasovım razítkem CAdES-T"
		CreateTimeStampSignatureWithTimeStamp.checked = True
	Else
		CreateTimeStampSignatureWithTimeStamp.checked = False
	End If
	If CfgTimeStampNum AND CreateTimeStampSignatureWithCompleteValidationDataReferences.value Then
		strval = strval + vbCrLf + "Digitální podpis s referencemi informací na ovìøení platnosti CAdES-C"
		CreateTimeStampSignatureWithCompleteValidationDataReferences.checked = True
	Else
		CreateTimeStampSignatureWithCompleteValidationDataReferences.checked = False
	End If
	If CfgTimeStampNum AND CreateTimeStampSignatureEXtendedLong.value Then
		strval = strval + vbCrLf + "Rozšíøenı dlouhodobı digitální podpis s úplnou informací na ovìøení platnosti CAdES-X Long"
		CreateTimeStampSignatureEXtendedLong.checked = True
	Else
		CreateTimeStampSignatureEXtendedLong.checked = False
	End If
	If CfgTimeStampNum AND CreateTimeStampSignatureArchival.value Then
		strval = strval + vbCrLf + "Archivní digitální podpis CAdES-A"
		CreateTimeStampSignatureArchival.checked = True
	Else
		CreateTimeStampSignatureArchival.checked = False
	End If
	If CfgTimeStampNum AND CreateTimeStampAddCompleteValidationDataReferencesToPreviousTimeStampSignature.value Then
		strval = strval + vbCrLf + "Reference informací na ovìøení platnosti podpisu pøedchozího èasového razítka"
		CreateTimeStampAddCompleteValidationDataReferencesToPreviousTimeStampSignature.checked = True
	Else
		CreateTimeStampAddCompleteValidationDataReferencesToPreviousTimeStampSignature.checked = False
	End If
	If CfgTimeStampNum AND CreateTimeStampAddEXtendedLongToPreviousTimeStampSignature.value Then
		strval = strval + vbCrLf + "Úplná informace na ovìøení platnosti podpisu pøedchozího èasového razítka"
		CreateTimeStampAddEXtendedLongToPreviousTimeStampSignature.checked = True
	Else
		CreateTimeStampAddEXtendedLongToPreviousTimeStampSignature.checked = False
	End If

	str = "CfgTimeStamp = " + CStr(CfgTimeStampNum) + ":" + vbCrLf + "Pøi razítkování budou " + strval
	Resp = MsgBox(str, vbInformation, "Pøíznak nastavení vytváøení èasovıch razítek CfgTimeStamp")
End Sub

Sub SetTimeStampHashAlgorithmStr_OnClick
	On Error Resume Next
	Signer.CfgTimeStampHashAlgorithmStr = TimeStampHashAlgorithmStr.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení algoritmu miniatury èasového razítka")
	End If
End Sub

Sub GetTimeStampHashAlgorithmStr_OnClick
	On Error Resume Next
	TimeStampHashAlgorithmStr.value = Signer.CfgTimeStampHashAlgorithmStr
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Získání algoritmu miniatury èasového razítka")
	End If
End Sub

Sub SetTimeStampHashAlgorithmNumber_OnClick
	On Error Resume Next
	Signer.CfgTimeStampHashAlgorithmNumber = TimeStampHashAlgorithmNumber.value
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Nastavení algoritmu miniatury èasového razítka")
	End If
End Sub

Sub GetTimeStampHashAlgorithmNumber_OnClick
	On Error Resume Next
	TimeStampHashAlgorithmNumber.value = Signer.CfgTimeStampHashAlgorithmNumber
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Získání algoritmu miniatury èasového razítka")
	End If
End Sub

Sub CfgVerifyOptionSet_OnClick
	CfgVerifyNum = 0
	strval = vbCrLf + "Základní digitální podpisy CAdES-BES"
	If VerifyCertChain.Checked = True Then
		CfgVerifyNum = CfgVerifyNum OR VerifyCertChain.value
		strval = vbCrLf + "Základní digitální podpisy CAdES-BES" + vbCrLf + "Øetìzce certifikátù"
	End If
	If VerifyCertChainAndCRL.Checked = True Then
		CfgVerifyNum = CfgVerifyNum OR VerifyCertChainAndCRL.value
		strval = vbCrLf + "Základní digitální podpisy CAdES-BES" + vbCrLf + "Øetìzce certifikátù" + vbCrLf + "Zneplatnìní podpisovıch certifikátù"
	End If
	If VerifySigningCertificate.Checked = True Then
		CfgVerifyNum = CfgVerifyNum OR VerifySigningCertificate.value
		strval = strval + vbCrLf + "Podpisové certifikáty"
	End If
	If VerifySignatureWithTimeStamp.Checked = True Then
		CfgVerifyNum = CfgVerifyNum OR VerifySignatureWithTimeStamp.value
		strval = strval + vbCrLf + "Digitální podpisy s èasovımi razítky CAdES-T"
	End If
	If VerifySignatureWithCompleteValidationDataReferences.Checked = True Then
		strval = strval + vbCrLf + "Digitální podpisy s referencemi informací na ovìøení platnosti CAdES-C"
		CfgVerifyNum = CfgVerifyNum OR VerifySignatureWithCompleteValidationDataReferences.value
	End If
	If VerifySignatureEXtendedLong.Checked = True Then
		strval = strval + vbCrLf + "Rozšíøené dlouhodobé digitální podpisy s úplnou informací na ovìøení platnosti CAdES-X Long"
		CfgVerifyNum = CfgVerifyNum OR VerifySignatureEXtendedLong.value
	End If
	If VerifySignatureArchival.Checked = True Then
		strval = strval + vbCrLf + "Archivní digitální podpisy CAdES-A"
		CfgVerifyNum = CfgVerifyNum OR VerifySignatureArchival.value
	End If
	If SignVerDlg.Checked = True Then
		CfgVerifyNum = CfgVerifyNum OR SignVerDlg.value
		strval = strval + vbCrLf + vbCrLf + "Vısledky ovìøení podpisù budou zobrazeny v dialogovém oknì."
	End If

	Signer.CfgVerify = CfgVerifyNum
	str = "CfgVerify = " + CStr(CfgVerifyNum) + ":" + vbCrLf + "Pøi ovìøování podpisù budou zkontrolovány:" + strval
	Resp = MsgBox(str, vbInformation, "Pøíznak nastavení ovìøení podpisù CfgVerify")
End Sub

Sub CfgVerifyOptionGet_OnClick
	Dim CfgVerifyNum, str, strval, Resp, TestNum
	CfgVerifyNum = Signer.CfgVerify
	
	strval = vbCrLf + "Základní digitální podpisy CAdES-BES"
	If CfgVerifyNum AND VerifyCertChain.value Then
		strval = vbCrLf + "Základní digitální podpisy CAdES-BES" + vbCrLf + "Øetìzce certifikátù"
		VerifyCertChain.checked = True
	Else
		VerifyCertChain.checked = False
	End If
	If CfgVerifyNum AND VerifyCertChainAndCRL.value Then
		strval = vbCrLf + "Základní digitální podpisy CAdES-BES" + vbCrLf + "Øetìzce certifikátù" + vbCrLf + "Zneplatnìní podpisovıch certifikátù"
		VerifyCertChainAndCRL.checked = True
	Else
		VerifyCertChainAndCRL.checked = False
	End If
	If CfgVerifyNum AND VerifySigningCertificate.value Then
		strval = strval + vbCrLf + "Podpisové certifikáty"
		VerifySigningCertificate.checked = True
	Else
		VerifySigningCertificate.checked = False
	End If
	If CfgVerifyNum AND VerifySignatureWithTimeStamp.value Then
		strval = strval + vbCrLf + "Digitální podpisy s èasovımi razítky CAdES-T"
		VerifySignatureWithTimeStamp.checked = True
	Else
		VerifySignatureWithTimeStamp.checked = False
	End If
	If CfgVerifyNum AND VerifySignatureWithCompleteValidationDataReferences.value Then
		strval = strval + vbCrLf + "Digitální podpisy s referencemi informací na ovìøení platnosti CAdES-C"
		VerifySignatureWithCompleteValidationDataReferences.checked = True
	Else
		VerifySignatureWithCompleteValidationDataReferences.checked = False
	End If
	If CfgVerifyNum AND VerifySignatureEXtendedLong.value Then
		strval = strval + vbCrLf + "Rozšíøené dlouhodobé digitální podpisy s úplnou informací na ovìøení platnosti CAdES-X Long"
		VerifySignatureEXtendedLong.checked = True
	Else
		VerifySignatureEXtendedLong.checked = False
	End If
	If CfgVerifyNum AND VerifySignatureArchival.value Then
		strval = strval + vbCrLf + "Archivní digitální podpisy CAdES-A"
		VerifySignatureArchival.checked = True
	Else
		VerifySignatureArchival.checked = False
	End If
	If CfgVerifyNum AND SignVerDlg.value Then
		strval = strval + vbCrLf + vbCrLf + "Vısledky ovìøení podpisù budou zobrazeny v dialogovém oknì."
		SignVerDlg.checked = True
	Else
		SignVerDlg.checked = False
	End If

	str = "CfgVerify = " + CStr(CfgVerifyNum) + ":" + vbCrLf + "Pøi ovìøování podpisù budou zkontrolovány:" + strval
	Resp = MsgBox(str, vbInformation, "Pøíznak nastavení ovìøení podpisù CfgVerify")
End Sub

Sub CfgVerifyTimeStampOptionSet_OnClick
	CfgVerifyTimeStampNum = 0
	strval = vbCrLf + "Základní digitální podpisy CAdES-BES èasovıch razítek"
	If VerifyTimeStampCertChain.Checked = True Then
		strval = vbCrLf + "Základní digitální podpisy CAdES-BES èasovıch razítek" + vbCrLf + "Øetìzce certifikátù"
		CfgVerifyTimeStampNum = CfgVerifyTimeStampNum OR VerifyTimeStampCertChain.value
	End If
	If VerifyTimeStampCertChainAndCRL.Checked = True Then
		strval = vbCrLf + "Základní digitální podpisy CAdES-BES èasovıch razítek" + vbCrLf + "Øetìzce certifikátù" + vbCrLf + "Zneplatnìní podpisovıch certifikátù"
		CfgVerifyTimeStampNum = CfgVerifyTimeStampNum OR VerifyTimeStampCertChainAndCRL.value
	End If
	If VerifyTimeStampSigningCertificate.Checked = True Then
		CfgVerifyTimeStampNum = CfgVerifyTimeStampNum OR VerifyTimeStampSigningCertificate.value
		strval = strval + vbCrLf + "Podpisové certifikáty"
	End If
	If VerifyTimeStampWithCompleteValidationDataReferences.Checked = True Then
		strval = strval + vbCrLf + "Digitální podpisy èasovıch razítek s referencemi informací na ovìøení platnosti CAdES-C"
		CfgVerifyTimeStampNum = CfgVerifyTimeStampNum OR VerifyTimeStampWithCompleteValidationDataReferences.value
	End If
	If VerifyTimeStampEXtendedLong.Checked = True Then
		strval = strval + vbCrLf + "Rozšíøené dlouhodobé digitální podpisy èasovıch razítek s úplnou informací na ovìøení platnosti CAdES-X Long"
		CfgVerifyTimeStampNum = CfgVerifyTimeStampNum OR VerifyTimeStampEXtendedLong.value
	End If
	If VerifyTimeStampNoCAndXLForLastArchiveTimeStamp.Checked = True Then
		strval = strval + vbCrLf + "Vynechání kontroly referencí CAdES-C a úplnné informace CAdES-X Long na ovìøení platnosti podpisu posledního archivního èasového razítka"
		CfgVerifyTimeStampNum = CfgVerifyTimeStampNum OR VerifyTimeStampNoCAndXLForLastArchiveTimeStamp.value
	End If

	Signer.CfgVerifyTimeStamp = CfgVerifyTimeStampNum
	str = "CfgVerifyTimeStamp = " + CStr(CfgVerifyTimeStampNum) + ":" + vbCrLf + "Pøi ovìøování èasovıch razítek budou kontrolovány:" + strval
	Resp = MsgBox(str, vbInformation, "Pøíznak nastavení ovìøení èasovıch razítek CfgVerifyTimeStamp")
End Sub

Sub CfgVerifyTimeStampOptionGet_OnClick
	Dim CfgVerifyTimeStampNum, str, strval, Resp, TestNum
	CfgVerifyTimeStampNum = Signer.CfgVerifyTimeStamp
	
	strval = vbCrLf + "Základní digitální podpisy CAdES-BES èasovıch razítek"
	If CfgVerifyTimeStampNum AND VerifyTimeStampCertChain.value Then
		strval = vbCrLf + "Základní digitální podpisy CAdES-BES èasovıch razítek" + vbCrLf + "Øetìzce certifikátù"
		VerifyTimeStampCertChain.checked = True
	Else
		VerifyTimeStampCertChain.checked = False
	End If
	If CfgVerifyTimeStampNum AND VerifyTimeStampCertChainAndCRL.value Then
		strval = vbCrLf + "Základní digitální podpisy CAdES-BES èasovıch razítek" + vbCrLf + "Øetìzce certifikátù" + vbCrLf + "Zneplatnìní podpisovıch certifikátù"
		VerifyTimeStampCertChainAndCRL.checked = True
	Else
		VerifyTimeStampCertChainAndCRL.checked = False
	End If
	If CfgVerifyTimeStampNum AND VerifyTimeStampSigningCertificate.value Then
		strval = strval + vbCrLf + "Podpisové certifikáty"
		VerifyTimeStampSigningCertificate.checked = True
	Else
		VerifyTimeStampSigningCertificate.checked = False
	End If
	If CfgVerifyTimeStampNum AND VerifyTimeStampWithCompleteValidationDataReferences.value Then
		strval = strval + vbCrLf + "Digitální podpisy èasovıch razítek s referencemi informací na ovìøení platnosti CAdES-C"
		VerifyTimeStampWithCompleteValidationDataReferences.checked = True
	Else
		VerifyTimeStampWithCompleteValidationDataReferences.checked = False
	End If
	If CfgVerifyTimeStampNum AND VerifyTimeStampEXtendedLong.value Then
		strval = strval + vbCrLf + "Rozšíøené dlouhodobé digitální podpisy èasovıch razítek s úplnou informací na ovìøení platnosti CAdES-X Long"
		VerifyTimeStampEXtendedLong.checked = True
	Else
		VerifyTimeStampEXtendedLong.checked = False
	End If
	If CfgVerifyTimeStampNum AND VerifyTimeStampNoCAndXLForLastArchiveTimeStamp.value Then
		strval = strval + vbCrLf + "Vynechání kontroly referencí CAdES-C a úplnné informace CAdES-X Long na ovìøení platnosti podpisu posledního archivního èasového razítka"
		VerifyTimeStampNoCAndXLForLastArchiveTimeStamp.checked = True
	Else
		VerifyTimeStampNoCAndXLForLastArchiveTimeStamp.checked = False
	End If

	str = "CfgVerifyTimeStamp = " + CStr(CfgVerifyTimeStampNum) + ":" + vbCrLf + "Pøi ovìøování èasovıch razítek budou kontrolovány:" + strval
	Resp = MsgBox(str, vbInformation, "Pøíznak nastavení ovìøení èasovıch razítek CfgVerifyTimeStamp")
End Sub

Sub CfgFileSeparatorOptionSet_OnClick
	Dim val, str, Resp
	Signer.CfgFileSeparator = CfgFileSeparatorOption.value
	val = Signer.CfgFileSeparator
	str = "CfgFileSeparator = " + CStr(val) + ": " + FileSeparatorStr(val) + "."
	Resp = MsgBox(str, vbInformation, "Pøíznak samostatného zpracování souborù CfgFileSeparator")
End Sub

Sub CfgFileSeparatorOptionGet_OnClick
	Dim str, Resp
	CfgFileSeparatorOption.value = Signer.CfgFileSeparator
	str = "CfgFileSeparator = " + CStr(CfgFileSeparatorOption.value) + ": " + FileSeparatorStr(CfgFileSeparatorOption.value) + "."
	Resp = MsgBox(str, vbInformation, "Pøíznak samostatného zpracování souborù CfgFileSeparator")
End Sub

Sub CfgToFileOptionSet_OnClick
	Dim val, str, Resp
	Signer.CfgToFile = CfgToFileOption.value
	val = Signer.CfgToFile
	str = "CfgToFile = " + CStr(val) + ": " + vbCrLf + ToFileStr(val)
	Resp = MsgBox(str, vbInformation, "Pøíznak reimu zápisu do souborù CfgToFile")
End Sub

Sub CfgToFileOptionGet_OnClick
	Dim str, Resp
	CfgToFileOption.value = Signer.CfgToFile
	str = "CfgToFile = " + CStr(CfgToFileOption.value) + ": " + vbCrLf + ToFileStr(CfgToFileOption.value)
	Resp = MsgBox(str, vbInformation, "Pøíznak reimu zápisu do souborù CfgToFile")
End Sub

Sub DecryptOnServer_OnClick
	SignForm.CryptoAction.value = 0
	SignForm.Submit
End Sub

Sub VerifyOnServer_OnClick
	SignForm.CryptoAction.value = 1
	SignForm.Submit
End Sub

Sub DecryptAndVerifyOnServer_OnClick
	SignForm.CryptoAction.value = 2
	SignForm.Submit
End Sub

Sub GetFileNameDlg_OnClick
	On Error Resume Next
	Dim strSelFile, nGetFileNameDlgFlag, strFilter
	nGetFileNameDlgFlag = 0
	'strFilter = "Všechny soubory (*.*)" + vbNullChar + "*.*" + vbNullChar + _
	'			"Textové soubory (*.txt)" + vbNullChar + "*.txt" + vbNullChar + _
	'			"Dokumenty MS Office (*.doc; *.xls; *.ppt)" + vbNullChar + "*.doc; *.xls; *.ppt" + vbNullChar + _
	'			"Obrázky (*.jpg; *.bmp; *.gif; *.tif)" + vbNullChar + "*.jpg; *.bmp; *.gif; *.tif" + vbNullChar + vbNullChar
	strFilter = "Všechny soubory (*.*)" + vbTab + "*.*" + vbTab + _
				"Textové soubory (*.txt)" + vbTab + "*.txt" + vbTab + _
				"Dokumenty MS Office (*.doc; *.xls; *.ppt)" + vbTab + "*.doc; *.xls; *.ppt" + vbTab + _
				"Obrázky (*.jpg; *.bmp; *.gif; *.tif)" + vbTab + "*.jpg; *.bmp; *.gif; *.tif" + vbTab + vbTab
	If GetFileNameDlgSaveFile.checked Then
		nGetFileNameDlgFlag = nGetFileNameDlgFlag OR GetFileNameDlgSaveFile.value
	End If
	If GetFileNameAllowMultiselect.checked Then
		nGetFileNameDlgFlag = nGetFileNameDlgFlag OR GetFileNameAllowMultiselect.value
	End If

	strSelFile = Signer.GetFileNameDlg(GetFileNameDlgInitialFolder.value, GetFileNameDlgInitialFile.value, GetFileNameDlgTitle.value, strFilter, nGetFileNameDlgFlag)
	If Err.number <> 0 Then
		Resp = MsgBox(HandleError, vbInformation, "Info")
	Else
		Resp = MsgBox(strSelFile, vbInformation, "Vybranı soubor")
	End If
End Sub

Function HandleError
	HandleError = "Systémová chyba:" + vbCrLf + _
				  "Hexa èíslo chyby: " + "0x" + Hex(Err.Number) + vbCrLf + _
				  "Desetinné èíslo chyby: " + CStr(Err.Number) + vbCrLf + _
				  "Popis chyby: " + Err.Description + vbCrLf + vbCrLf + _
				  "Poslední chyba modulu:" + vbCrLf + _
				  "Hexa èíslo chyby: " + "0x" + Hex(Signer.LastErrorNumber) + vbCrLf + _
				  "Desetinné èíslo chyby: " + CStr(Signer.LastErrorNumber) + vbCrLf + _
				  "Popis chyby: " + Signer.LastErrorStr + vbCrLf + _
				  "Dodateèná informace poslední chyby modulu:" + vbCrLf + _
				  "Hexa èíslo dodateèné informace chyby: " + "0x" + Hex(Signer.LastErrorInfoNumber) + vbCrLf + _
				  "Desetinné èíslo dodateèné informace chyby: " + CStr(Signer.LastErrorInfoNumber) + vbCrLf + _
				  "Popis dodateèné informace chyby: " + Signer.LastErrorInfoStr
End Function

Function HandleErrorSignature
	HandleErrorSignature = "Poslední chyba podpisu na indexu: " + CStr(Signer.CfgCertSenderSignatureIdx)+ vbCrLf + _
						   "Hexa èíslo chyby podpisu: " + "0x" + Hex(Signer.LastErrorSignatureNumber) + vbCrLf + _
						   "Desetinné èíslo chyby podpisu: " + CStr(Signer.LastErrorSignatureNumber) + vbCrLf + _
						   "Popis chyby podpisu: " + Signer.LastErrorSignatureStr + vbCrLf + _
						   "Dodateèná informace poslední chyby podpisu na indexu: " + CStr(Signer.CfgCertSenderSignatureIdx)+ vbCrLf + _
						   "Hexa èíslo dodateèné informace chyby podpisu: " + "0x" + Hex(Signer.LastErrorSignatureInfoNumber) + vbCrLf + _
						   "Desetinné èíslo dodateèné informace chyby podpisu: " + CStr(Signer.LastErrorSignatureInfoNumber) + vbCrLf + _
						   "Popis dodateèné informace chyby podpisu: " + Signer.LastErrorSignatureInfoStr
End Function

Function FileSeparatorStr(val)
	If val AND 1 Then
		FileSeparatorStr = "samostatné zpracování souborù zapnuto, "
	Else
		FileSeparatorStr = "samostatné zpracování souborù vypnuto, "
	End If
	If val AND 2 Then
		FileSeparatorStr = FileSeparatorStr + "oddìlovaè vısledkù zapnut"
	Else
		FileSeparatorStr = FileSeparatorStr + "oddìlovaè vısledkù vypnut"
	End If
End Function

Function TimeStampStr
	TimeStampStr = "Obecnı èas: " + Signer.LastTimeStampTimeGeneralized + vbCrLf + _
				   "Èas UTC: " + Signer.LastTimeStampTimeUTC + vbCrLf + _
				   "Lokální èas: " + Signer.LastTimeStampTimeLocal + vbCrLf + _
				   "OID politiky: " + Signer.LastTimeStampPolicy + vbCrLf + _
				   "Verze èasového razítka: " + CStr(Signer.LastTimeStampVersion) + vbCrLf + _
				   "OID algoritmu miniatury: " + Signer.LastTimeStampHashAlgorithmOID + vbCrLf + _
				   "Èíslo algoritmu miniatury: " + CStr(Signer.LastTimeStampHashAlgorithmNumber) + vbCrLf + _
				   "Zkratka algoritmu miniatury: " + Signer.LastTimeStampHashAlgorithmStr + vbCrLf + _
				   "Miniatura dat: " + Signer.LastTimeStampHashedMessage + vbCrLf + _
				   "Sériové èíslo: " + Signer.LastTimeStampSN + " (" + Signer.HexToDec(Signer.LastTimeStampSN) + ")" + vbCrLf + _
				   "Párovací èíslo: " + Signer.LastTimeStampNonce + vbCrLf + _
				   "OID algoritmu miniatury podpisu: " + Signer.LastTimeStampSignatureHashAlgorithmOID + vbCrLf + _
				   "Èíslo algoritmu miniatury podpisu: " + CStr(Signer.LastTimeStampSignatureHashAlgorithmNumber) + vbCrLf + _
				   "Zkratka algoritmu miniatury podpisu: " + Signer.LastTimeStampSignatureHashAlgorithmStr
End Function

Function ToFileStr(val)
	If val AND 1 Then
		ToFileStr = "- binární kryptografická zpráva ve formátu DER" + vbCrLf
	Else
		ToFileStr = "- textová kryptografická zpráva ve formátu PEM" + vbCrLf
	End If
	If val AND 4 Then
		ToFileStr = ToFileStr + "- pøepsání existujícího souboru"
		Exit Function
	Else
		ToFileStr = ToFileStr + "- zápis do existujícího souboru" + vbCrLf
	End If
	If val AND 2 Then
		ToFileStr = ToFileStr + "- pøidání vısledku do kryptografické zprávy"
	Else
		ToFileStr = ToFileStr + "- pøidání vısledku na konec souboru"
	End If
End Function

Function CanChangeCerts
	CanChangeCerts = 0
	If CertSenderSignature.Checked = True Then
		CanChangeCerts = CanChangeCerts OR CertSenderSignature.value
	End If
	If CertSenderKeyExchange.Checked = True Then
		CanChangeCerts = CanChangeCerts OR CertSenderKeyExchange.value
	End If
	If CertReceiverKeyExchange.Checked = True Then
		CanChangeCerts = CanChangeCerts OR CertReceiverKeyExchange.value
	End If
End Function

</script>
</html>
